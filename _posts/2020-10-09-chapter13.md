---
title: ุงูููุงุฐุฌ ุงูุฎุทูุฉ
show_title: true
chapter_number: 13
chapter_text: ุงููุตู ุงูุซุงูุซ ุนุดุฑ
chapter_lessons: [[0, 'ููุฏูุฉ'], [1, 'ุงูุชูุจุค ุจุงูุฅูุฑุงููุงุช'], [2, 'ุถุจุท ุงููููุฐุฌ ุงูุฎุทู ุจุฅุณุชุฎุฏุงู ุงููุฒูู ุงูุฅุดุชูุงูู'], [3, 'ุงูุฅูุญุฏุงุฑ ุงูุฎุทู ุงููุชุนุฏุฏ'], [4, 'ุงููุฑุจุนุงุช ุงูุตุบุฑู - ููุธูุฑ ููุฏุณู'], [5, 'ุชุทุจูู ุนููู ููุฅูุญุฏุงุฑ ุงูุฎุทู']]
chapter_sublessons: [
    [],
    [['ุชุนุฑูู ูููุฐุฌ ุฎุทู ุจุณูุท', 'ุชููุน ุงููููุฐุฌ ุงูุฎุทู']],
    [['ุถุจุท ุงููููุฐุฌ ุงูุฎุทู ูุน ุงููุฒูู ุงูุฅุดุชูุงูู', 'ููุงุญุธุฉ ุนู ุฅุณุชุฎุฏุงู ุงูุนูุงูุงุช'],'ูุดุชูุฉ ุฎุณุงุฑุฉ ุงูุฎุทุฃ ุงูุชุฑุจูุนู ุงููุชูุณุท MSE', 'ุชุทุจูู ุงููุฒูู ุงูุฅุดุชูุงูู'],
    ['ุฎุณุงุฑุฉ ุงูุฎุทุฃ ุงูุชุฑุจูุนู ุงููุชูุณุท ูุฅูุญุฏุงุฑูุง', 'ุถุจุท ุงููููุฐุฌ ูุน ุงููุฒูู ุงูุฅุดุชูุงูู', 'ุงูุฑุณู ุงูุจูุงูู ูุชูุจุคุงุชูุง', 'ุงุณุชุฎุฏุงู ูุงูู ุงูุจูุงูุงุช', 'ููุฎุต ุงูุฅูุญุฏุงุฑ ุงูุฎุทู ุงููุชุนุฏุฏ'],
    ['ุงููุฑุจุนุงุช ุงูุตุบุฑู: ุงููููุฐุฌ ุงูุซุงุจุช', 'ุงููุฑุจุนุงุช ุงูุตุบุฑู: ูููุฐุฌ ุฎุทู ุจุณูุท', 'ุงูููุฑู ุงูููุฏุณูู', 'ุงูุฌุจุฑ ุงูุฎุทู', 'ุงููุงุก ุงูุฏุฑุงุณู', 'ุนูุฏูุง ุชุนุชูุฏ ุงููุชุบูุฑุงุช ุฎุทูุงู', 'ุทุฑููุชูู ููุชูููุฑ'],
    ['ูุธุฑู ุนุงูู ุนูู ุงูุจูุงูุงุช', 'ุชูุธูู ุงูุจูุงูุงุช', 'ูุตู ุจูุงูุงุช ุงูุชุฏุฑูุจ ูุงูุฅุฎุชุจุงุฑ', 'ุงุณุชูุดุงู ุงูุจูุงูุงุช ูุชุตููุฑูุง', 'ููุงุฐุฌ ุฎุทูุฉ ุฃุจุณุท', 'ุชุญููู ุงููุชุบูุฑุงุช', 'ูููุฐุฌ ุงูุฅูุญุฏุงุฑ ุงูุฎุทู ุงููุชุนุฏุฏ', 'ุชูููู ูููุฐุฌูุง'],
]
layout: default
---

## ููุฏูุฉ

ุงูุขูุ ุจุนุฏ ุงู ุชุนูููุง ุจุดูู ุนุงู ุงุฏูุงุช ูุถุจุท ุงูููุงุฐุฌ ูุน ุฏูุงู ุงูุชููููุ ูุชุญูู ูุทุฑู ุชุญุณูู ุงููููุฐุฌ. ููุชุจุณูุทุ ูู ุงูุณุงุจู ุญุฏุฏูุง ุนูููุง ุนูู ุงููููุฐุฌ ุงูุซุงุจุช: ูููุฐุฌูุง ููุท ูุชููุน ุฑูู ูุงุญุฏ.

ููููุ ุฅุนุทุงุก ูููุฐุฌ ููุฐุง ูููุงุฏู ูู ูุฑุถูู. ููุฏ ุงููุงุฏู ุงู ููุถุญ ุงูู ุญุตู ุนูู ูุนูููุงุช ุงูุซุฑ ูุณุจุฉ ุงูุฅูุฑุงููู ูู ุงูุทุงููุงุช ุงูุชู ุฎุฏููุง. ููุงุฐุง ูุง ูุณุชุฎุฏู ุจูุงูุงุชู ุงูุฃุฎุฑูุ ูุซูุงู ุญุฌู ุงูุนููุงุก ูู ุงูุทุงููู ููุฌููุน ุงููุงุชูุฑูุ ูุบุฑุถ ุฌุนู ุงููููุฐุฌ ุงูุซุฑ ูุงุฆุฏุฉ.

ูู ูุฐุง ุงููุตู ุณูุชุนุฑู ุนูู ุงูููุงุฐุฌ ุงูุฎุทูุฉ ูุงูุฐู ูุณูุญ ููุง ุจุฅุณุชุฎุฏุงู ุฌููุน ุงูุจูุงูุงุช ุงูุชู ูุฏููุง ูุฅุฌุฑุงุก ุชููุนุงุช. ุงูููุงุฐุฌ ุงูุฎุทูุฉ ูุง ุชุณุชุฎุฏู ุจูุทุงูู ูุงุณุน ููุทุ ุจู ุงูุถุงู ูุฏููุง ุงุณุณ ูุธุฑูู ุบููุฉ ุจุงููุนูููุงุช ุงูุชู ุชุฌุนููุง ูููู ุงุฏูุงุช ูุณุชูุจููู ููููุงุฐุฌ. ุณูุชุนุฑู ุนูู ูููุฐุฌ ุงูุฅูุญุฏุงุฑ ุงูุฎุทู ุงูุจุณูุท ุงูุฐู ูุณุชุฎุฏู ูุชุบูุฑ ูุงุญุฏุ ุณูุชุนูู ููู ูุณุชุฎุฏู ุงููุฒูู ุงูุฅุดุชูุงูู ูุถุจุท ุงููููุฐุฌุ ูุงุฎูุฑุงู ุงูุชูุณุน ูู ุงููููุฐุฌ ูุฅุถุงูุฉ ุงููุฒูุฏ ูู ุงููุชุบูุฑุงุช ูู.

## ุงูุชูุจุค ุจุงูุฅูุฑุงููุงุช

ุณุงุจูุงูุ ุชุนุงูููุง ูุน ุจูุงูุงุช ุชุญุชูู ุนูู ุตู ูุงุญุฏ ููู ุทุงููุฉ ูุงู ุงููุงุฏู ุจุฎุฏูุชูุง ููุฏุฉ ุงุณุจูุน. ุงููุงุฏู ูุงู ุจุฌูุน ุงูุจูุงูุงุช ููููุงู ุจุงูุชููุน ุจูููุฉ ุงูุฅูุฑุงููุฉ ุงูุชู ุณูุญุตู ุนูููุง ูู ุงููุณุชูุจู:

```python
tips = sns.load_dataset('tips')
tips.head()
```

|**size**|**time**|**day**|**smoker**|**sex**|**tip**|**total\_bill**| 
|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:
|2|Dinner|Sun|No|Female|1.01|16.99|0
|3|Dinner|Sun|No|Male|1.66|10.34|1
|3|Dinner|Sun|No|Male|3.5|21.01|2
|2|Dinner|Sun|No|Male|3.31|23.68|3
|4|Dinner|Sun|No|Female|3.61|24.59|4

<br>
```python
sns.distplot(tips['tip'], bins=25);
```

<p align="center"> 
<img src='{{ site.baseurl }}/img/chapter13/linear_tips_3_0.png'>
</p>

ููุง ุชุญุฏุซูุง ุณุงุจูุงูุ ุงุฐุง ุงุฎุชุฑูุง ุงููููุฐุฌ ุงูุซุงุจุช ูุฏุงูุฉ ุงูุฎุทุฃ ุงูุชุฑุจูุนู ุงููุชูุณุทุ ูุฃู ูููุฐุฌูุง ุณูุชููุน ูุชูุณุท ุงูุฅูุฑุงููุงุช:

```python
np.mean(tips['tip'])
```

```ruby
2.9982786885245902
```

ูุนูู ุฐูู ุงู ุนูุฏูุง ูุฃุชู ูุฌููุนุฉ ูู ุงูุฒุจุงุฆู ูููุงุฏู ุซู ูุณุฃููุง ุงููุงุฏู ุนู ูุฌููุนู ุงูุฅูุฑุงููุฉ ุงูุชู ุณูุญุตู ุนูููุงุ ูุณูุฌูุจ ุนููู "ุญูุงูู $ \\$3 $"ุ ุงูุงู ูุงู ุนุฏุฏ ุงูุฒุจุงุฆู ููุฌููุน ุงููุงุชูุฑู.

ููููุ ุนูุฏ ุงูุชุญูู ูู ุจุงูู ุงููุชุบูุฑุงุช ูู ุงูุจูุงูุงุชุ ูููููุง ุงู ูููู ุจุชููุนุงุช ุฏูููู ุฅุฐุง ุงุถููุง ุชูู ุงููุชุบูุฑุงุช ูููููุฐุฌ. ูุซูุงูุ ุงูุฑุณู ุงูุจูุงูู ุงูุชุงูู ููุถุญ ูุฌููุน ุงูุฅูุฑุงููู ููุงุฑูุฉ ุจูุจูุบ ุงููุงุชูุฑุฉ ููุธูุฑ ุงูุนูุงูุฉ ุงูุฅูุฌุงุจูุฉ ุจููููุง:

```python
sns.lmplot(x='total_bill', y='tip', data=tips, fit_reg=False)
plt.title('Tip amount vs. Total Bill')
plt.xlabel('Total Bill')
plt.ylabel('Tip Amount');
```

<p align="center"> 
<img src='{{ site.baseurl }}/img/chapter13/linear_tips_7_0.png'>
</p>

ุนูู ุงูุฑุบู ุงู ูุชูุณุท ุงูุฅูุฑุงููู ูู $ \\$3 $ุ ุงุฐุง ูุงูุช ุงูุทุงููุฉ ุทูุจุช ูุง ูุฌููุนู $ \\$40 $ ูู ุงููุฌุจุงุช ูุฃููุง ูุชุฃูุฏูู ุงู ุงููุงุฏู ุณูุญุตู ุนูู ุงูุซุฑ ูู $ \\$3 $ ูุฃูุฑุงููุฉ. ูุฐุงุ ูุฑูุฏ ุงูุชุนุฏูู ูู ูููุฐุฌูุง ููุชููู ูู ุงูุชููุน ุจูุงุกูุง ุนูู ูุชุบูุฑุงุช ูู ุจูุงูุงุชูุง ุจุฏูุงู ูู ุชููุน ูุชูุณุท ุงูุฅูุฑุงููุฉ. ููููุงู ุจุฐููุ ุณูุณุชุฎุฏู ุงููููุฐุฌ ุงูุฎุทู ุจุฏูุงู ูู ุงูุซุงุจุช.

ููุฑุงุฌุน ุฃููุงู ุงูุฃุฏูุงุช ุงูุชู ูุฏููุง ูุจูุงุก ุงููููุฐุฌ ูุงูุชููุน ูุชุนุฑูู ุจุนุถ ุงูุฑููุฒ ุงูุฌุฏูุฏู ููุชููู ุจุดูู ุงูุถู ูู ุชูุซูู ุงูุนูููุงุช ุงูุฑูุงุถูู ุงูุฅุถุงููู ูู ุงููููุฐุฌ ุงูุฎุทู.

### ุชุนุฑูู ูููุฐุฌ ุฎุทู ุจุณูุท

ูุญู ููุชููู ุจุชููุน ูููุฉ ุงูุฅูุฑุงููู ุจูุงุกูุง ุนูู ูุฌููุน ุงููุงุชูุฑู. ููุฌุนู $ y $ ุชูุซู ูุฌููุน ุงูุฅูุฑุงูููุ ุงููุชุบูุฑ ุงูุฐู ูุฑูุฏ ุงู ูุชููุนู ุงููููุฐุฌ. ู $ x $ ุชูุซู ูุฌููุน ุงููุงุชูุฑูุ ุงููุชุบูุฑ ุงูุฐู ูุฑูุฏ ุงุณุชุฎุฏุงูู ููุชููุน.

ูููู ุจุชุนุฑูู ุงููููุฐุฌ ุงูุฎุทู $ f_\boldsymbol\theta^* $ ุงูุฐู ูุนุชูุฏ ุนูู $ x $:

$$ f_\boldsymbol\theta^* (x) = \theta_1^* x + \theta_0^* $$

ูุชุนุงูู ูุน $ f_\boldsymbol\theta^* (x) $ ุนูู ุงููุง ุงูุฏุงูุฉ ุงูุชู ุฃูุดุฃุช ุงูุจูุงูุงุช.

ุชูุชุฑุถ $ f_\boldsymbol\theta^* (x) $ ุงู $ y $ ูุฏููุง ุนูุงูู ุฎุทูู ูุงููู ูุน $ x $. ููููุ ูู ุจูุงูุงุชูุง ูุง ูุธูุฑ ููุง ุฎุท ูุณุชููู ุจุณุจุจ ูุฌูุฏ ุจุนุถ ุงูุจูุงูุงุช ุงูุนุดูุงุฆูุฉ ุงููุฒุนุฌู $ \epsilon $. ุฑูุงุถูุงูุ ูุฃุฎุฐ ุจุนูู ุงูุฅุนุชุจุงุฑ ูุฐู ุงููุดููู ุจุฅุถุงูุฉ ุงููุตุทูุญ:

$$ y = f_\boldsymbol\theta^* (x) + \epsilon $$

ุฃุฐุง ูุงูุช ุงูุฅูุชุฑุงุถูู ุงู $ y $ ูุฏููุง ุนูุงูุฎ ุฎุทูุฉ ูุงููู ูุน $ x $ุ ูุชูููุง ุจุทุฑููุฉ ูุง ูู ุชููุน ุงููููุฉ ุงูุตุญูุญู ู $ \theta_1^* $ ู $ \theta_0^* $ุ ูุจุดูู ุบูุฑ ุงุนุชูุงุฏู ูู ูููุง ูุฏููุง ุฃู ุนุดูุงุฆูุฉ ูู ุงูุจูุงูุงุชุ ุณูุชููู ูู ุงูุชููุน ุจุดูู ุฏููู ูููุฉ ุงูุฅูุฑุงููุฉ ุงูุชู ุณูุญุตู ุนูููุง ุงููุงุฏู ูู ุฌููุน ุงูุฒุจุงุฆูุ ูุจุดูู ุฏุงุฆู. ุจุงูุทุจุนุ ูุง ูููููุง ุชูุจูุฉ ุฌููุน ุงููุนุงููุฑ ูู ุงูุญูุงู ุงููุงูุนูุฉ. ุจุฏูุงู ูู ุฐููุ ูุชููุน $ \theta_1^* $ ู $ \theta_0^* $ ุจุฅุณุชุฎุฏุงู ุงูุจูุงูุงุช ูุฌุนู ุชููุนุงุชูุง ุงูุฑุจ ุฏูู ูููุงูุน.

#### ุชููุน ุงููููุฐุฌ ุงูุฎุทู

ุจูุง ุฃููุง ูุง ูุณุชุทูุน ุฅูุฌุงุฏ ูููุฉ $ \theta_1^* $ ู $ \theta_0^* $ ุจุดูู ุฏูููุ ุณููุชุฑุถ ุงู ุจูุงูุงุชูุง ุชุชููุน ูููุฉ ูุฐู ุงููุชุบูุฑุงุช. ูุดูุฑ ููุชููุนุงุช ุจ $ \theta_1 $ ู $ \theta_0 $ุ ูุชููุนูุง ุงูุฐู ูุชู ุถุจุทู ุจุงููููุฐุฌ ุจ $ \hat{\theta_1} $ ู $ \hat{\theta_0} $ุ ู ุงููููุฐุฌ:

$$ f_\boldsymbol\theta (x) = \theta_1 x + \theta_0 $$

ุฃุญูุงูุงู ุณุชุฑู $ h(x) $ ุจุฏูุงู ูู $ f_\hat{\boldsymbol\theta} (x) $ุ ุงู $ h $ ุชุนูู ุงููุฑุถูุฉ *Hypothesis*ุ ููู $ f_\hat{\boldsymbol\theta} (x) $ ูู ูุฑุถูุชูุง ู $ f_{\boldsymbol\theta^*} (x) $.

ูู ุฃุฌู ุชุญุฏูุฏ ูููุฉ $ \hat{\theta_1} $ ู $ \hat{\theta_0} $ุ ูููู ุจุฅุฎุชูุงุฑ ุฏุงูุฉ ุชูููุฉ ูุชูููููุง ุจุฅุณุชุฎุฏุงู ุงููุฒูู ุงูุฅุดุชูุงูู.

## ุถุจุท ุงููููุฐุฌ ุงูุฎุทู ุจุฅุณุชุฎุฏุงู ุงููุฒูู ุงูุฅุดุชูุงูู

ูุฑูุฏ ุถุจุท ูููุฐุฌ ุฎุทู ูุชูุจุฃ ุจูููุฉ ุงูุฅูุฑุงููู ูู ูุฌููุน ุงููุงุชูุฑู:

$$ f_\boldsymbol\theta (x) = \theta_1 x + \theta_0 $$

ููุชุณุญูู ููู $ \theta_1 $ ู $ \theta_0 $ุ ูุญุชุงุฌ ุฃููุงู ูุฅุฎุชูุงุฑ ุฏุงูุฉ ุฎุณุงุฑุฉ. ุณูุฎุชุงุฑ ุฏุงูุฉ ุฎุณุงุฑุฉ ุงูุฎุทุฃ ุงูุชุฑุจูุนู ุงููุชูุณุท MSE:

$$ \begin{split}
\begin{aligned}
L(\boldsymbol\theta, \textbf{x}, \textbf{y})
&= \frac{1}{n} \sum_{i = 1}^{n}(y_i - f_\boldsymbol\theta (x_i))^2\\
\end{aligned}
\end{split} $$

ูุงุญุธ ุงููุง ุนุฏููุง ุนูู ุฏุงูุฉ ุงูุฎุณุงุฑู ูุชูุถูุญ ุฅุถุงูุชูุง ููุชุบูุฑ ูู ุงููููุฐุฌ. ุงูุขูุ $ \textbf{x} $ ูู ูุตูููู ุฃุญุงุฏูุฉ ุงูุจุนุฏ ุชุญุชูู ุนูู ุฌููุน ุงูููุงุชูุฑุ ู $ \textbf{y} $ ูู ูุตูููุฉ ุฃุญุงุฏูุฉ ุงูุจุนุฏ ุชุญุชูู ุนูู ูููุฉ ูู ุฅูุฑุงูููุ ู $ \boldsymbol\theta $ ูู ูุตูููุฉ ุชุญุชูู ุนูู ุงูุชุงูู: $ \boldsymbol\theta = [ \theta_1, \theta_0 ] $.

ูุทูู ุนูู ุฅุณุชุฎุฏุงู ุงููููุฐุฌ ุงูุฎุทู ูุน ุฏุงูุฉ ุฎุณุงุฑุฉ ุงูุฎุทุฃ ุงูุชุฑุจูุนู ุงููุชูุณุท ุจุฅุณู ุงูุฅูุญุฏุงุฑ ุงูุฎุทู ูููุฑุจุนุงุช ุงูุตุบุฑู Least-squares Linear Regression. ูููููุง ุงุณุชุฎุฏุงู ุงููุฒูู ุงูุฅุดุชูุงูู ูุฅูุฌุงุฏ ูููุฉ $ \boldsymbol\theta $ ุงูุชู ุชููู ุงูุฎุณุงุฑู. [๐][LinearLeastSquares]

#### ููุงุญุธุฉ ุนู ุฅุณุชุฎุฏุงู ุงูุนูุงูุงุช

ุงุฐุง ุณุจู ุฃู ุฑุฃูุช ุงูุฅูุญุฏุงุฑ ุงูุฎุทู ูููุฑุจุนุงุช ุงูุตุบุฑูุ ูุฏ ุชูุงุญุธ ุงููุง ูุณุชุทูุน ุญุณุงุจ ูุนุงูู ุงูุฅุฑุชุจุงุท ูุฅุณุชุฎุฏุงูู ูุชุญุฏูุฏ ูููุฉ $ \theta_1 $ ู $ \theta_0 $. ูุฐู ุทุฑููุฉ ุงุณูู ูุงุณุฑุน ููุญุณุงุจ ุจุฏูุงู ูู ุฅุณุชุฎุฏุงู ุงููุฒูู ุงูุฅุดุชูุงูู ูู ุฃู ูุนุงุฏููุ ุชูุงูุงู ููุง ูููู ุงุณูู ููุง ุญุณุงุจ ุงููุชูุณุท ุจุฏูุงู ูู ุญุณุงุจ ุงููุฒูู ุงูุฅุดุชูุงูู ูุถุจุท ุงููููุฐุฌ ุงูุซุงุจุช. ุนูู ุฃูุฉ ุญุงูุ ุณูุณุชุฎุฏู ุงููุฒูู ุงูุฅุดุชูุงูู ูุฃููุง ุทุฑููุฉ ุนุงููู ูุชูููู ุงูุฎุณุงุฑู ูุณุชุนูู ูุนูุง ูุงุญูุงู ุนูุฏูุง ูุชุนุฑู ุนูู ููุงุฐุฌ ูุง ูููู ุญุณุงุจ ุฎุณุงุฑุชูุง ุฅุญุตุงุฆูุงู. ุจุงูุฃุตุญุ ูู ูุซูุฑ ูู ุงููุดุงูู ูู ุงูุนุงูู ุงูุญููููุ ุณูุณุชุฎุฏู ุงููุฒูู ุงูุฅุดุชูุงูู ุญุชู ููู ูุงูุช ููุงู ุทุฑู ุฅุญุตุงุฆูู ุชุญูููู ูุฃู ุญุณุงุจูุง ูุฃุฎุฐ ููุชุงู ุงุทูู ูู ุงููุฒูู ุงูุฅุดุชูุงููุ ุฎุงุตุฉ ุนูุฏูุง ุชููู ุงูุจูุงูุงุช ุฐุงุช ุญุฌู ูุจูุฑ.

### ูุดุชูุฉ ุฎุณุงุฑุฉ ุงูุฎุทุฃ ุงูุชุฑุจูุนู ุงููุชูุณุท MSE

ูุฅุณุชุฎุฏุงู ุงููุฒูู ุงูุฅุดุชูุงููุ ูุญุชุงุฌ ูุญุณุงุจ ูุดุชูุฉ ุฎุณุงุฑุฉ ุงูุฎุทุฃ ุงูุชุฑุจูุนู ุงููุชูุณุท ุจุงููุณุจุฉ ู $ \boldsymbol\theta $. ุงูุขู ุจูุง ุงู $ \boldsymbol\theta $ ุนุจุงุฑุฉ ุนู ูุตูููู ุฐุงุช ุทูู 2 ูููุณุช ูููุฉ ุนุฏุฏูุฉ ูุฏุฑุฌุฉ Scalarุ ู $ \nabla_{\boldsymbol\theta} L(\boldsymbol\theta, \textbf{x}, \textbf{y}) $ ุงูุถุงู ูุตูููู ูู ุงูุญุฌู 2. [๐][Scalar]

$$ \begin{split}
\begin{aligned}
\nabla_{\boldsymbol\theta} L(\boldsymbol\theta, \textbf{x}, \textbf{y})
&= \nabla_{\boldsymbol\theta} \left[ \frac{1}{n} \sum_{i = 1}^{n}(y_i - f_\boldsymbol\theta (x_i))^2 \right] \\
&= \frac{1}{n} \sum_{i = 1}^{n}2 (y_i - f_\boldsymbol\theta (x_i))(- \nabla_{\boldsymbol\theta} f_\boldsymbol\theta (x_i))\\
&= -\frac{2}{n} \sum_{i = 1}^{n}(y_i - f_\boldsymbol\theta (x_i))(\nabla_{\boldsymbol\theta} f_\boldsymbol\theta (x_i))\\
\end{aligned}
\end{split} $$

ูุนุฑู ุงู:

$$ f_\boldsymbol\theta (x) = \theta_1 x + \theta_0 $$

ูุฑูุฏ ุญุณุงุจ ูููุฉ $ \nabla_{\boldsymbol\theta} f_\boldsymbol\theta (x_i) $ ูุงูุชู ูู ูุตูููู ุทูููุง 2:

$$ \begin{split}
\begin{aligned}
\nabla_{\boldsymbol\theta} f_\boldsymbol\theta (x_i)
&= \begin{bmatrix}
     \frac{\partial}{\partial \theta_0} f_\boldsymbol\theta (x_i)\\
     \frac{\partial}{\partial \theta_1} f_\boldsymbol\theta (x_i)
   \end{bmatrix} \\
&= \begin{bmatrix}
     \frac{\partial}{\partial \theta_0} [\theta_1 x_i + \theta_0]\\
     \frac{\partial}{\partial \theta_1} [\theta_1 x_i + \theta_0]
   \end{bmatrix} \\
&= \begin{bmatrix}
     1 \\
     x_i
   \end{bmatrix} \\
\end{aligned}
\end{split} $$

ุงุฎูุฑุงูุ ูุนูุถูุง ูู ูุนุงุฏูุชูุง ุงูุฃุณุงุณูู ููุญุตู ุนูู ุงูุชุงูู:

$$ \begin{split}
\begin{aligned}
\nabla_{\boldsymbol\theta} L(\theta, \textbf{x}, \textbf{y})
&= -\frac{2}{n} \sum_{i = 1}^{n}(y_i - f_\boldsymbol\theta (x_i))(\nabla_{\boldsymbol\theta} f_\boldsymbol\theta (x_i))\\
&= -\frac{2}{n} \sum_{i = 1}^{n} (y_i - f_\boldsymbol\theta (x_i)) \begin{bmatrix} 1 \\ x_i \end{bmatrix} \\
&= -\frac{2}{n} \sum_{i = 1}^{n} \begin{bmatrix}
    (y_i - f_\boldsymbol\theta (x_i)) \\
    (y_i - f_\boldsymbol\theta (x_i)) x_i
    \end{bmatrix} \\
\end{aligned}
\end{split} $$

ูุฐู ูุตูููุฉ ูู ุทูููุง 2 ููู $ (y_i - f_\boldsymbol\theta (x_i)) $ ูููุฉ ุนุฏุฏูุฉ ูุฏุฑุฌู.

### ุชุทุจูู ุงููุฒูู ุงูุฅุดุชูุงูู

ุงูุขูุ ููููู ุจุถุจุท ุงููููุฐุฌ ุงูุฎุทู ุนูู ุจูุงูุงุช ุงูุฅูุฑุงููุงุช ูุชููุน ูููุฉ ุงูุฅูุฑุงููุฉ ูู ูุฌููุน ุงููุงุชูุฑุฉ.

ุฃููุงูุ ูููู ุจุชุนุฑูู ุฏุงูุฉ ูู ุจุงูุซูู ูุญุณุงุจ ุงูุฎุณุงุฑู:

```python
def simple_linear_model(thetas, x_vals):
    '''ูุชูุฌุฉ ูุฐู ุงูุฏุงูู ูู ุงููููู ุงููุชููุนู ูู ุงููููุฐุฌ ุงูุฎุทู'''
    return thetas[0] + thetas[1] * x_vals

def mse_loss(thetas, x_vals, y_vals):
    return np.mean((y_vals - simple_linear_model(thetas, x_vals)) ** 2)
```

ุซู ูุนุฑู ุทุงูุฉ ุชููู ุจุญุณุงุจ ุฎุทูุฉ ุงูุฎุณุงุฑู:

```python
def grad_mse_loss(thetas, x_vals, y_vals):
    n = len(x_vals)
    grad_0 = y_vals - simple_linear_model(thetas, x_vals)
    grad_1 = (y_vals - simple_linear_model(thetas, x_vals)) * x_vals
    return -2 / n * np.array([np.sum(grad_0), np.sum(grad_1)])
```

ุณูููู ุจุฅุณุชุฎุฏุงู ุงูุฏุงูุฉ `minimize` ุงูุชู ุณุจู ุงู ุนุฑููุงูุง ูุชุทุจูู ุงููุฒูู ุงูุฅุดุชูุงูู:

```python
def minimize(loss_fn, grad_loss_fn, x_vals, y_vals,
             alpha=0.0005, progress=True):
        '''
    ุชุณุชุฎุฏู ุงููุฒูู ุงูุฅุดุชูุงูู ููุชูููู ูู ุฏุงูุฉ ุงูุฎุณุงุฑู loss_fn.
    ุชูุชุฌ ููุง ุงูุฏุงูู ุงููููู ุงูุตุบุฑู ู theta_hat (ฮธ^) ุนูุฏูุง ูููู
    ุงูุชุบููุฑ ุงูู ูู 0.001 ุจูู ุงูุชูุฑุงุฑุงุช.
    '''
    theta = np.array([0., 0.])
    loss = loss_fn(theta, x_vals, y_vals)
    while True:
        if progress:
            print(f'theta: {theta} | loss: {loss}')
        gradient = grad_loss_fn(theta, x_vals, y_vals)
        new_theta = theta - alpha * gradient
        new_loss = loss_fn(new_theta, x_vals, y_vals)
        
        if abs(new_loss - loss) < 0.0001:
            return new_theta
        
        theta = new_theta
        loss = new_loss
```

ูุงูุขู ูููู ุจุชุทูุจู ุงููุฒูู ุงูุฅุดุชูุงูู:

```python
thetas = minimize(mse_loss, grad_mse_loss, tips['total_bill'], tips['tip'])
```

```ruby
theta: [0. 0.] | cost: 10.896283606557377
theta: [0.   0.07] | cost: 3.8937622006094705
theta: [0.  0.1] | cost: 1.9359443267168215
theta: [0.01 0.12] | cost: 1.388538448286097
theta: [0.01 0.13] | cost: 1.235459416905535
theta: [0.01 0.14] | cost: 1.1926273731479433
theta: [0.01 0.14] | cost: 1.1806184944517062
theta: [0.01 0.14] | cost: 1.177227251696266
theta: [0.01 0.14] | cost: 1.1762453624313751
theta: [0.01 0.14] | cost: 1.1759370980989148
theta: [0.01 0.14] | cost: 1.175817178966766
```

ููุงุญุธ ุงู ุงููุฒูู ุงูุฅุดุชูุงูู ููุชุฑุจ ููููุฉ $ \hat\theta_0 = 0.01 $ ู $ \hat\theta_0 = 0.14 $. ูููุฐุฌูุง ุงูุฎุทู ุงูุขู:

$$ y = 0.14x + 0.01 $$

ูููููุง ุงุณุชุฎุฏุงู ุงููุชูุฌุฉ ุงูุณุงุจูู ูุฑุณู ุชููุนุงุชูุง ุจุฌุงูุจ ุงูุจูุงูุงุช ุงูุญููููู:

```python
x_vals = np.array([0, 55])
sns.lmplot(x='total_bill', y='tip', data=tips, fit_reg=False)
plt.plot(x_vals, simple_linear_model(thetas, x_vals), c='goldenrod')
plt.title('Tip amount vs. Total Bill')
plt.xlabel('Total Bill')
plt.ylabel('Tip Amount');
```

<p align="center"> 
<img src='{{ site.baseurl }}/img/chapter13/linear_grad_16_0.png'>
</p>

ููุงุญุธ ุงูู ุนูุฏูุง ุชููู ูููุฉ ุงููุงุชูุฑู $ \\$10 $ุ ูุฃู ูููุฐุฌูุง ูุชููุน ุงู ุงููุงุฏู ุณูุญุตู ุนูู ุฅูุฑุงููุฉ ุจุญูุงูู $ \\$1.50 $. ุจููุณ ุงูุทุฑููุฉุ ุงุฐุง ูุงูุช ูููุฉ ุงููุงุชูุฑู $ \\$40 $ ูุฃู ุงููููุฐุฌ ูุชููุน ุญุตูู ุงููุงุฏู ุนูู ุฅูุฑุงููุฉ ุจูููุฉ $ \\$6.00 $.

## ุงูุฅูุญุฏุงุฑ ุงูุฎุทู ุงููุชุนุฏุฏ

ูููุฐุฌูุง ุงูุฎุทู ุงูุจุณูุท ูููุฒุฉ ุฅุถุงููุฉ ุนู ุงููููุฐุฌ ุงูุซุงุจุชุ ุงูููุฒู ูู ุงุณุชุฎุฏุงูู ุงูุจูุงูุงุช ููุชููุน. ููููุ ูุง ูุฒุงู ุงููููุฐุฌ ูุญุฏูุฏ ูููู ูุณุชุฎุฏู ูุชุบูุฑ ูุงุญุฏ ูู ุจูุงูุงุชูุง. ุงููุซูุฑ ูู ุงูุจูุงูุงุช ุชุญุชูู ุนูู ุงูุซุฑ ูู ูุชุบูุฑ ููู ููููุฏ ููุฅุณุชุฎุฏุงูุ ููููู ููุฅูุญุฏุงุฑ ุงูุฎุทู ุงููุชุนุฏุฏ ุงูุฅุณุชูุงุฏู ูู ุฐูู. ูุซูุงูุ ููุฃุฎุฐ ุงูุจูุงูุงุช ุงูุชุงููู ูุฃููุงุน ุงูุณูุงุฑุงุช ููุนูููุงุช ุตุฑู ุงููููุฏ ุจุงูููู ููู ุฌุงููู (Milage Per Gallon MPG):

```python
mpg = pd.read_csv('mpg.csv').dropna().reset_index(drop=True)
mpg
```

| car name                  | origin | model year | \.\.\. | displacement | cylinders | mpg    |        |
|:-------------------------:|:------:|:----------:|:------:|:------------:|:---------:|:------:|:------:|
| chevrolet chevelle malibu | 1      | 70         | \.\.\. | 307          | 8         | 18     | 0      |
| buick skylark 320         | 1      | 70         | \.\.\. | 350          | 8         | 15     | 1      |
| plymouth satellite        | 1      | 70         | \.\.\. | 318          | 8         | 18     | 2      |
| \.\.\.                    | \.\.\. | \.\.\.     | \.\.\. | \.\.\.       | \.\.\.    | \.\.\. | \.\.\. |
| dodge rampage             | 1      | 82         | \.\.\. | 135          | 4         | 32     | 389    |
| ford ranger               | 1      | 82         | \.\.\. | 120          | 4         | 28     | 390    |
| chevy s\-10               | 1      | 82         | \.\.\. | 119          | 4         | 31     | 391    |


```ruby
392 rows ร 9 columns
```

> ูุชุญููู ูุงุนุฏุฉ ุงูุจูุงูุงุช mpg.csv [ุงุถุบุท ููุง]({{ site.baseurl }}/files/chapter13/mpg.csv).

ูุจุฏู ููุง ุฃู ุงูุซุฑ ูู ูุชุบูุฑ ูุฃุซุฑ ุนูู ุตุฑู ุงูุณูุงุฑู ูููููุฏ. ูุซูุงูุ ูุจุฏู ุงู ุตุฑู ุงูููุฏ ููู ุนูุฏูุง ุชุฒูุฏ ููุฉ ุงูุญุตุงู ููุณูุงุฑู:

```python
sns.lmplot(x='horsepower', y='mpg', data=mpg);
```

<p align="center"> 
<img src='{{ site.baseurl }}/img/chapter13/linear_multiple_6_0.png'>
</p>

ููููุ ุงูุณูุงุฑุงุช ุงูุชู ูู ุงูุณููุงุช ุงูุฃุฎูุฑู ูุฏููุง ุตุฑู ูููุฏ ุงูุถู ุจุดูู ุนุงู ุนู ุงูุณูุงุฑุงุช ุงููุฏููู:

```python
sns.lmplot(x='model year', y='mpg', data=mpg);
```

<p align="center"> 
<img src='{{ site.baseurl }}/img/chapter13/linear_multiple_8_0.png'>
</p>

ูุธูุฑ ุฃู ุจุฃููุงููุง ุงูุญุตูู ุนูู ูุชุงุฆุฌ ุงูุซุฑ ุฏูุฉ ูููููุฐุฌ ุฅุฐุง ุงุณุชุทุนูุง ุฅุณุชุฎุฏุงู ููุฉ ุงูุญุตุงู ูุณูุฉ ุตูุงุนุฉ ุงูุณูุงุฑู ููุชูุจุค ุนู ูููุฉ ุตุฑู ุงููููุฏ ุจุงูููู ููู ุฌุงููู MPG. ุจุงูุฃุตุญุ ูุจุฏู ุงู ุงููููุฐุฌ ุงููุซุงูู ูุฃุฎุฐ ุจุนูู ุงูุฅุนุชุจุงุฑ ุฌููุน ุงููุชุบูุฑุงุช ุงูุฑูููู ูู ุจูุงูุงุชูุง. ูููููุง ุชูุณูุน ูููุฐุฌูุง ุงูุฎุทู ุฐู ุงููุชุบูุฑ ุงููุงุญุฏ ููุชููู ูู ุงูุชูุจุค ุจูุงุกูุง ุนูู ุฃู ุนุฏุฏ ูู ุงููุชุบูุฑุงุช.

ุฐูุฑูุง ุงู ุชุนุฑูู ุงููููุฐุฌ ูุงูุชุงูู:

$$ f_\boldsymbol\theta (\textbf{x}) = \theta_0 + \theta_1 x_1 + \ldots + \theta_p x_p $$

ูููุง $ \textbf{x} $ ุชูุซู ูุชูุฌูู Vector ุชุญุชูู ุนูู ุนุฏุฏ $ p $ ูู ุงููุชุบูุฑุงุช ูุณูุงุฑู ูุงุญุฏู. ุงููููุฐุฌ ุงูุณุงุจู ูููู ุงูุชุงููุ "ุฎุฐ ุฃูุซุฑ ูู ูุชุบูุฑ ุนู ุงูุณูุงุฑูุ ุงุถุฑุจูู ุจูุฒู Weight ูุนููุ ุซู ุงุฌูุนูู ูุนุงู ููููุงู ุจุชููุน ุตุฑููุฉ ุงูุณูุงุฑู ูููููุฏ ุจุงูููู ููู ุฌุงููู".

> ุชูุฌุฏ ุงููุงุน ูุชุนุฏุฏุฉ ูู ุทุฑู ุชูุซูู ุงูุฃุฑูุงู: [๐][Vector]
> <p align="center"> 
> <img src='{{ site.baseurl }}/img/chapter13/scalar-vector-matrix.png'>
> </p>
> - ุนุฏุฏ Scalar: ุฑูู ุตุญูุญ ูุซูุงู $ 7, -4, 0.345 $.
> - ุงููุชูุฌู Vector: ูู ูุตูููุฉ ุฃุฑูุงู ุงุญุงุฏูุฉ ุงูุฃุจุนุงุฏุ ุชููู ุงูุง ูู ุตู ูุงุญุฏ ุฃู ุนุงููุฏ ูุงุญุฏ.
> - ูุตูููู Matrix: ูุตูููู ุฃุฑูุงู ุชุญุชูู ุนูู ุงูุซุฑ ูู ุตู ุฃู ุนุงููุฏ.
>


ูุซูุงูุ ุฅุฐุง ุงุฑุฏูุง ุงุฌุฑุงุก ุชููุน ูุฃูู ุณูุงุฑู ูู ุจูุงูุชูุง ุจุฅุณุชุฎุฏุงู ููุฉ ุงูุญุตุงูุ ุงููุฒูุ ูุณูุฉ ุงูุตูุงุนูุ ูุณูููู ุดูู ุงููุชูุฌูู $ \textbf{x} $ ูุงูุชุงูู:

| model year |  weight | horsepower    |        |
|:-------------------------:|:------:|:----------:|:------:|
| 70 | 3504.0      | 130.0         | 0 |

ูู ูุฐุง ุงููุซุงู ุงุจูููุง ุงุณูุงุก ุงูุฃุนูุฏุฉ ููุชูุถูุญุ ูููู ุชุฐูุฑ ุงู $ \textbf{x} $ ุชุญุชูู ููุท ุนูู ุงูููู ุงูุฑูููุฉ ูู ุงูุฌุฏูู ุงูุณุงุจู: $ \textbf{x} = [130.0, 3504.0, 70] $.

ุงูุขูุ ุณูููู ุจุชุนุฑูู ุทุฑููู ุญุณุงุจูู ุณุชุณูู ุงูุนูููุงุช ุงูุญุณุงุจูู ุงููุงุฏูู. ุณูููู ุจุฅุถุงูุฉ ุงูุฑูู $ 1 $ ุฅูู ุงููุชุฌูู $ \textbf{x} $ุ ูุณูููู ุดูู ุงูุตู ูุงูุชุงูู:

| model year |  weight | horsepower    |  bias  ||
|:-------------------------:|:------:|:----------:|:------:|:--:|
| 70 | 3504.0      | 130.0         | 1 |0|

ุงูุขูุ ูุงุญุธ ูุง ุณูุญุฏุซ ููุนูููุฉ ุงูุณุญุงุจูู ููููุฐุฌูุง:

$$ \begin{split}
\begin{aligned}
f_\boldsymbol\theta (\textbf{x})
&= \theta_0 + \theta_1 x_1 + \ldots + \theta_p x_p \\
&= \theta_0 (1) + \theta_1 x_1 + \ldots + \theta_p x_p \\
&= \theta_0 x_0 + \theta_1 x_1 + \ldots + \theta_p x_p \\
f_\boldsymbol\theta (\textbf{x}) &= \boldsymbol\theta \cdot \textbf{x}
\end{aligned}
\end{split} $$

ูููุง $ \boldsymbol\theta \cdot \textbf{x} $ ูู ูุชูุฌู ูุญุงุตู ุถุฑุจ $ \boldsymbol\theta $ ู $ \textbf{x} $. ุตูููุช ุงููุชูุฌูุงุช ูุงููุตูููุงุช ููุชุงุจุฉ ุงูุชุฑููุจุงุช ุงูุฎุทูู ููุฐูู ููู  ููุงุณุจุฉ ุฌุฏุงู ููููุฐุฌูุง ุงูุฎุทู. ููููุ ูุฌุจ ุนููู ูู ุงูุขู ูุตุงุนุฏูุง ุชุฐูุฑ ุงู $ \boldsymbol\theta \cdot \textbf{x} $ ูู ุญุงุตู ุถุฑุจ ูุชูุฌู ุจุฃุฎุฑู. ูููู ุฃูุถุงู ููุฒุน ุงูุดูุ ุชูุณูุน ุนูููุฉ ุถุฑุจ ุงููุชุฌูุชูู  ุฅูู ุนูููุฉ ุฌูุน ูุถุฑุจ ูุจุณุทู.

ุงูุขูุ ูููู ุจุชุนุฑูู ุงููุตูููู $ \textbf{X} $ ูุงูุชู ุณุชููู ุงููุตูููุฉ ุงูุชู ุชุญุชูู ุนูู ุฌููุน ุงููุงุน ุงูุณูุงุฑุงุช ูุตูููุ ูุฃูู ุนุงููุฏ ูู ูููุฉ ุงูุชุญูุฒ Bias. ูุซูุงูุ ูุฐู ุฃูู ุฎูุณ ุงุณุทุฑ ูู ุงููุตูููู $ \textbf{X} $:

| model year |  weight | horsepower    |  bias  ||
|:-------------------------:|:------:|:----------:|:------:|:--:|
| 70 | 3504.0      | 130.0         | 1 |0|
| 70 | 3693.0      | 165.0         | 1 |1|
| 70 | 3436.0	      | 150.0         | 1 |2|
| 70 | 3433.0	      | 150.0         | 1 |3|
| 70 | 3449.0	     | 140.0         | 1 |4|

ููุชุฐููุฑ ูุฑู ุฃุฎุฑูุ ุงููุตูููุฉ ุงูุญูููู $ \textbf{X} $ ููุท ุชุญุชูู ุนูู ุงูููู ุงูุฑูููู ูู ุงูุฌุฏูู ุงูุณุงุจู.

ูุงุญุธ ุงู $ \textbf{X} $ ุชุญุชูู ุนูู ุฃูุซุฑ ูู ููุชุฌูู $ \textbf{x} $ ููู ุจุนุถูุง ุงูุจุนุถ. ููููู ุงููุตู ูุงุถุญุงูุ ูููู ุจุชุนุฑูู $ \textbf{X}\_{i} $ ูุงูุชู ุชุฑูุฒ ูููุชูุฌู ูู ุงูุตู ุฑูู $ i $ ูู ุงููุตูููู $ \textbf{X} $. ูููู ุจุชุนุฑูู $ X_{i,j} $ ูุงูุชู ุชูุซู ุงููููู ุฐุงุช ุงูุฑูู $ j $ ูู ุงูุตู ุฐู ุงูุฑูู $ i $ ูู ุงููุตูููู $ \textbf{X} $. ูุฐุงุ $ \textbf{X}\_{i} $ ูู ูุชูุฌู ุฐุงุช ุงุจุนุงุฏ $ p $ ู $ $ \textbf{X}\_{i,j} $ ูู ุนุฏุฏ. $ $ \textbf{X} $ ูู ูุตูููุฉ $ n \times p $ุ ูููุง $ n $ ูู ุนุฏุฏ ุงูุณูุงุฑุงุช ูุฏููุง ู $ p $ ูู ุนุฏุฏ ุงููุชุบูุฑุงุช ููู ุณูุงุฑู.

ูุซูุงูุ ูู ุงูุฌุฏูู ุงูุณุงุจู ูุฏููุง $ \textbf{X}\_4 = [1, 140, 3449, 70] $ ู $ X_{4,1} = 140 $ ูุฐุง ุงูุฑููุฒ ูู ูููู ุนูุฏ ุชุนุฑูู ุฏูุงู ุงูุฎุณุงุฑู ูุฃููุง ุณูุญุชุงุฌ ุฅูู ููุง ุงููููุชูู $ \textbf{X} $ุ ูุตูููุฉ ุงูุจูุงูุงุช ุงููุฏุฎูู ูููููุฐุฌุ ู $ y $ุ ูุชูุฌู ุตุฑู ุงููููุฏ ุจุงูููู ููู ุฌุงููู.

> - $ \textbf{X} $ ูู ูุตูููู Matrix.
> - $ \textbf{x} $ ูู ูุชูุฌู Vector ููู ููุง ูู ุตู ุนูู ุญุฏู. ูุซูุงู ุงูุณุทุฑ ุงูุซุงูู: $ [1, 165.0, 3693.0, 70] $.
> - $ j $ ูู ุฑูู ุตุญูุญ Scalar ูุซูุงู ูุฒู ุงูุณูุงุฑู ูู ุงูุตู ุงูุซุงูุซ $ 3436.0 $.

### ุฎุณุงุฑุฉ ุงูุฎุทุฃ ุงูุชุฑุจูุนู ุงููุชูุณุท ูุฅูุญุฏุงุฑูุง

ุฏุงูุฉ ุฎุณุงุฑุฉ ุงูุฎุทุฃ ุงูุชุฑุจูุนู ุงููุชูุณุท ุชุฃุฎุฐ ูุชูุฌู ุจูุฒู $ \boldsymbol\theta $ ู ูุฏุฎูุงุช ุนูู ุดูู ูุตูููู $ \textbf{X} $ุ ู ูุชูุญู ูุตุฑู ุงููููุฏ ุจุงูููู ููู ุฌุงููู ููู ุณูุงุฑู $ \textbf{y} $:

$$ \begin{split}
\begin{aligned}
L(\boldsymbol\theta, \textbf{X}, \textbf{y})
&= \frac{1}{n} \sum_{i}(y_i - f_\boldsymbol\theta (\textbf{X}_i))^2\\
\end{aligned}
\end{split} $$

ุงูุฌุฏูุง ูุณุจูุงู ูุดุชูุฉ ุฏุงูุฉ ุฎุณุงุฑุฉ ุงูุฎุทุฃ ุงูุชุฑุจูุนู ุงููุชูุณุท ุจุงููุณุจุฉ ู $ \boldsymbol\theta $:

$$ \begin{split}
\begin{aligned}
\nabla_{\boldsymbol\theta} L(\boldsymbol\theta, \textbf{X}, \textbf{y})
&= -\frac{2}{n} \sum_{i}(y_i - f_\boldsymbol\theta (\textbf{X}_i))(\nabla_{\boldsymbol\theta} f_\boldsymbol\theta (\textbf{X}_i))\\
\end{aligned}
\end{split} $$

ูุนุฑู ุฃูุถุงู ุงู:

$$ \begin{split}
\begin{aligned}
f_\boldsymbol\theta (\textbf{x}) &= \boldsymbol\theta \cdot \textbf{x} \\
\end{aligned}
\end{split} $$

ููููู ุจุญุณุงุจ $ \nabla_{\boldsymbol\theta} f_\boldsymbol\theta (\textbf{x}) $. ุนูููุฉ ุงูุญุณุงุจ ุงุณูู ูู ุงููุชููุน ูุฃู $ \boldsymbol\theta \cdot \textbf{x} = \theta_0 x_0 + \ldots + \theta_p x_p $ ุฅุฐุงู $ \frac{\partial}{\partial \theta_0}(\boldsymbol\theta \cdot \textbf{x}) = x_0 $ ู $ \frac{\partial}{\partial \theta_1}(\boldsymbol\theta \cdot \textbf{x}) = x_1 $ ุฅูู ุขุฎุฑู:

$$ \begin{split}
\begin{aligned}
\nabla_{\boldsymbol\theta} f_\boldsymbol\theta (\textbf{x})
&= \nabla_{\boldsymbol\theta} [ \boldsymbol\theta \cdot \textbf{x} ] \\
&= \begin{bmatrix}
     \frac{\partial}{\partial \theta_0} (\boldsymbol\theta \cdot \textbf{x}) \\
     \frac{\partial}{\partial \theta_1} (\boldsymbol\theta \cdot \textbf{x}) \\
     \vdots \\
     \frac{\partial}{\partial \theta_p} (\boldsymbol\theta \cdot \textbf{x}) \\
   \end{bmatrix} \\
&= \begin{bmatrix}
     x_0 \\
     x_1 \\
     \vdots \\
     x_p
   \end{bmatrix} \\
\nabla_{\boldsymbol\theta} f_\boldsymbol\theta (\textbf{x}) &= \textbf{x}
\end{aligned}
\end{split} $$

ุงุฎูุฑุงูุ ูููู ุจุฅุฏุฎุงู ุงููุชูุฌู ูุญุณุงุจ ุงูุฎุทูู:

$$ \begin{split}
\begin{aligned}
\nabla_{\boldsymbol\theta} L(\boldsymbol\theta, \textbf{X}, \textbf{y})
&= -\frac{2}{n} \sum_{i}(y_i - f_\boldsymbol\theta (\textbf{X}_i))(\nabla_{\boldsymbol\theta} f_\boldsymbol\theta (\textbf{X}_i))\\
&= -\frac{2}{n} \sum_{i}(y_i - \boldsymbol\theta \cdot \textbf{X}_i)(\textbf{X}_i)\\
\end{aligned}
\end{split} $$

ุชุฐูุฑ ุฃูู ุจูุง ุงู $ y_i - \boldsymbol\theta \cdot \textbf{X}\_i $ ูู ุนุฏุฏ ู $ \textbf{X}_i $ ูู ูุชูุฌู ุฐุงุช $ p $ ุงุจุนุงุฏุ ุงูุฎุทูู $ \nabla\_{\boldsymbol\theta} L(\boldsymbol\theta, \textbf{X}, \textbf{y}) $ ูู ุงูุถุงู ูุชูุฌู ุฐุงุช $ p $ ุงุจุนุงุฏ.

ุฑุฃููุง ููุณ ูุฐุง ุงูููุน ูู ุงููุชุงุฆุฌ ุนูุฏูุง ูููุง ุจุญุณุงุจ ุฎุทูุฉ ุงูุฅูุญุฏุงุฑ ุงูุฎุทู ููุฌุฏูุง ุงููุง ุซูุงุฆูุฉ ุงูุฃุจุนุงุฏ ุจูุง ุงู $ \boldsymbol\theta $ ูุงูุช ุซูุงุฆูุฉ ุงูุฃุจุนุงุฏ.

### ุถุจุท ุงููููุฐุฌ ุงูุฎุทู ูุน ุงููุฒูู ุงูุฅุดุชูุงูู

ูููููุง ุงูุขู ุฅุฏุฎุงู ุงูุฎุณุงุฑู ููุดุชูุชูุง ุฅูู ุฏุงูุฉ ุงููุฒูู ุงูุฅุดุชูุงูู. ูุงูุนุงุฏูุ ุณูููู ุจุชุนุฑูู ุงููููุฐุฌุ ุฏุงูุฉ ุงูุฎุณุงุฑู ู ุฏุงูุฉ ุงููุฒูู ุงูุฅุดุชูุงูููุดุชูุชูุง ูู ุจุงูุซูู:

```python
def linear_model(thetas, X):
    '''Returns predictions by a linear model on x_vals.'''
    return  X @ thetas

def mse_loss(thetas, X, y):
    return np.mean((y - linear_model(thetas, X)) ** 2)

def grad_mse_loss(thetas, X, y):
    n = len(X)
    return -2 / n * (X.T @ y  - X.T @  X @ thetas)
```

> ุงุณุชุฎุฏู ุงููุงุชุจ ุงูุฑูุฒ `@` ููู ุนูุงูุฉ ุถุฑุจ ุจูู ุงููุตูููุงุช ูู Numpyุ ูุฐุง ูุญุชุงุฌ ุฃู ุชููู `X` ู `thetas` ูู ูุตูููุงุช ูู Numpy ูู ูุนูู ุงูุฑูุฒ `@`.

ุงูุขูุ ุจุจุณุงุทู ูููููุง ุงุฏุฎุงู ุฏูุงููุง ุฅูู ุงููุฒูู ุงูุฅุดุชูุงูู:

```python
X = (mpg_mat
     .loc[:, ['bias', 'horsepower', 'weight', 'model year']]
     .to_numpy())
y = mpg_mat['mpg'].to_numpy()

thetas = minimize(mse_loss, grad_mse_loss, X, y)
print(f'theta: {thetas} | loss: {mse_loss(thetas, X, y):.2f}')
```

```ruby
theta: [ 0.  0.  0.  0.] | cost: 610.47
theta: [ 0.    0.    0.01  0.  ] | cost: 178.95
theta: [ 0.01 -0.11 -0.    0.55] | cost: 15.78
theta: [ 0.01 -0.01 -0.01  0.58] | cost: 11.97
theta: [-4.   -0.01 -0.01  0.63] | cost: 11.81
theta: [-13.72  -0.    -0.01   0.75] | cost: 11.65
theta: [-13.72  -0.    -0.01   0.75] | cost: 11.65
```

> ุงุณุชุฎุฏู ุงููุงุชุจ ูู ุงูููุฏ ุงูุจุฑูุฌู ุงูุณุงุจู ุงูุฏุงูุฉ `minimize` ููู ูุฎุชููู ููููุงู ุนู ุงูุณุงุจููุ ุงุฌุฑู ุนูููุง ุงูุชุนุฏููุงุช ุงูุชุงููู:
>
> ```python
> from scipy.optimize import minimize as sci_min
> def minimize(loss_fn, grad_loss_fn, X, y, progress=True):
>     '''
>     ุชุณุชุฎุฏู ุฏุงูุฉ ูู ููุชุจุฉ scipy ููุชูููู ูู ุฎุณุงุฑุฉ ุงูุฏุงูู loss_fun 
>     ุจุฅุณุชุฎุฏุงู ูููุฐุฌ ูู ุงููุฒูู ุงูุฅุดุชูุงูู
>     '''
>    theta = np.zeros(X.shape[1])
>    iters = 0
>    
>    def objective(theta):
>        return loss_fn(theta, X, y)
>    def gradient(theta):
>        return grad_loss_fn(theta, X, y)
>    def print_theta(theta):
>        nonlocal iters
>        if progress and iters % progress == 0:
>            print(f'theta: {theta} | loss: {loss_fn(theta, X, y):.2f}')
>        iters += 1
>        
>    print_theta(theta)
>    return sci_min(
>        objective, theta, method='BFGS', jac=gradient, callback=print_theta,
>        tol=1e-7
>    ).x
> ```

ุจูุงุกูุง ุนูู ุงููุฒูู ุงูุฅุดุชูุงููุ ูุฃู ูููุฐุฌูุง ุงูุฎุทู ูู ูุงูุชุงูู:

$$ y = -13.72 - 0.01x_2 + 0.75x_3 $$

### ุงูุฑุณู ุงูุจูุงูู ูุชูุจุคุงุชูุง

ููู ุฃุฏู ูููุฐุฌูุงุ ููุงุญุธ ุงู ุงูุฎุณุงุฑู ููุช ุจุดูู ูุจูุฑ (ูู 610 ุญุชู 11.6). ูููููุง ุทุจุงุนุฉ ูุชุงุฆุฌ ุชููุน ุงููููุฐุฌ ุจุฌุงูุจ ุงููุชุงุฆุฌ ุงูุญูููู:

```python
reordered = ['predicted_mpg', 'mpg', 'horsepower', 'weight', 'model year']
with_predictions = (
    mpg
    .assign(predicted_mpg=linear_model(thetas, X))
    .loc[:, reordered]
)
with_predictions
```

| model year | weight | horsepower | mpg    | predicted\_mpg |        |
|:----------:|:------:|:----------:|:------:|:--------------:|:------:|
| 70         | 3504   | 130        | 18     | 15\.447125     | 0      |
| 70         | 3693   | 165        | 15     | 14\.053509     | 1      |
| 70         | 3436   | 150        | 18     | 15\.785576     | 2      |
| \.\.\.     | \.\.\. | \.\.\.     | \.\.\. | \.\.\.         | \.\.\. |
| 82         | 2295   | 84         | 32     | 32\.4569       | 389    |
| 82         | 2625   | 79         | 28     | 30\.354143     | 390    |
| 82         | 2720   | 82         | 31     | 29\.726608     | 391    |

```ruby
392 rows ร 5 columns
```

ุจูุง ุงููุง ุฃูุฌุฏูุง $ \boldsymbol\theta $ ูู ุงููุฒูู ุงูุฅุดุชูุงููุ ูููููุง ุงู ูุชุฃูุฏ ูู ุงูู ุณุทุฑ ูู ุจูุงูุงุชูุง ุงู $ \boldsymbol\theta \cdot \textbf{X}_0 $ ุชุทุงุจู ุชููุนูุง ุงูุณุงุจู:

```python
print(f'Prediction for first row: '
      f'{thetas[0] + thetas[1] * 130 + thetas[2] * 3504 + thetas[3] * 70:.2f}')
```

```ruby
Prediction for first row: 15.45
```

ูููููุง ุฑุณู ุงููุฑู ุจูู ุชููุนูุง ูุงููุชูุฌุฉ ุงูุญูููู (ุงููุชูุฌุฉ ุงูุญูููู - ุงูุชููุน):

```python
resid = y - linear_model(thetas, X)
plt.scatter(np.arange(len(resid)), resid, s=15)
plt.title('Residuals (actual MPG - predicted MPG)')
plt.xlabel('Index of row in data')
plt.ylabel('MPG');
```

<p align="center"> 
<img src='{{ site.baseurl }}/img/chapter13/linear_multiple_34_0.png'>
</p>

ูุจุฏู ูุงุถุญุงู ุงู ูููุฐุฌูุง ูุนุทู ุชููุนุงุช ููุทููู ููุซูุฑ ูู ุงูุณูุงุฑุงุชุ ุนูู ุงูุฑุบู ุงู ุจุนุถ ุงููุชุงุฆุฌ ูุงู ุงููุฑู ูููุง ุฃูุซุฑ ูู 10 ููู ููู ุฌุงููู (ุจุนุถ ุงูุณูุงุฑุงุช ูุฏููุง ุงูู ูู 10!). ูุฏ ููููุง ุงูุซุฑ ูุนุฑูุฉ ูุณุจุฉ ุงูุฎุท ุจูู ุงูุชููุน ูุงููุชูุฌุฉ ุงูุตุญูุญู ูุตุฑู ุงููููุฏ:

```python
resid_prop = resid / with_predictions['mpg']
plt.scatter(np.arange(len(resid_prop)), resid_prop, s=15)
plt.title('Residual proportions (resid / actual MPG)')
plt.xlabel('Index of row in data')
plt.ylabel('Error proportion');
```

<p align="center"> 
<img src='{{ site.baseurl }}/img/chapter13/linear_multiple_36_0.png'>
</p>

ูุธูุฑ ููุง ุงู ุงููููุฐุฌ ุนุงุฏุฉู ุงุจุนุฏ ุจุญุฏูุฏ 20% ูู ุงููููู ุงูุตุญูุญู.

### ุงุณุชุฎุฏุงู ูุงูู ุงูุจูุงูุงุช

ูุงุญุธ ุงู ูู ูุซุงููุง ุญุชู ุงูุขูุ ุงููุตูููู $ \textbf{X} $ ุชุญุชูู ุนูู ุงุฑุจุน ุฃุนูุฏุฉ: ุฃูููุง ูุญุชูู ุนูู ุงููููู 1 ูู ุฌููุน ุงูุตูููุ ุนุงููุฏ ููุฉ ุงูุณูุงุฑู ุจุงูุญุตุงูุ ูุฒููุงุ ูุณูุฉ ุงูุตูุงุนู. ููููุ ูุณูุญ ููุง ุงููููุฐุฌ ุจุฅุณุชุฎุฏุงู ุงูุซุฑ ูู ูุฐุง ุงูุนุฏุฏ:

$$ \begin{aligned}
f_\boldsymbol\theta (\textbf{x}) &= \boldsymbol\theta \cdot \textbf{x}
\end{aligned} $$

ุนูุฏูุง ูุถูู ุงููุฒูุฏ ูู ุงูุฃุนูุฏุฉ ููุตูููุชูุงุ ูููู ุจุชูุณูุน $ \boldsymbol\theta $ ูุชุญุชูู ุนูู ูุชุบูุฑ ููู ุนุงููุฏ ูู $ \textbf{x} $. ุจุฏูุงู ูู ุงุฎุชูุงุฑ ููุท 3 ุฃุนูุฏุฉ ุฑูููู ูุฅุฌุฑุงุก ุงูุชูุจุคุ ููุงุฐุง ูุง ูุณุชุฎุฏู ุฌููุน ุงูุฃุนูุฏุฉ ุงูุณุจุนูุ

```python
cols = ['bias', 'cylinders', 'displacement', 'horsepower',
        'weight', 'acceleration', 'model year', 'origin']
X = mpg_mat[cols].to_numpy()
mpg_mat[cols]
```

| origin | model year | acceleration | weight | horsepower | displacement | cylinders | bias   |        |
|:------:|:----------:|:------------:|:------:|:----------:|:------------:|:---------:|:------:|:------:|
| 1      | 70         | 12           | 3504   | 130        | 307          | 8         | 1      | 0      |
| 1      | 70         | 11\.5        | 3693   | 165        | 350          | 8         | 1      | 1      |
| 1      | 70         | 11           | 3436   | 150        | 318          | 8         | 1      | 2      |
| \.\.\. | \.\.\.     | \.\.\.       | \.\.\. | \.\.\.     | \.\.\.       | \.\.\.    | \.\.\. | \.\.\. |
| 1      | 82         | 11\.6        | 2295   | 84         | 135          | 4         | 1      | 389    |
| 1      | 82         | 18\.6        | 2625   | 79         | 120          | 4         | 1      | 390    |
| 1      | 82         | 19\.4        | 2720   | 82         | 119          | 4         | 1      | 391    |

```ruby
392 rows ร 8 columns
```

```python
thetas_all = minimize(mse_loss, grad_mse_loss, X, y, progress=10)
print(f'theta: {thetas_all} | loss: {mse_loss(thetas_all, X, y):.2f}')
```

```ruby
theta: [0. 0. 0. 0. 0. 0. 0. 0.] | loss: 610.47
theta: [-0.5  -0.81  0.02 -0.04 -0.01 -0.07  0.59  1.3 ] | loss: 11.22
theta: [-17.23  -0.49   0.02  -0.02  -0.01   0.08   0.75   1.43] | loss: 10.85
theta: [-17.22  -0.49   0.02  -0.02  -0.01   0.08   0.75   1.43] | loss: 10.85
```

ูููุงู ููุชูุฌุฉ ุงููุฒูู ุงูุฅุดุชูุงููุ ูุฃู ุงููููุฐุฌ ุงูุฎุทู ูููููุง ุชุนุฑููู ูุงูุชุงูู:

$$ y = -17.22 - 0.49x_1 + 0.02x_2 - 0.02x_3 - 0.01x_4 + 0.08x_5 + 0.75x_6 + 1.43x_7 $$

ููุงุญุธ ุงู ุฎุณุงุฑุชูุง ููุช ูู 11.6 ุจุฅุณุชุฎุฏุงู ุซูุงุซ ุฃุนูุฏุฉ ุฅูู 10.85 ุจุฅุณุชุฎุฏุงู ุฌููุน ุงูุฃุนูุฏุฉ ุงูุฑูููุฉ ุงูุณุจุนู ูู ุจูุงูุงุชูุง. ุณูุฑู ูุณุจุฉ ุงูุฎุทุฃ ูู ุงูุฑุณู ุงูุจูุงูู ููู ุงูุชููุนูู ุงูุณุงุจู (ุจุฅุณุชุฎุฏุงู ุซูุงุซ ุฃุนูุฏุฉ) ูุงูุฌุฏูุฏ (ุจุฅุณุชุฎุฏุงู ุณุจุน ุฃุนูุฏุฉ):

```python
resid_prop_all = (y - linear_model(thetas_all, X)) / with_predictions['mpg']
plt.figure(figsize=(10, 4))
plt.subplot(121)
plt.scatter(np.arange(len(resid_prop)), resid_prop, s=15)
plt.title('Residual proportions using 3 columns')
plt.xlabel('Index of row in data')
plt.ylabel('Error proportion')
plt.ylim(-0.7, 0.7)

plt.subplot(122)
plt.scatter(np.arange(len(resid_prop_all)), resid_prop_all, s=15)
plt.title('Residual proportions using 7 columns')
plt.xlabel('Index of row in data')
plt.ylabel('Error proportion')
plt.ylim(-0.7, 0.7)

plt.tight_layout();
```

<p align="center"> 
<img src='{{ site.baseurl }}/img/chapter13/linear_multiple_42_0.png'>
</p>

ุนูู ุงูุฑุบู ุงู ุงููุฑู ุจุณูุทุ ููุงุญุธ ุงู ุงููุฑู ุงูู ุนูุฏูุง ูุณุชุฎุฏู ุงูุณุจุน ุฃุนูุฏุฉ. ููุง ุงููููุฐุฌูู ุงูุถู ูู ุงููููุฐุฌ ุงูุซุงุจุชุ ููุง ููุถุญ ุงูุฑุณู ุงูุจูุงูู ุงูุชุงูู:

```python
constant_resid_prop = (y - with_predictions['mpg'].mean()) / with_predictions['mpg']
plt.scatter(np.arange(len(constant_resid_prop)), constant_resid_prop, s=15)
plt.title('Residual proportions using constant model')
plt.xlabel('Index of row in data')
plt.ylabel('Error proportion')
plt.ylim(-1, 1);
```

<p align="center"> 
<img src='{{ site.baseurl }}/img/chapter13/linear_multiple_44_0.png'>
</p>

ุงุณุชุฎุฏุงู ุงููููุฐุฌ ุงูุซุงุจุช ูุตูุช ููู ูุชุงุฆุฌ ุงูุฎุทุฃ ุฅูู ุฃูุซุฑ ูู 75% ููุซูุฑ ูู ุงูุณูุงุฑุงุช!

### ููุฎุต ุงูุฅูุญุฏุงุฑ ุงูุฎุทู ุงููุชุนุฏุฏ

ุชุนุฑููุง ุนูู ุงููููุฐุฌ ุงูุฎุทู ููุฅูุญุฏุงุฑ. ุนูู ุนูุณ ุงููููุฐุฌ ุงูุซุงุจุชุ ุงูุฅูุญุฏุงุฑ ุงูุฎุทู ูุฃุฎุฐ ุฎุตุงุฆุต ูู ุงูุจูุงูุงุช ุจุงูุญุณุจุงู ุนูุฏ ุงุฌุฑุงุก ุงูุชููุนุงุชุ ููุง ูุฌุนูู ุงูุซุฑ ูุงุฆุฏุฉ ุนูุฏูุง ูููู ูุฏููุง ุนูุงูุงุช ูู ุจูุงูุงุชูุง.

ุฎุทูุงุช ุถุจุท ุงููููุฐุฌ ูู ุงูููุชุฑุถ ุงู ุชููู ูุงุถุญู ุงูุขู:
- ุงุฎุชูุงุฑ ุงููููุฐุฌ.
- ุงุฎุชูุงุฑ ุฏุงูุฉ ุงูุฎุณุงุฑุฉ.
- ุชูููู ุฏุงูุฉ ุงูุฎุณุงุฑู ุจุฅุณุชุฎุฏุงู ุงููุฒูู ุงูุฅุดุชูุงูู.

ูู ุงููููุฏ ูุนุฑูุฉ ุงู ุจุฅููุงููุง ุงูุชุนุฏูู ุนูู ุงุญุฏ ุงูููููุงุช ุฏูู ุงูุฃุฎุฑู. ูู ูุฐุง ุงูุฌุฒุกุ ุชุนุฑููุง ุนูู ุงููููุฐุฌ ุงูุฎุทู ุฏูู ุงูุชุบูุฑ ูู ุฏุงูุฉ ุงูุฎุณุงุฑู ุฃู ุงุณุชุฎุฏุงู ุฎูุงุฑุฒููุงุช ุชูููู ุงุฎุฑู. ุนูู ุงูุฑุบู ุงู ุงูููุฐุฌู ูุฏ ุชููู ูุนูุฏูุ ูููู ุงุณูู ุงูุชุฑููุฒ ุนูู ูููู ูุงุญุฏ ููุท ูู ูู ูุฑูุ ุซู ุฌูุน ุงูููููุงุช ูุน ุจุนุถูุง ุงูุจุนุถ.

## ุงููุฑุจุนุงุช ุงูุตุบุฑู - ููุธูุฑ ููุฏุณู

ููุชุฐูุฑ ุงููุง ุงูุฌุฏูุง ุงููุชุบูุฑุงุช ุงูุฑูุงุถูู ุงููุซุงููู ูููููุฐุฌ ุงูุฎุทู ุจูุงุณุทุฉ ุงูุชุญุณูู ูู ุฏุงูุฉ ุงูุฎุณุงุฑู ุจุฅุณุชุฎุฏุงู ุงููุฒูู ุงูุฅุดุชูุงูู. ุฐูุฑูุง ุฃูุถุงู ุงู ุงูุฅูุญุฏุงุฑ ุงูุฎุทู ูููุฑุจุนุงุช ุงูุตุบุฑู ูููู ุญุณุงุจู ุชุญููููุงู. ุนูู ุงูุฑุบู ุงู ุงููุฒูู ุงูุฅุดุชูุงูู ุงูุซุฑ ุนูููุงูุ ูุฐุง ุงูููุธูุฑ ุงูููุฏุณู ุณูุณุงุนุฏู ุนูู ููู ุงูุฅูุญุฏุงุฑ ุงูุฎุทู ุจุดูู ุงูุจุฑ.

ูุชููุน ูู ุงููุงุฑุฆ ุงู ูููู ุนูู ุนูู ุจูุถุงุก ุงููุชุฌูุงุช  Vector Space ูุทุฑููุฉ ุงูููุงู ุจุงูุนูููุงุช ุงูุญุณุงุจูู ุนูููุง.

ูููุชุฑุถ ุงููุง ูุจุญุซ ุนู ุงููููุฐุฌ ุงูุฎุทู ููุจูุงูุงุช ุงูุชุงููู:

**y**|**x**
:-----:|:-----:
2|3
1|0
-2|-1

```python
data = pd.DataFrame(
    [
        [3,2],
        [0,1],
        [-1,-2]
    ],
    columns=['x', 'y']
)

sns.regplot(x='x', y='y', data=data, ci=None, fit_reg=False);
```

<p align="center"> 
<img src='{{ site.baseurl }}/img/chapter13/linear_projection_5_0.png'>
</p>

ูููุชุฑุถ ุฃู ุงููููุฐุฌ ุงููุซุงูู ูู ุงููููุฐุฌ ุจุฃูู ุฎุณุงุฑูุ ูุงู ุฎุทุฃ ุงููุฑุจุนุงุช ุงูุตุบุฑู ูู ุงุฏุงุฉ ููุจููุฉ ููููุงุณ.

### ุงููุฑุจุนุงุช ุงูุตุบุฑู: ุงููููุฐุฌ ุงูุซุงุจุช

ููุง ูุนููุง ูู ุจูุงูุงุช ุงูุฅูุฑุงููุงุชุ ููุจุฏุฃ ุจุงููููุฐุฌ ุงูุซุงุจุช: ูููุฐุฌ ูุชููุน ุฑูู ูุงุญุฏ ููุท.

$$ \theta = C $$

ูุนูู ูุญู ููุท ูุน ููู $ y $:

|**y**|
|:-----:|
|2|
|1|
|-2|

ููุฏููุง ูู ุฅูุฌุงุฏ ูููุฉ $ \theta $ ุงูุชู ุชูุชุฌ ููุง ุฎุทุงู ูููู ูู ุงูุฎุณุงุฑู ุงูุชุฑุจูุนูู:

$$ \begin{split} L(\theta, \textbf{y}) = \sum_{i = 1}^{n}(y_i - \theta)^2\\ \end{split} $$

ููุชุฐูุฑ ุงู ูููููุฐุฌ ุงูุซุงุจุชุ ูููุฉ $ \theta $ ุงูุชู ุชููู ุงูุฎุณุงุฑู ูู ุฏุงูุฉ ุงูุฎุทุฃ ุงูุชุฑุจูุนู ุงููุชูุณุท MSE ูู $ \bar{\textbf{y}} $ุ ูุชูุณุท ููู $ \textbf{y} $. ูููู ุฅูุฌุงุฏ ุงูุนูููุฉ ุงูุญุณุงุจูุฉ ุงููุงููู ูู ุฏุฑุณ [ุฏูุงู ุงูุฎุณุงุฑู](/chapter10/#%D8%AF%D8%A7%D9%84%D8%A9%20%D8%A7%D9%84%D8%AE%D8%B3%D8%A7%D8%B1%D9%87) ูู ูุตู [ุงูููุงุฐุฌ ูุงูุชููุนุงุช](/ds-100-ar/chapter10/). 

ูุงุญุธ ุงู ุฏุงูุฉ ุงูุฎุณุงุฑู ูุฏููุง ูู ูุฌูุน ุงูุชุฑุจูุน. ุงููุงุนุฏุฉ L2 ูููุชุฌูุงุช ูู ุงูุถุงู ูุฌููุน ุงูุชุฑุจูุนุ ูููู ูุน ุงูุฌุฐุฑ ุงูุชุฑุจูุนู:

$$ \Vert \textbf{v} \Vert = \sqrt{v_1^2 + v_2^2 + \dots + v_n^2} $$

ุฅุฐุง ุฌุนููุง $ y_i - \theta = v_i $:

$$ \begin{split}
\begin{aligned}
L(\theta, \textbf{y}) 
&= v_1^2 + v_2^2 + \dots + v_n^2 \\
&= \Vert \textbf{v} \Vert^2
\end{aligned}
\end{split} $$

ูุนูู ุฐูู ุงู ุจุฅููุงููุง ุชุนุฑูู ุงูุฎุณุงุฑู ุนูู ุงููุง ุชุฑุจูุน ุงููุงุนุฏุฉ L2 ููุชูุฌู $ \textbf{v} $. ูููููุง ูุตู $ v_i $ ูุงูุชุงูู $ y_i - \theta \quad \forall i \in [1,n] $ ุฅุฐุงู ุฐูู ูู ูุชุนุฑูู ุฏููุงุฑุชู:

$$ \begin{split}
\begin{aligned}
\textbf{v} \quad &= \quad \begin{bmatrix} y_1 - \theta \\ y_2 - \theta \\ \vdots \\ y_n - \theta \end{bmatrix} \\
&= \quad \begin{bmatrix} y_1 \\ y_2 \\ \vdots \\ y_n  \end{bmatrix} \quad - \quad 
\begin{bmatrix} \theta \\ \theta \\ \vdots \\ \theta \end{bmatrix} \\
&= \quad \begin{bmatrix} y_1 \\ y_2 \\ \vdots \\ y_n  \end{bmatrix} \quad - \quad 
\theta \begin{bmatrix} 1 \\ 1 \\ \vdots \\ 1 \end{bmatrix}
\end{aligned}
\end{split} $$

ุฅุฐุงูุ ูููููุง ูุชุงุจุฉ ุฏุงูุฉ ุงูุฎุณุงุฑู ูุงูุชุงูู:

$$ \begin{split} 
\begin{aligned}
L(\theta, \textbf{y})
\quad &= \quad \left \Vert  \qquad   
\begin{bmatrix} y_1 \\ y_2 \\ \vdots \\ y_n  \end{bmatrix} \quad - \quad 
\theta \begin{bmatrix} 1 \\ 1 \\ \vdots \\ 1 \end{bmatrix}
\qquad \right \Vert ^2 \\
\quad &= \quad \left \Vert  \qquad  
\textbf{y} 
\quad - \quad 
\hat{\textbf{y}}
\qquad \right \Vert ^2 \\
\end{aligned}
\end{split} $$

ุงููุตู $$ \theta \begin{bmatrix} 1 \\ 1 \\ \vdots \\ 1 \end{bmatrix} $$ ูู ูุถุงุนู ุนุฏุฏู ููุฃุนูุฏุฉ ูู ุงููุชูุฌู $ \textbf{1} $ุ ููู ุงูุถุงู ูุชูุฌุฉ ุงูุชููุนุ ููุฑูุฒ ููุง $ \hat{\textbf{y}} $.

ูุนุทููุง ุฐูู ููุธูุฑุงู ุฌุฏูุฏุงู ุนู ูุนูู ุชูููู ุงูุฎุณุงุฑู ูู ุฎุทุฃ ุงููุฑุจุนุงุช ุงูุตุบุฑู.

ููู $ \textbf{y} $ ู $ \textbf{1} $ ุซุงุจุชูุ ูููู $ \theta $ ูููู ุฃู ุชุฃุฎุฐ ุฃู ูููุฉุ ูุฐุง $ \hat{\textbf{y}} $ ูููู ุงูุช ุชููู ุงู ูุถุงุนู ุนุฏุฏู ู $ \textbf{1} $. ูุฑูุฏ ุฅูุฌุงุฏ $ \theta $ ูุชููู $ \theta \textbf{1} $ ุงูุฑุจ ูุง ุชููู ุฅูู $ \textbf{y} $. ูุณุชุฎุฏู $ \hat{\theta} $ ููุตู ุฐูู ุงูุถุจุท ุงููุซุงูู ู $ \theta $.

### ุงููุฑุจุนุงุช ุงูุตุบุฑู: ูููุฐุฌ ุฎุทู ุจุณูุท

ุงูุขูุ ููููู ูุธุฑู ุนูู ูููุฐุฌ ุงูุฅูุญุฏุงุฑ ุงูุฎุทู ุงูุจุณูุท. ูุดุจู ุงููููุฐุฌ ุจุดูู ูุจูุฑ ูุฅุดุชูุงู ุงููููุฐุฌ ุงูุซุงุจุชุ ูููู ูุงุญุธ ุงููุฑู ูููุฑ ุจุทุฑููุฉ ุนุงูุฉ ูุฅุฌุฑุงุก ุงูุฅูุญุฏุงุฑ ุงูุฎุทู ุงููุชุนุฏุฏ.

ุงููููุฐุฌ ุงูุฎุทู ุงูุจุณูุท ูู:

$$ \begin{split}
\begin{aligned}
f_\boldsymbol\theta (x_i) 
&= \theta_0 + \theta_1 x_i \\
\end{aligned}
\end{split} $$

ูุฏููุง ุฅูุฌุงุฏ $ \boldsymbol\theta $ ุงูุชู ุชูุชุฌ ููุง ุฎุทุงู ุจุฃูู ุฎุทุฃ ุชุฑุจูุนู:

$$ \begin{split}
\begin{aligned}
L(\boldsymbol\theta, \textbf{x}, \textbf{y})
&= \sum_{i = 1}^{n}(y_i - f_\boldsymbol\theta (x_i))^2\\
&= \sum_{i = 1}^{n}(y_i - \theta_0 - \theta_1 x_i)^2\\
&= \sum_{i = 1}^{n}(y_i - \begin{bmatrix} 1 & x_i \end{bmatrix}
\begin{bmatrix} 
     \theta_0 \\
     \theta_1
\end{bmatrix} ) ^2
\end{aligned}
\end{split} $$

ููุณุงุนุฏุชูุง ุนูู ุชุญููู ุดูู ุฌูุน ุงูุฎุณุงุฑู ุฅูู ุดูู ูุตููููุ ุฏุนูุง ููุณุน ูู ุงูุฎุณุงุฑู ุจ $ n = 3 $:

$$ \begin{split}
\begin{aligned}
L(\boldsymbol{\theta}, \textbf{x}, \textbf{y})
&=
(y_1 - \begin{bmatrix} 1 & x_1 \end{bmatrix}
\begin{bmatrix} 
     \theta_0 \\
     \theta_1
\end{bmatrix})^2  \\
&+
(y_2 - \begin{bmatrix} 1 & x_2 \end{bmatrix}
\begin{bmatrix} 
     \theta_0 \\
     \theta_1
\end{bmatrix})^2 \\
&+
(y_3 - \begin{bmatrix} 1 & x_3 \end{bmatrix}
\begin{bmatrix} 
     \theta_0 \\
     \theta_1
\end{bmatrix})^2 \\
\end{aligned}
\end{split} $$

ูุฑุฉ ุฃุฎุฑูุ ุฏุงูุฉ ุงูุฎุณุงุฑู ูู ูุฌููุน ุงูุชุฑุจูุน ู ุงููุงุนุฏุฉ L2 ูููุชูุฌู ูู ุงูุฌุฐุฑ ุงูุชุฑุจูุนู ููุฌููุน ุงูุชุฑุจูุน:

$$ \Vert \textbf{v} \Vert = \sqrt{v_1^2 + v_2^2 + \dots + v_n^2} $$

ุฅุฐุง ุฌุนููุง $$ y_i - \begin{bmatrix} 1 & x_i \end{bmatrix}
\begin{bmatrix} 
     \theta_0 \\
     \theta_1
\end{bmatrix} $$ $ v_i = $: 

$$ \begin{split}
\begin{aligned}
L(\boldsymbol{\theta}, \textbf{x}, \textbf{y}) 
&= v_1^2 + v_2^2 + \dots + v_n^2 \\
&= \Vert \textbf{v} \Vert^2
\end{aligned}
\end{split} $$

ููุง ูู ุงูุณุงุจูุ ูููููุง ูุตู ุฎุณุงุฑุชูุง ุนูู ุงููุง ุชุฑุจูุน ุงููุงุนุฏุฉ L2 ูููุชูุฌู $ \textbf{v} $. 

$$ v_i = y_i - \begin{bmatrix} 1 & x_i \end{bmatrix}
\begin{bmatrix} 
     \theta_0 \\
     \theta_1
\end{bmatrix} \quad \forall i \in [1,3] $$

$$ 
\begin{aligned}
L(\boldsymbol{\theta}, \textbf{x}, \textbf{y})
&= \left \Vert  \qquad   
\begin{bmatrix} y_1 \\ y_2 \\ y_3  \end{bmatrix} \quad - \quad 
\begin{bmatrix} 1 & x_1 \\ 1 & x_2 \\ 1 & x_3 \end{bmatrix}
\begin{bmatrix} 
     \theta_0 \\
     \theta_1
\end{bmatrix}
\qquad \right \Vert ^2 \\
&= \left \Vert  \qquad  
\textbf{y} 
\quad - \quad 
\textbf{X}
\begin{bmatrix} 
     \theta_0 \\
     \theta_1
\end{bmatrix}
\qquad \right \Vert ^2 \\
&= \left \Vert  \qquad  
\textbf{y} 
\quad - \quad 
f_\boldsymbol\theta(\textbf{x})
\qquad \right \Vert ^2 \\
&= \left \Vert  \qquad  
\textbf{y} 
\quad - \quad 
\hat{\textbf{y}}
\qquad \right \Vert ^2 \\
\end{aligned}
$$

ุนูููุฉ ุถุฑุจ ุงููุตูููุฉ $$ \begin{bmatrix} 1 & x_1 \\ 1 & x_2 \\ 1 & x_3 \end{bmatrix}
\begin{bmatrix} 
     \theta_0 \\
     \theta_1
\end{bmatrix} $$ ูู ุชุฑููุจุฉ ุฎุทูุฉ ููุฃุนูุฏุฉ ูู $ \textbf{X} $: ูู $ \theta_i $ ูุชู ุถุฑุจูุง ุจุนุงููุฏ ูุงุญุฏ ูู $ \textbf{X} $ุ ูุธูุฑ ููุง ูุฐุง ุงูููุธูุฑ ุงู $ f_\boldsymbol\theta $ ุชุฑููุจุฉ ุฎุทูุฉ ููุฎุตุงุฆุต ูู ุจูุงูุงุชูุง.

$ \textbf{X} $ ู $ \textbf{y} $ ุซุงุจุชููุ ูููู $ \theta_0 $ ู $ \theta_1 $ ูููู ุฃู ูุฃุฎุฐุงู ุฃู ููููุ ูุฐุง $ \hat{\textbf{y}} $ ูููู ุงู ุชุฃุฎุฐ ุงูุงู ูู ุงูุชุฑููุจุงุช ุงูุฎุทูุฉ ูู ุงูุฃุนูุฏุฉ ูู $ \textbf{X} $. ููุญุตูู ุนูู ุฃูู ุฎุณุงุฑูุ ุชุฑูุฏ ุฃู ูุฎุชุงุฑ $ \boldsymbol\theta $ ุงูุชู ูููุง $ \hat{\textbf{y}} $ ุฃูุฑุจ ูุง ุชููู ุฅูู $ \textbf{y} $ุ ูุฑูุฒ ููุง ุจุงูุฑูุฒ $ \hat{\boldsymbol\theta} $.

### ุงูููุฑู ุงูููุฏุณูู

ุงูุขูุ ููุญุงูู ุชูููู ููุฑุฉ ุนู ุงูููุฉ ุงู ุชููู $ \hat{\textbf{y}} $ ูุญุฏูุฏู ููุชุฑููุจุงุช ุงูุฎุทูุฉ ููุฃุนูุฏุฉ ูู $ \textbf{X} $. ุนูู ุงูุฑุบู ุงู ูุฏู ุงู ูุชูุฌู ูุญุชูู ุนูู ุนุฏุฏ ุบูุฑ ูุญุฏูุฏ ูู ุงูุชุฑููุจุงุช ุงูุฎุทูุฉุ ุบูุฑ ูุญุฏูุฏ ูุง ุชุนูู ุงูุงู ูุงูุ ุงูุชุฑููุจุงุช ุงูุฎุทูุฉ ูุญุฏูุฏู ุจูุงุณุทุฉ ุฃุณุงุณ ุงููุชูุฌู.

ููุชุฐููุฑุ ูุฐู ุฏุงูุฉ ุงูุฎุณุงุฑู ููุฎุทุท ุงูุชุดุชุช:

$$ L(\boldsymbol{\theta}, \textbf{x}, \textbf{y}) \quad = \quad \left \Vert  \quad  
\textbf{y} 
\quad - \quad 
\textbf{X} \boldsymbol\theta
\quad \right \Vert ^2 $$

```python
sns.regplot(x='x', y='y', data=data, ci=None, fit_reg=False);
```

<p align="center"> 
<img src='{{ site.baseurl }}/img/chapter13/linear_projection_19_0.png'>
</p>

ูู ุฎูุงู ูุดุงูุฏุชูุง ููุฎุทุท ุงูุชุดุชุชุ ููุงุญุธ ุงูู ูุง ููุฌุฏ ุฎุท ูุซุงูู ููููุงุทุ ูุฐุง ูู ูุณุชุทูุน ุงููุตูู ุฅูู ุฎุณุงุฑู ุชุณุงูู ุตูุฑ. ูุนุฑู ุงู $ \textbf{y} $ ููุณุช ุนูู ูุณุชูู ุฎุทู ูุน $ \textbf{x} $ ู $ \textbf{1}:

<p align="center"> 
<img src='{{ site.baseurl }}/img/chapter13/proj1.png'>
</p>

ุจูุง ุงู ุญุณุงุจ ุงูุฎุณุงุฑู ูููู ุจุงููุณุงููุ ูููููุง ููุงุญุธุฉ ุงูู ูุชูููู ุงูุฎุณุงุฑู $ L(\boldsymbol\theta, \textbf{x}, \textbf{y}) = \left \Vert  \textbf{y} - \textbf{X} \boldsymbol\theta \right \Vert ^2 $ุ ููุฑูุฏ ุงู ุชููู $ \textbf{X} \boldsymbol\theta $ ุงูุฑุจ ูุง ุชููู ุฅูู $ \textbf{y} $.

ุฑูุงุถูุงูุ ูุญูู ูุฑู ุชููุน $ \textbf{y} $ ูู ูุถุงุก ุงููุชูุฌู ุงูููุชุฏ ุจูุงุณุทุฉ ุงูุฃุนูุฏุฉ ูู $ \textbf{X} $ุ ูุฃู ุงูุชููุน ูุฃู ูุชูุฌู ูู ุงูุฑุจ ููุทุฉ ูู $ Span(\textbf{X})$ ูููุชูุฌู. ูุฐุงุ ุฅุฎุชูุงุฑ $ \boldsymbol\theta $ ูููู ูููุง $ \hat{\textbf{y}} $ $ \textbf{X}  \boldsymbol\theta = $ $ \mathit{proj}_{Span(\textbf{X})}  \textbf{y} = $ ูู ุงูุญู ุงููุซุงูู.

> proj = projection = ุงูุชููุน

<p align="center"> 
<img src='{{ site.baseurl }}/img/chapter13/proj2.png'>
</p>

ููุนุฑู ููุงุฐุงุ ููุฃุฎุฐ ุจุงูุฅุนุชุจุงุฑ ุงูููุงุท ุงูุฃุฎุฑู ูู ูุถุงุก ุงููุชูุฌูุ ุงูููุงุท ุจุงูููู ุงูุจููุณุฌู:

<p align="center"> 
<img src='{{ site.baseurl }}/img/chapter13/proj3.png'>
</p>

ุจูุงุกูุง ุนูู ูุธุฑูุฉ ููุซุงุบูุฑุณุ ุงู ููุทุฉ ุนูู ุงูุณุทุญ ูู ุงุจุนุฏ ุนู $ \textbf{y} $ ูู $ \hat{\textbf{y}} $. ุทูู ุงูุนุงููุฏ ุงูููุงุจู ู $ \hat{\textbf{y}} $ ูู ุฎุทุฃ ุงููุฑุจุนุงุช ุงูุตุบุฑู. 

### ุงูุฌุจุฑ ุงูุฎุทู

ุชุญุฏุซูุง ุจุดูู ูุจูุฑ ุนู ุงูุฌุจุฑ ุงูุฎุทูุ ูุง ุชุจูู ููุง ุงูุขู ูู ุญู $ \hat{\boldsymbol\theta} $ ุงูุชู ุชููู ููุง ูุง ูุจุญุซ ุนูู $ \hat{\textbf{y}} $

ุจุนุถ ุงูููุงุท ูุฃุฎุฐูุง ุจุงูุฅุนุชุจุงุฑ:

<p align="center"> 
<img src='{{ site.baseurl }}/img/chapter13/proj4.png'>
</p>

- $ \hat{\textbf{y}} + \textbf{e} = \textbf{y} $
- $ \textbf{e} $ ูุชูุงุฒูู ุนุงููุฏูุงู ูุน $ \textbf{x} $ ู $ \textbf{1} $
- $ \hat{\textbf{y}} = \textbf{X} \hat{\boldsymbol\theta} $ ูู ุงููุชูุฌู ุงูุฃูุฑุจ ุฅูู $ \textbf{y} $ ูู ูุถุงุก ุงููุชูุฌูุงุช ุงูููุชุฏุฉ ูู $ \textbf{x} $ ู $ \textbf{1} $

ููุฐุงุ ุชูุชุฌ ููุง ุงููุนุงุฏูู ุงูุชุงููู:

$$ \textbf{X}  \hat{\boldsymbol\theta} + \textbf{e} = \textbf{y} $$

ุถุฑุจ ุงูุฌูู ุงููุณุฑู ููู ุงูููู ุจ $ \textbf{X}^T $ ููุชุฌ ููุง ุงูุชุงูู:

$$ \textbf{X}^T \textbf{X}  \hat{\boldsymbol\theta} + \textbf{X}^T \textbf{e} = \textbf{X}^T \textbf{y} $$

ุจูุง ุฃู $ \textbf{e} $ ูุชุนุงูุฏู ูุน ุงูุฃุนูุฏุฉ ูู $ \textbf{X} $ุ ูุฃู $ \textbf{X}^T \textbf{e} $ ูู ุนุงููุฏ ูุชูุฌู ูุญุชูู ุนูู ุงุตูุงุฑ. ูุฐุงุ ูุตู ุฅูู ุงููุนุงุฏูุฉ ุงูุชุงููู:

$$ \textbf{X}^T \textbf{X}  \hat{\boldsymbol\theta} = \textbf{X}^T \textbf{y} $$

ูู ููุงุ ูููููุง ุจุณูููุฉ ุงูุญู ูุฅูุฌุงุฏ $ \hat{\boldsymbol\theta} $ ุจูุงุณุทุฉ ุถุฑุจ ุงูุฌูู ุงููุณุฑู ูู ููุง ุงูุฌุงูุจูู ุจ $ (\textbf{X}^T \textbf{X})^{-1} $:

$$ \hat{\boldsymbol\theta} = (\textbf{X}^T \textbf{X})^{-1} \textbf{X}^T \textbf{y} $$

ููุงุญุธุฉ: ูููููุง ุงูุญุตูู ุนูู ููุณ ุงููุชุฌูุฉ ุจูุงุณุทุฉ ุงูุชูููู ุจุฅุณุชุฎุฏุงู ูุชุฌูุงุช ุงูุชูุงุถู ูุงูุชูุงููุ ูููู ุจุงููุณุจุฉ ูุฎุทุฃ ุงููุฑุจุนุงุช ุงูุตุบุฑูุ ูุชุฌูุงุช ุงูุชูุงุถู ูุงูุชูุงูู ููุณุช ุถุฑูุฑูู. ูุฏูุงู ุงูุฎุณุงุฑู ุงูุฃุฎููุ ุณูุญุชุงุฌ ูุฅุณุชุฎุฏุงู ูุชุฌูุงุช ุงูุชูุงุถู ูุงูุชูุงูู ููุญุตูู ุนูู ุงููุชูุฌุฉ ุงูุชุญููููู.

### ุงููุงุก ุงูุฏุฑุงุณู

ููุนูุฏ ูุชุฌุฑุจุชูุงุ ููุทุจู ูุง ุชุนูููุงูุ ููุดุฑุญ ุฅุฌุงุจุชูุง:

$$ \begin{split}
\textbf{y} = \begin{bmatrix} 2 \\ 1 \\ -2  \end{bmatrix} \qquad \textbf{X} = \begin{bmatrix} 1 & 3 \\ 1 & 0 \\ 1 & -1 \end{bmatrix}
\end{split} $$

$$ \begin{split}
\begin{align}
\hat{\boldsymbol\theta} 
&= 
\left(
\begin{bmatrix} 1 & 1 & 1 \\ 3 & 0 & -1 \end{bmatrix}
\begin{bmatrix} 1 & 3 \\ 1 & 0 \\ 1 & -1 \end{bmatrix}
\right)^{-1}
\begin{bmatrix} 1 & 1 & 1 \\ 3 & 0 & -1 \end{bmatrix}
\begin{bmatrix} 2 \\ 1 \\ -2  \end{bmatrix} \\
&= 
\left(
\begin{bmatrix} 3 & 2\\ 2 & 10 \end{bmatrix}
\right)^{-1}
\begin{bmatrix} 1 \\ 8 \end{bmatrix} \\
&=
\frac{1}{30-4}
\begin{bmatrix} 10 & -2\\ -2 & 3 \end{bmatrix}
\begin{bmatrix} 1 \\ 8 \end{bmatrix} \\
&=
\frac{1}{26}
\begin{bmatrix} -6 \\ 22 \end{bmatrix}\\
&=
\begin{bmatrix} - \frac{3}{13} \\ \frac{11}{13} \end{bmatrix}
\end{align}
\end{split} $$

ูููุง ุชุญููููุงู ุจุฅูุฌุงุฏ ุงููููุฐุฌ ุงููุซุงูู ูุฅูุญุฏุงุฑ ุงููุฑุจุนุงุช ุงูุตุบุฑู ููู $ f_\boldsymbol{\boldsymbol\theta}(x_i) = - \frac{3}{13} + \frac{11}{13} x_i $. ูุนุฑู ุงู ุงุฎุชูุงุฑูุง ู $ \boldsymbol\theta $ ุตุญูุญ ุจุฅุณุชุฎุฏุงู ุงูุฎุงุตูู ุงูุฑูุงุถูุฉ ุงูุชู ุชููู ุชููุน $ \textbf{y} $ ูุฃูุชุฏุงุฏ ุงูุฃุนูุฏุฉ ูู $ \textbf{X} $ ููุชุฌ ููุง ุงูุฑุจ ููุทุฉ ูู ูุถุงุก ุงููุชูุฌู ู $ \textbf{y} $. ุชุญุช ุงููููุฏ ุงูุฎุทูู ุจุฅุณุชุฎุฏุงู ุฎุณุงุฑุฉ ุงููุฑุจุนุงุช ุงูุตุบุฑูุ ุงูุญู ู $ \hat{\boldsymbol\theta} $ ููุชุฌ ููุง ุชููุน ูุถููู ุงูู ุงูุญู ุงูุฃูุถู.

### ุนูุฏูุง ุชุนุชูุฏ ุงููุชุบูุฑุงุช ุฎุทูุงู

ููู ูุชุบูุฑ ุงุถุงููุ ูุถูู ุนุงููุฏ ุฌุฏูุฏ ุฅูู $ \textbf{X} $. ุงูุชุฏุงุฏ ุฃุนูุฏุฉ ู $ \textbf{X} $ ูู ุงูุชุฑููุจ ุงูุฎุทู ูุฃุนูุฏุฉ ุงููุชูุฌูุงุชุ ูุฐุง ุฅุถุงูุฉ ุฃุนูุฏุฉ ุชุบูุฑ ูู ุงูุฅูุชุฏุงุฏ ููุท ุงุฐุง ูุงูุช ูุณุชููุฉ ุฎุทูุงู ุนู ุจููุฉ ุงูุฃุนูุฏุฉ ุงูููุฌูุฏู ูุณุจูุงู.

ุนูุฏูุง ูููู ุงูุนุงููุฏ ุงููุถุงู ุบูุฑ ูุณุชูู ุฎุทูุงูุ ูููู ูุตูุฉ ูุชุฑููุจ ุฎุทู ูู ุงุญุฏ ุงูุฃุนูุฏุฉ ุงูุฃุฎุฑูุ ูุฐุงุ ูู ูููู ููุง ุงู ูุชูุฌู ุฌุฏูุฏู ูู ุงููุถุงุก ุงูุฌุฒุฆู.

ููุชุฐูุฑ ุงู ุงูุชุฏุงุฏ $ \textbf{X} $ ููู ูุฃูู ุงููุถุงุก ุงูุฌุฒุฆู ุงูุฐู ูุฑูุฏ ุงู ูุชููุน $ \textbf{y} $ ููู. ุฅุฐุง ูู ูุชุบูุฑ ูุฐุง ุงููุถุงุกุ ูุฃู ุงูุชููุน ูู ูุชุบูุฑ.

ูุซูุงูุ ุนูุฏูุง ุนุฑููุง $ \textbf{x} $ ุนูู ุงููููุฐุฌ ุงูุซุงุจุช ููุญุตู ุนูู ุงููููุฐุฌ ุงูุฎุทู ุงูุจุณูุทุ ุนุฑููุง ุฏุงูุฉ ูุณุชููู. $$ \textbf{x} = \begin{bmatrix} 3 \\ 0 \\ -1 \end{bmatrix} $$ ูุง ูููู ูุตููุง ูุนุฏุฏูู ูู $$ \begin{bmatrix} 1 \\ 1 \\ 1 \end{bmatrix} $$. ูุฐุงุ ุงูุชูููุง ูู ุฅูุฌุงุฏ ุชููุน ู $ \textbf{y} $ ูู ุงูุฎุท:

<p align="center"> 
<img src='{{ site.baseurl }}/img/chapter13/1dprojection.png'>
</p>

ุฅูู ุงูุฌุงุฏ ุชููุน ู $ \textbf{y} $ ุนูู ุงูุณุทุญ:

<p align="center"> 
<img src='{{ site.baseurl }}/img/chapter13/proj1.png'>
</p>

ุงูุขูุ ููุนุฑู ูุชุบูุฑ ุขุฎุฑุ $ \textbf{z} $ุ ูููู ุจุดูู ูุงุถุญ ูุฐุง ุงูุนุงููุฏ ูุชุญูุฒ:

**y**|**x**|**1**|**z**
:-----:|:-----:|:-----:|:-----:
2|3|1|4
1|0|1|1
-2|-1|1|0

ูุงุญุธ ุงู $ \textbf{z} = \textbf{1} + \textbf{x} $. ุจูุง ุงู $ \textbf{z} $ ูุชุฑูุจุฉ ุฎุทูุงู ูู $ \textbf{1} $ ู $ \textbf{x} $ุ ูุฃููุง ุชูุน ูู $ Span(\textbf{X}) $. ุงูุขูุ $ \textbf{z} $ ูุนุชูุฏู ุฎุทูุงู ุนูู $ \\{\textbf{1} ,\textbf{x}\\} $ ููุง ุชุบููุฑ ูู $ Span(\textbf{X}) $. ูุฐุงุ ุชููุน $ \textbf{y} $ ูู ุงููุถุงุก ุงูุฌุฒุฆู ุงูููุชุฏ ุจูุงุณุทุฉ $ \textbf{1} $ุ $ \textbf{x} $ ู $ \textbf{z} $ ุณูููู ูุทุงุจู ูุชููุน $ \textbf{y} $ ูู ุงููุถุงุก ุงูุฌุฒุฆู ุงูููุชุฏ ุจูุงุณุทุฉ $ \textbf{1} $ ู $ \textbf{x} $.

<p align="center"> 
<img src='{{ site.baseurl }}/img/chapter13/dependent_variablesz.png'>
</p>

ูููููุง ุงูุถุงู ููุงุญุธุฉ ุฐูู ุนูุฏ ุชูููู ุฏุงูุฉ ุงูุฎุณุงุฑู:

$$ \begin{split} 
\begin{aligned}
L(\boldsymbol\theta, \textbf{d}, \textbf{y})
&= \left \Vert  \qquad   
\begin{bmatrix} y_1 \\ y_2 \\ y_3  \end{bmatrix} \quad - \quad 
\begin{bmatrix} 1 & x_1 & z_1 \\ 1 & x_2 & z_2\\ 1 & x_3 & z_3\end{bmatrix}
\begin{bmatrix} 
     \theta_0 \\
     \theta_1 \\
     \theta_2
\end{bmatrix}
\qquad \right \Vert ^2
\end{aligned}
\end{split} $$

ุงูุญู ุงููุชููุน ููุง ุณูููู ูุงูุดูู ุงูุชุงูู $ \theta_0 \textbf{1} + \theta_1 \textbf{x} + \theta_2 \textbf{z} $.

ุจูุง ุงู $ \textbf{z} = \textbf{1} + \textbf{x} $ุ ุงูุถุงู ูุงูุช $ \theta_0 $ุ $ \theta_1 $ ู $ \theta_2 $ุ ุงูููู ุงููุชููู ูููู ุฅุนุงุฏุฉ ูุชุงุจุชูุง ูุงูุชุงูู:

$$ \begin{split}
\begin{aligned}
\theta_0 \textbf{1} + \theta_1 \textbf{x} + \theta_2 (\textbf{1} + \textbf{x})
&= 
(\theta_0 + \theta_2) \textbf{1} + (\theta_1 + \theta_2) \textbf{x} \\
\end{aligned}
\end{split} $$

ุฅุฐุงูุ ุงุถุงูุฉ $ \textbf{z} $ ูู ุชุบูุฑ ุงู ุดูุก. ุงููุฑู ุงููุญูุฏ ูู ุงู ุจุฅููุงููุง ูุตู ูุฐุง ุงูุชููุน ุจุนุฏุฉ ุฃุดูุงู. ููุชุฐูุฑ ุงููุง ุงูุฌุฏูุง ุชููุน $ \textbf{y} $ ุนูู ุงูุชุฏุงุฏ $ \textbf{1} $ ู $ \textbf{x} $ ููุงู:

$$ \begin{split} \begin{bmatrix} \textbf{1} & \textbf{x} \end{bmatrix}  \begin{bmatrix} - \frac{3}{13} \\ \frac{11}{13} \end{bmatrix} = - \frac{3}{13} \textbf{1} + \frac{11}{13} \textbf{x}\end{split} $$

ูููุ ูุน ุงูุชุนุฑู ุนูู $ \textbf{z} $ุ ูููููุง ูุตู ุชููุน ุงููุชูุฌู ุจุฃูุซุฑ ูู ุทุฑููู.

ุจูุง ุงู $ \textbf{1} = \textbf{z} - \textbf{x} $ุ ู $ \hat{\textbf{y}} $ ูููู ูุตููุง ูุงูุชุงูู:

$$ - \frac{3}{13} (\textbf{z} - \textbf{x}) + \frac{11}{13} \textbf{x} = - \frac{3}{13} \textbf{z} + \frac{14}{13} \textbf{x} $$

ุจูุง ุงู $ \textbf{x} = \textbf{z} + \textbf{1} $ุ ู $ \hat{\textbf{y}} $ ูููู ูุตููุง ูุงูุชุงูู:

$$ - \frac{3}{13} \textbf{1} + \frac{11}{13} (\textbf{z} + \textbf{1}) = \frac{8}{13} \textbf{1} + \frac{11}{13} \textbf{z} $$

ูููู ุฌููุน ุงูุฃูุตุงู ุงูุซูุงุซู ุชูุฏู ููุณ ุงูุชููุน.

ูู ุงูุฎุชุงูุ ุงุถุงูุฉ ุนุงููุฏ ุบูุฑ ูุณุชูู ุฎุทูุงู ุฅูู $ \textbf{x} $ ูุง ูุบูุฑ ูู $ Span(\textbf{X}) $ุ ููุฐูู ูู ูุบูุฑ ูู ุงูุชููุน ูุงูุญู ููุดููุฉ ุงููุฑุจุนุงุช ุงูุตุบุฑู.

### ุทุฑููุชูู ููุชูููุฑ

ุงุถููุง ูุฎุทุทุงุช ุงูุชุดุชุช ูุฑุชูู ูู ูุฐุง ุงูุฏุฑุณ. ุงูู ูุฑู ููุชุฐููุฑ ุงูู ููุง ูู ุงูุณุงุจูุ ูุญุงูู ุงูุฌุงุฏ ุงูุฎุท ุงููุซุงูู ููุจูุงูุงุช. ุงููุฑู ุงูุซุงููุฉ ูุงูุช ุชุฃูุฏ ุงูู ูุง ููุฌุฏ ุฎุท ูุซุงูู ูุฌููุน ุงูููุงุท. ุจุตุฑู ุงููุธุฑ ูู ุฐููุ ุญุงูููุง ุนุฏู ุชุฎุฑูุจ ุฑุณู ูุถุงุก ุงููุชูุฌู ุจูุฎุทุทุงุช ุงูุชุดุชุช. ุฐูู ูุฃู ูุฎุทุทุงุช ุงูุชุดุชุช ุชุชูุงูู ูุน ูุธุฑูุฉ ูุณุงุญุฉ ุงูุตู ูู ูุดููุฉ ุงููุฑุจุนุงุช ุงูุตุบุฑู: ุงููุธุฑ ููู ููุงุท ุงูุจูุงูุงุช ููุญุงููุฉ ุงูุชูููู ูู ุงููุณุงูู ุจูู ุชููุนูุง ู ูู ููุทุฉ. ูู ูุฐุง ุงูุฏุฑุณุ ุชุนุฑููุง ุนูู ูุทุฑููุฉ ูุณุงุญุฉ ุงูุนุงููุฏ: ูู ูุชุบูุฑ ูุงู ูุชูุฌูุ ุชููู ููุง ูุถุงุกูุง ูู ุงูุฅุฌุงุจุงุช ุงูููุญุชููุฉ (ุงูุชููุนุงุช).

## ุชุทุจูู ุนููู ููุฅูุญุฏุงุฑ ุงูุฎุทู

ูู ูุฐุง ุงูุฌุฒุกุ ุณูููู ุจุชุทุจูู ุนููู ููููุฐุฌ ุงูุฅูุญุฏุงุฑ ุงูุฎุทู ุนูู ุจูุงูุงุช. ูุฏู ุงูุจูุงูุงุช ุงูุชู ุณูุนูู ุนูููุง ุงูุนุฏูุฏ ูู ุงูุฎุตุงุฆุตุ ูุซู ุงูุทูู ูุงูุญุฌู ูุญููุงู ุงููุญูุงุฑ.

ูููุชูุง ูู ุชููุน ุงููุฒู ุจุฅุณุชุฎุฏุงู ุงูุฅูุญุฏุงุฑ ุงูุฎุทู.

### ูุธุฑู ุนุงูู ุนูู ุงูุจูุงูุงุช

ุณูุจุฏุฃ ุฃููุงู ุจูุฑุงุกุฉ ุงูุจูุงูุงุช ูุฅุฎุฐ ูุธุฑู ุณุฑูุนู ุนูู ูุญุชูุงูุง:

> ูุชุญููู ุงูุจูุงูุงุชุ [ุงุถุบุท ููุง]({{ site.baseurl }}/files/chapter13/donkeys.csv).

```python
import pandas as pd 

donkeys = pd.read_csv("donkeys.csv")
donkeys.head()
```

**WeightAlt**|**Weight**|**Height**|**...**|**Sex**|**Age**|**BCS**| 
:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:
NaN|77|90|...|stallion|2>|3|0
NaN|100|94|...|stallion|2>|2.5|1
NaN|74|95|...|stallion|2>|1.5|2
NaN|116|96|...|female|2>|3|3
NaN|91|91|...|female|2>|2.5|4

```ruby
5 rows ร 8 columns
```

ููุฑุฉ ุฌูุฏุฉ ุฏุงุฆูุงู ูู ุงููุธุฑ *ูุนุฏุฏ* ุงูุจูุงูุงุช ูุฏููุง ุนู ุทุฑูู ุนุฑุถ ููุงุณุงุช ุงูุช DataFrame. ุนูุฏูุง ูููู ุญุฌู ุงูุจูุงูุงุช ูุฏููุง ูุจูุฑุ ุทุจุงุนุฉ ูุงูู ุงูุจูุงูุงุช ูุฏ ูุณุจุจ ูุดุงูู ูููุชุตูุญ ูุชุชุณุจุจ ุจุฅุบูุงูู:

```python
donkeys.shape
```

```ruby
(544, 8)
```

ุงูุจูุงูุงุช ููููู ูุณุจูุงูุ ูุฏููุง ููุท 544 ุณุทุฑ ู 8 ุฃุนูุฏุฉ. ููุฑู ูุง ูู ุงูุฃุนูุฏุฉ ุงููุชููุฑู ูุฏููุง:

```python
donkeys.columns.values
```

```ruby
array(['BCS', 'Age', 'Sex', 'Length', 'Girth', 'Height', 'Weight',
       'WeightAlt'], dtype=object)
```

ููู ุงูุจูุงูุงุช ูุฏููุง ูุณุงุนุฏูุง ุนูู ุชูุฌูู ุนูููุฉ ุชุญููููุง ููุงุ ูุฌุจ ุนูููุง ููู ูุง ูุญุชููู ูู ุนุงููุฏ. ุจุนุถ ูุฐู ุงูุฃุนูุฏุฉ ูุงุถุญู ูู ูุณููุงุชูุงุ ูููู ุจุนุถูุง ูุญุชุงุฌ ุดุฑุญุงู ุงูุซุฑ:
- `BCS` (Body Condition Score): ุญุงูุฉ ุงูุฌุณู (ุชูููู ูุตุญุฉ ุฌุณุฏ ุงูุญููุงู).
- `Grith`: ูููุงุณ ููุชูุณุท ุฌุณู ุงูุญููุงู.
- `WeightAlt`: ูุฒู ุขุฎุฑ (ูู ุจูู ุงูุจูุงูุงุช ูุฏููุง ุชู ูุฒู ุจุนุถูู ูุฑุชูู ูุนุฏุฏูู 31ุ ุชู ูุฒููู ูุฑุชูู ููุชุฃูุฏ ูู ุฏูุฉ ุงููุฒู).

ููุฑุฉ ููุงุณุจุฉ ุงูุขู ูู ุชุญุฏูุฏ ุงู ุงูุฃุนูุฏุฉ ุชุญุชูู ุนูู ุจูุงูุงุช ูููุฉ ูุฃููุง ูุญุชูู ุนูู ุจูุงูุงุช ุฃุณููู.

ุงููููุฉ: `Length`ุ `Girth`ุ `Height`ุ `Weight` ู `WeightAlt`.  
ุงูุฃุณููุฉ: `BCS`ุ `Age` ู `Sex`.

### ุชูุธูู ุงูุจูุงูุงุช

ูู ูุฐุง ุงูุฌุฒุกุ ุณูุชุญูู ูู ุงูุจูุงูุงุช ุงุฐุง ูุงูุช ุชุญุชูู ุนูู ุงู ุดุฐูุฐ ููุชุนุงูู ูุนูุง.

ุนู ุทุฑูู ุงูุชุญูู ูู ุนุงููุฏ `WeightAlt`ุ ูููููุง ุงูุชุฃูุฏ ูู ุฏูุฉ ุงููุฒู ุจุฃุฎุฐ ุงููุฑู ุจูู ุงููุฒููู ูุฑุณููุง ุงููุชุงุฆุฌ:

```python
difference = donkeys['WeightAlt'] - donkeys['Weight']
sns.distplot(difference.dropna());
```

<p align="center"> 
<img src='{{ site.baseurl }}/img/chapter13/linear_case_study_11_0.png'>
</p>

ุงูุฃูุฒุงู ุชุจุฏู ูุนูููุฉ ุจูุงุฑู 1 ุฃู ุฃูู ูููู ูุฑุงู ูููุง ุจูููุง.

ุงูุขูุ ูููููุง ุงููุธุฑ ุฅูู ููู ุบุฑูุจู ูุงูุชู ูุฏ ุชุธุฑ ุงู ูุฏููุง ูุดุงูู ุฃู ุฃุฎุทุงุก. ูููููุง ุงุณุชุฎุฏุงู ุงูุฏุงูุฉ [Quantile](https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.quantile.html) ูููุดู ุนู ุงูููู ุงูุดุงุฐู:

```python
donkeys.quantile([0.005, 0.995])
```

**WeightAlt**|**Weight**|**Height**|**Girth**|**Length**|**BCS**| 
:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:
98.75|71.715|89|90|71.145|1.5|0.005
192.8|214|112|131.285|111|4|0.995

> ุดุฑุญ ูุจุณุท ููุฏุงูู quantile:  
> ุชููู ุงูุฏุงูู ุจุฅุธูุงุฑ ูุชุงุฆุฌ ุจูุงุกูุง ุนูู ุงููุณุจู ุงููุนุทุงู ููุงุ ูู ุงููุซุงู ุงูุณุงุจู ุทูุจูุง ูุชุงุฆุฌ ูู ูู ูู ุงููุณุจู 0.005 ูุฃูู ู ูููู ูู ุงููุณุจู 0.995 ูุฃูู.  
> **ูุซูุงู** ูู ุงูุนุงููุฏ Heightุ ูุธูุฑ ููุง ุฃู 0.5% ุฃู ุฃูู ูุจูุบ ุทูููู 89.0 ุจูููุง 99.5% ุฃู ุฃูู ูุจูุบ ุทูููู 112.0 ูู ุจูุงูุงุชูุง.

ููู ุงูุฃุนูุฏุฉ ุงููููุฉุ ูููู ุฃู ูุจุญุซ ุนู ุงู ุณุทุฑ ุชููู ูุชูุฌุชู ุฎุงุฑุฌ ูุฐู ุงูุฃุนุฏุงุฏุ ูุฃููุง ูุฑูุฏ ุฃู ูุทุจู ุงููููุฐุฌ ุนูู ุงู ุญููุงู ุตุญุชู ููุชุงุฒู ููุงุถุญ.

ุฃููุงูุ ููุฑู ุงูุนุงููุฏ `BCS`:

```python
donkeys[(donkeys['BCS'] < 1.5) | (donkeys['BCS'] > 4)]['BCS']
```

```ruby
291    4.5
445    1.0
Name: BCS, dtype: float64
```

ุงูุถุงู ุนูุฏ ุงููุธุฑ ุนูู ุงููุฎุทุท ุงูุดุฑูุทู ููุนุงููุฏ `BCS`:

```python
plt.hist(donkeys['BCS'], density=True)
plt.xlabel('BCS');
```

<p align="center"> 
<img src='{{ site.baseurl }}/img/chapter13/linear_case_study_17_0.png'>
</p>

ุจุงูุฃุฎุฐ ุจุงูุฃุนุชุจุงุฑ ุงู ุงูุนุงููุฏ `BCS` ูุธูุฑ ููุง ูุฏู ุตุญุฉ ููุถูุฌ ุงูุญููุงูุ ุญุตูู ุงูุญููุงู ุนูู 1 ูุจูู ุงูู ูุฒูู ูุญุตููู ุนูู 4.5 ูุจูู ุงู ูุฒูู ุฒุงุฆุฏ. ุฃูุถุงู ุจุงููุธุฑ ุฅูู ุงููุฎุทุท ุงูุดุฑูุทูุ ูุท ูุธูุฑ ูุฏููุง ุงุซููู ุจููู ุดุงุฐู ูู ุงูุนุงููุฏ `BCS`. ูุฐุง ุณูููู ุจุญุฐู ูุฐู ุงูุจูุงูุงุช.

ุงูุขูุ ููููู ูุธุฑู ุนูู ุงูุฃุนูุฏุฉ `Length`ุ `Girth` ู `Height`:

```python
donkeys[(donkeys['Length'] < 71.145) | (donkeys['Length'] > 111)]['Length']
```

```ruby
8       46
22      68
26      69
216    112
Name: Length, dtype: int64
```

```python
donkeys[(donkeys['Girth'] < 90) | (donkeys['Girth'] > 131.285)]['Girth']
```

```ruby
8       66
239    132
283    134
523    134
Name: Girth, dtype: int64
```

```python
donkeys[(donkeys['Height'] < 89) | (donkeys['Height'] > 112)]['Height']
```

```ruby
8       71
22      86
244    113
523    116
Name: Height, dtype: int64
```

ุจุงููุณุจู ููุฐู ุงูุฃุนูุฏุฉ ุงูุซูุงุซูุ ูุจุฏู ุงู ุงูุณุทุฑ 8 ูุญุชูู ุนูู ููู ุงุฏูู ูู ุจุงูู ุงูุจูุงูุงุช ุจูููุง ุงูุฃุณุทุฑ ุงูุฃุฎุฑู ูุฑูุจู ุฌุฏุงู ูู ุจุงูู ุงูุจูุงูุงุช ููุง ูุญุชุงุฌ ุฃู ูุญุฐููุง.

ุฃุฎูุฑุงูุ ููุฑู ุงูุนุงููุฏ `Weight`:

```python
donkeys[(donkeys['Weight'] < 71.715) | (donkeys['Weight'] > 214)]['Weight']
```

```ruby
8       27
26      65
50      71
291    227
523    230
Name: Weight, dtype: int64
```

ุฃู ุณุทุฑูู ูุขุฎุฑ ุณุทุฑูู ุจุนูุฏุฉ ุฌุฏุงู ุนู ุจููุฉ ุงูุจูุงูุงุช ูุนูู ุงูุฃุฑุฌุญ ุณูููู ุจุญุฐููุง. ูููููุง ุฃู ูุจูู ุงูุณุทุฑ ูู ุงูููุชุตู ูููู ูุฑูุจุงู ุฌุฏูุงู ูู ุจููุฉ ุงูุจูุงูุงุช.

ุจูุง ุงู ุงูุนุงููุฏ `WeightAlt` ูุดุงุจู ููุนุงููุฏ `Weight`ุ ูู ูููู ุจุงูุจุญุซ ุนู ุดูุงุฐ ููู. ููุชุฌููุน ูุง ููููุงูุ ูุฐุง ูุง ุณูููู ุจููุชุฑุชู ูู ุจูุงูุงุชูุง:
- ุงูุฃุจูุงุก ุนูู ุงูุจูุงูุงุช ุจูู 1.5 ู 4 ูู ุงูุนุงููุฏ `BCS`.
- ุงูุฃุจูุงุก ุนูู ุงูุฃุณุทุฑ ุงูุชู ุจูุงูุงุชูุง ุจูู 71 ู 214 ูู ุงูุนุงููุฏ `Weight`.

```python
donkeys_c = donkeys[(donkeys['BCS'] >= 1.5) & (donkeys['BCS'] <= 4) &
                         (donkeys['Weight'] >= 71) & (donkeys['Weight'] <= 214)]
```

### ูุตู ุจูุงูุงุช ุงูุชุฏุฑูุจ ูุงูุฅุฎุชุจุงุฑ

ูุจู ุฃู ูุจุฏุฃ ุจุชุญููู ุงูุจูุงูุงุชุ ูุฑูุฏ ุฃู ููุณู ุงูุจูุงูุงุช ุฅูู ุชูุณูู 80/20ุ ูุณุชุฎุฏู ูููุง 80% ูู ุงูุจูุงูุงุช ูุชุฏุฑูุจ ุงููููุฐุฌุ ููุชุฑู 20% ูุชูููู ูุฅุฎุชุจุงุฑ ุงููููุฐุฌ:

```python
from sklearn.model_selection import train_test_split

X_train, X_test, y_train, y_test = train_test_split(donkeys_c.drop(['Weight'], axis=1),
                                                    donkeys_c['Weight'],
                                                    test_size=0.2,
                                                   random_state=42)
X_train.shape, X_test.shape
```

```ruby
((431, 7), (108, 7))
```

> ุฃุณุชุฎุฏู ุงููุงุชุจ ุฏุงูุฉ train_test_split ูุงูุชู ุชุฃุชู ูู ููุชุจุฉ sklearn ููู ููุชุจุฉ ูุชุฎุตุตู ุจุฃุฏูุงุช ุชุญููู ุงูุจูุงูุงุช ูุชุนูู ุงูุขูู.  

ูููู ุฃูุถุงู ุจุฅูุดุงุก ุฏุงูุฉ ุชูููู ุงูุชููุน ุนูู ุจูุงูุงุช ุงูุฅุฎุชุจุงุฑุ ููุณุชุฎุฏู ุงูุฎุทุฃ ุงูุชุฑุจูุนู ุงููุชูุณุท:

```python
def mse_test_set(predictions):
    return float(np.sum((predictions - y_test) ** 2))
```

### ุงุณุชูุดุงู ุงูุจูุงูุงุช ูุชุตููุฑูุง

ูุงููุนุชุงุฏุ ุณูุชุญูู ูู ุงูุจูุงูุงุช ูุจู ูุญุงููุฉ ุถุจุท ุงููููุฐุฌ ุนูููุง.

ุฃููุงูุ ููุทูุน ุนูู ุงูุจูุงูุงุช ุงูุฅุณููู ุจุฅุณุชุฎุฏุงู ูุฎุทุท ุงูุตูุฏูู:

```python
sns.boxplot(x=X_train['BCS'], y=y_train);
```

<p align="center"> 
<img src='{{ site.baseurl }}/img/chapter13/linear_case_study_33_0.png'>
</p>

ูุจุฏู ุฃู ูุชูุณุท ุงููุฒู ูุฒุฏุงุฏ ูุน `BCS`ุ ูููุณ ุฎุทูุงู:

```python
sns.boxplot(x=X_train['Sex'], y=y_train,
            order = ['female', 'stallion', 'gelding']);
```

<p align="center"> 
<img src='{{ site.baseurl }}/img/chapter13/linear_case_study_35_0.png'>
</p>

ูุธูุฑ ุฃู ุงูุฌูุณ ูุง ูุชุฃุซุฑ ูุซูุฑุงู ุจุงููุฒู

```python
sns.boxplot(x=X_train['Age'], y=y_train, 
            order = ['<2', '2-5', '5-10', '10-15', '15-20', '>20']);
```

<p align="center"> 
<img src='{{ site.baseurl }}/img/chapter13/linear_case_study_37_0.png'>
</p>

ุจุนูุฑ 5 ุฃู ุฃูุซุฑุ ุชูุฒูุน ุงูุฃูุฒุงู ูุง ูุธูุฑ ุฃู ุชุบูุฑ ูุจูุฑ.

ุงูุขูุ ููููู ูุธุฑู ุนูู ุงูุจูุงูุงุช ุงููููุฉ. ูููููุง ุฑุณู ูู ูุงุญุฏู ูููุง ูุน ุงููุชุบูุฑ ุงูุฐู ูุฑูุฏ ุงูุชูุจุค ุนูู:

```python
X_train['Weight'] = y_train
sns.regplot('Length', 'Weight', X_train, fit_reg=False);
```

<p align="center"> 
<img src='{{ site.baseurl }}/img/chapter13/linear_case_study_39_0.png'>
</p>

```python
sns.regplot('Girth', 'Weight', X_train, fit_reg=False);
```

<p align="center"> 
<img src='{{ site.baseurl }}/img/chapter13/linear_case_study_40_0.png'>
</p>

```python
sns.regplot('Height', 'Weight', X_train, fit_reg=False);
```

<p align="center"> 
<img src='{{ site.baseurl }}/img/chapter13/linear_case_study_41_0.png'>
</p>

ุฌููุน ุงูุจูุงูุงุช ุงููููุฉ ูุฏููุง ุนูุงูุฉ ุฎุทูุฉ ูุน ุงููุชุบูุฑ ุงูุฐู ูุฑูุฏ ุชููุนู `Weight`ุ ูุฐุง ูุง ูุญุชุงุฌ ููููุงู ุจุฃู ุชุนุฏููุงุช ุนูู ุงูุจูุงูุงุช ุงูุชู ุณูุฏุฑุจ ุงููููุฐุฌ ุนูููุง.

ุฃูุถุงู ุชุจุฏู ููุฑุฉ ุฌูุฏู ุฅุฐุง ุฑุฃููุง ุจูู ูู ูุชุบูุฑ ูุขุฎุฑ ุฅุฐุง ูุงูุช ุงูุนูุงูู ุจูููู ุฎุทูุฉ. ุณูููู ุจุฑุณู ุฃุซููู:

```python
sns.regplot('Height', 'Length', X_train, fit_reg=False);
```

<p align="center"> 
<img src='{{ site.baseurl }}/img/chapter13/linear_case_study_43_0.png'>
</p>

```python
sns.regplot('Height', 'Girth', X_train, fit_reg=False);
```

<p align="center"> 
<img src='{{ site.baseurl }}/img/chapter13/linear_case_study_44_0.png'>
</p>

ูู ูุฐู ุงูุฑุณููุ ููุงุญุธ ุฃูุถุงู ุงู ุงููุชุบูุฑุงุช ุงูุชู ุชุณุงุนุฏูุง ุนูู ุงูุชูุจุค ูุฏููุง ุนูุงูุฉ ุฎุทูุฉ ูููู ูููุง ุจูููุง. ูุตุนุจ ุฐูู ูู ุนูููุฉ ุชูุณูุฑ ูุชุงุฆุฌ ุงููููุฐุฌุ ูุฐุง ููุชุฐูุฑ ูุฐูู ุจุนุฏ ุฅูุดุงุก ุงููููุฐุฌ.

### ููุงุฐุฌ ุฎุทูุฉ ุฃุจุณุท

ุจุฏูุงู ูู ุฅุณุชุฎุฏุงู ูู ุงูุจูุงูุงุช ูุฑู ูุงุญุฏุฉุ ููุฌุฑุจ ุถุจุท ุงููููุฐุฌ ุนูู ูุชุบูุฑ ุฃู ุฃุซููู ุฃููุงู.

ูู ุงูุฃุณูู ุซูุงุซ ููุงุฐุฌ ุฅูุญุฏุงุฑ ุฎุทู ููุท ุจุฅุณุชุฎุฏุงู ูุชุบูุฑ ููู ูุงุญุฏ. ุฃู ูุฐู ุงูููุงุฐุฌ ูุจุฏู ุงูุฃูุถูุ

```python
sns.regplot('Length', 'Weight', X_train, fit_reg=True);
```

<p align="center"> 
<img src='{{ site.baseurl }}/img/chapter13/linear_case_study_46_0.png'>
</p>

```python
from sklearn.linear_model import LinearRegression

model = LinearRegression()
model.fit(X_train[['Length']], X_train['Weight'])
predictions = model.predict(X_test[['Length']])
print("MSE:", mse_test_set(predictions))
```

```ruby
MSE: 26052.58007702549
```

```python
sns.regplot('Girth', 'Weight', X_train, fit_reg=True);
```

<p align="center"> 
<img src='{{ site.baseurl }}/img/chapter13/linear_case_study_48_0.png'>
</p>

```python
model = LinearRegression()
model.fit(X_train[['Girth']], X_train['Weight'])
predictions = model.predict(X_test[['Girth']])
print("MSE:", mse_test_set(predictions))
```

```ruby
MSE: 13248.814105932383
```

```python
sns.regplot('Height', 'Weight', X_train, fit_reg=True);
```

<p align="center"> 
<img src='{{ site.baseurl }}/img/chapter13/linear_case_study_50_0.png'>
</p>

```python
model = LinearRegression()
model.fit(X_train[['Height']], X_train['Weight'])
predictions = model.predict(X_test[['Height']])
print("MSE:", mse_test_set(predictions))
```

```ruby
MSE: 36343.308584306134
```

ุจุงููุธุฑ ุฅูู ููุทุท ุงูุชุดุชุช ููุชูุฌุฉ MSEุ ูุจุฏู ููุง ุงู `Girth` ูู ุงูุฃูุถู ูุชููุน ุงููุฒู ูุญุฏูุง ููู ูุฏููุง ุนูุงูุฉ ุฎุทูุฉ ูููุฉ ูุน `Weight` ููุฏููุง ุฃูู ูููุฉ ููุฎุทุฃ ุงูุชุฑุจูุนู ุงููุชูุณุท.

ูู ุณูุญุตู ุนูู ุฃุฏุงุก ุฃูุถู ุนูุฏ ุฅุณุชุฎุฏุงู ููุชุบูุฑููุ ููุฌุฑุจ ุถุจุท ุงููููุฐุฌ ุจุฅุณุชุฎุฏุงู `Girth` ู `Length`. ุนูู ุงูุฑุบู ุงูู ูู ุงูุตุนุจ ุฑุณู ูุฐุง ุงููููุฐุฌุ ูููููุง ุฑุคูุฉ ูุชูุฌุฉ ุงูุฎุทุฃ ุงูุชุฑุจูุนู ุงููุชูุณุท:

```python
model = LinearRegression()
model.fit(X_train[['Girth', 'Length']], X_train['Weight'])
predictions = model.predict(X_test[['Girth', 'Length']])
print("MSE:", mse_test_set(predictions))
```

```ruby
MSE: 9680.902423377258
```

ุฑุงุฆุน! ูุจุฏู ุฃู MSE ุชู ุชูููููุง ูุฏููุง ูู ุญูุงูู 13000 ุจุฅุณุชุฎุฏุงู `Girth` ูุญุฏูุง ุฅูู 10000 ุจุฅุณุชุฎุฏุงู `Girth` ู `Length`. ุฃุถุงูุฉ ูุชุบูุฑ ุฃุฎุฑ ุญุณู ูู ูููุฐุฌูุง.

ูููููุง ุฃูุถุงู ุฅุณุชุฎุฏุงู ุงููุชุบูุฑุงุช ุงูุฃุณููู ูู ูููุฐุฌูุง. ููุฑู ุงูุขู ููู ูุณุชุฎุฏู ุงููููุฐุฌ ุงูุฎุทู ูุน ุงูุจูุงูุงุช ุงูุฃุณููู ูู ุงูุนุงููุฏ `Age`. ูุฐุง ุงูุฑุณู ุงูุจูุงูู ู `Age` ู `Weight`:

```python
sns.stripplot(x='Age', y='Weight', data=X_train, order=['<2', '2-5', '5-10', '10-15', '15-20', '>20']);
```

<p align="center"> 
<img src='{{ site.baseurl }}/img/chapter13/linear_case_study_55_0.png'>
</p>

ุจูุง ุฃู ุงูุจูุงูุงุช ูู ุงูุนุงููุฏ `Age` ุฃุณูููุ ููุญุชุงุฌ ูุฅุณุชุฎุฏุงู ุจูุงูุงุช ุฑูููุฉ ูุทุงุจูู ููุง ููุชููู ูู ุชุทุจูู ูููุฐุฌ ุงูุฅูุญุฏุงุฑ ุงูุฎุทู ุนููู:

```python
just_age_and_weight = X_train[['Age', 'Weight']]
with_age_dummies = pd.get_dummies(just_age_and_weight, columns=['Age'])
model = LinearRegression()
model.fit(with_age_dummies.drop('Weight', axis=1), with_age_dummies['Weight'])

just_age_and_weight_test = X_test[['Age']]
with_age_dummies_test = pd.get_dummies(just_age_and_weight_test, columns=['Age'])
predictions = model.predict(with_age_dummies_test)
print("MSE:", mse_test_set(predictions))
```

```ruby
MSE: 41398.515625
```

> ุงุณุชุฎุฏู ุงููุงุชุจ ุงูุฏุงูุฉ `get_dummies` ูุชุญููู ุงููุชุบูุฑุงุช ุงูุฅุณููู ุฅูู ุจูุงูุงุช ููููุฉ ูููุฉ ุชุชููู ูู 0 ู 1ุ ูุทูู ุนูู ูุฐู ุงูุทุฑููู ุจ One-hot encoding ููููู ูุตููุง ูู ุงูุตูุฑู ุงูุชุงููู:
>
> <p align="center"><a href="https://alioh.github.io/DSND-Notes-2/"><img src='{{ site.baseurl }}/img/chapter13/one-hot-encoding.jpeg'></a>
> </p> 
>

ูุชูุฌุฉ 40000 ุฃุณูุก ุจูุซูุฑ ูู ูุง ุญุตููุง ุนููู ุจุฅุณุชุฎุฏุงู ูุชุบูุฑ ููู ูุงุญุฏุ ูููู ูุฐุง ุงููุชุบูุฑ ูุฏ ูุซุจุช ุฃูููุชู ูู ูููุฐุฌูุง ุงูุฎุทู.

ููุญุงูู ุชูุณูุฑ ูุฐุง ุงููููุฐุฌ. ูุงุญุธ ุฃู ุฃู ุญููุงุฑ ุนูุฑู ูููู ุจูู 2 ู 5 ุณููุงุชุ ุณูุญุตู ุนูู ููุณ ุงูุชููุน ูุฃู ูุฏููู ููุณ ุงููุฏุฎูุงุช: 1 ููุนุงููุฏ ุงูู ูุญุฏุฏ ุงูุนูุฑ ุจูู 2-5 ุณููุงุช. ู 0 ูู ุจููุฉ ุงูุฃุนูุฏุฉ. ูุฐุงุ ูููููุง ุชูุณูุฑ ุงููุชุบูุฑุงุช ุงูุฃุณููู ุจุจุณุงุทู ุจุชุบูุฑ ุงูููู ูู ุงููููุฐุฌ ูุฃู ุงููุชุบูุฑุงุช ุงูุฃุณููู ุชูุตููู ุฅูู ูุฌููุนุงุช ูุชุนุทู ุชููุน ูุงุญุฏ ูุฌููุน ูู ูู ูุฐู ุงููุฌููุนู.

ุฎุทูุชูุง ุงููุงุฏูู ูู ุจูุงุก ุงููููุฐุฌ ุงูููุงุฆู ุจุฅุณุชุฎุฏุงู ุงููุชุบูุฑุงุช ุงูุฃุณููู ูุฃูุซุฑ ูู ูุชุบูุฑ ููู.

### ุชุญููู ุงููุชุบูุฑุงุช

ููุชุฐูุฑ ูู ุฑุณูุงุช ุงูุตูุฏูู ุงูุณุงุจูู ุฃู ุงูุนุงููุฏ `Sex` ูู ููู ูููุฏุงูุ ูุฐุง ุณูุชุฎูุต ููู. ุณูููู ุฃูุถุงู ุจุญุฐู ุงูุนุงููุฏ `WeightAlt` ูุฃู ูุฏููุง ููุท 31 ูููุง. ุฃุฎูุฑุงูุ ุฅุณุชุฎุฏุงู `get_dummies`ุ ูุชุญููู ุงูุจูุงูุงุช ุงูุฃุณููู ููู `BCS` ู `Age` ุฅูู ุจูุงูุงุช ููููุฉ ูููุฉ ููุชููู ูู ุฅุฏุฎุงููุง ุฅูู ุงููููุฐุฌ:

```python
# ูุฐุง ุงูุฎูุงุฑ ูุฒูุงุฏุฉ ุนุฏุฏ ุงูุฃุนูุฏุฉ ุงูุชู ุชุธูุฑ ูู ุฌูุจุชุฑ
pd.set_option('max_columns', 15)

X_train.drop(['Sex', 'WeightAlt'], axis=1, inplace=True)
X_train = pd.get_dummies(X_train, columns=['BCS', 'Age'])
X_train.head()
```

**Age\_>20**|**Age\_<2**|**Age\_5-10**|**Age\_2-5**|**Age\_15-20**|**Age\_10-15**|**BCS\_4.0**|**BCS\_3.5**|**BCS\_3.0**|**BCS\_2.5**|**BCS\_2.0**|**BCS\_1.5**|**Height**|**Girth**|**Length**| 
:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:
0|0|0|1|0|0|0|0|1|0|0|0|99|113|98|465
0|0|0|0|0|1|0|0|1|0|0|0|101|119|101|233
0|0|0|0|0|1|0|0|0|1|0|0|103|125|106|450
0|0|0|1|0|0|0|0|0|1|0|0|100|120|93|453
0|0|1|0|0|0|0|0|0|1|0|0|108|120|98|452

ููุชุฐูุฑ ุฃููุง ูุงุญุธูุง ุชูุฒูุน ุงููุฒู ููู ุฃุนูุงุฑูู ุฃูุจุฑ ูู 5 ูุนุฏู ูุฌูุฏ ูุงุฑู ูุจูุฑ. ูุฐุงุ ุณูุฌูุน ุงูุฃุนูุฏุฉ `Age_10-15`ุ `Age_15-20`ุ ู `Age_>20` ุฅูู ุนุงููุฏ ูุงุญุฏ:

```python
age_over_10 = X_train['Age_10-15'] | X_train['Age_15-20'] | X_train['Age_>20']
X_train['Age_>10'] = age_over_10
X_train.drop(['Age_10-15', 'Age_15-20', 'Age_>20'], axis=1, inplace=True)
```

ูุฃููุง ูุง ูุฑูุฏ ุงู ุชููู ูุตูููุชูุง ุชุญุชูู ุนูู ูุชุบูุฑุงุช ูุซูุฑูุ ููููู ุจุญุฐู ูุงุญุฏ ูู ููุง ุงูุฃุนูุฏู ุงูุฃุณููุฉ `BCS` ู `Age`:

```python
X_train.drop(['BCS_3.0', 'Age_5-10'], axis=1, inplace=True)
X_train.head()
```

**Age\_>10**|**Age\_<2**|**Age\_2-5**|**BCS\_4.0**|**BCS\_3.5**|**BCS\_2.5**|**BCS\_2.0**|**BCS\_1.5**|**Height**|**Girth**|**Length**| 
:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:
0|0|1|0|0|0|0|0|99|113|98|465
1|0|0|0|0|0|0|0|101|119|101|233
1|0|0|0|0|1|0|0|103|125|106|450
0|0|1|0|0|1|0|0|100|120|93|453
0|0|0|0|0|1|0|0|108|120|98|452

ูุฌุจ ุนูููุง ุฅุถุงูุฉ ุนุงููุฏ ุฌุฏูุฏ ูุฅุธูุงุฑ ุงูุฅูุญูุงุฒ ูู ุงููููุฐุฌ:

```python
# ุงุถุงูุฉ ุนุงููุฏ bias
X_train = X_train.assign(bias=1)
X_train = X_train.reindex(columns=['bias'] + list(X_train.columns[:-1]))
X_train.head()
```

**Age\_>10**|**Age\_<2**|**Age\_2-5**|**BCS\_4.0**|**BCS\_3.5**|**BCS\_2.5**|**BCS\_2.0**|**BCS\_1.5**|**Height**|**Girth**|**Length**|**bias** 
:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:
0|0|1|0|0|0|0|0|99|113|98|1|465
1|0|0|0|0|0|0|0|101|119|101|1|233
1|0|0|0|0|1|0|0|103|125|106|1|450
0|0|1|0|0|1|0|0|100|120|93|1|453
0|0|0|0|0|1|0|0|108|120|98|1|452

### ูููุฐุฌ ุงูุฅูุญุฏุงุฑ ุงูุฎุทู ุงููุชุนุฏุฏ

ูุญู ุงูุขู ุฌุงูุฒูู ูุถุจุท ุงููููุฐุฌ ุจุฅุณุชุฎุฏุงู ุฌููุน ุงููุชุบูุฑุงุช ุงูุชู ูุฑุฑูุง ุงููุง ุงูุฃูู ูุจุนุฏ ุฃู ุญูููุงูุง ูุดูู ููุงุณุจ ูููููุฐุฌ.

ูููููุง ุชุนุฑูู ูููุฐุฌูุง ูุงูุชุงูู:

$$ f_\theta (\textbf{x}) = \theta_0 + \theta_1 (Length) + \theta_2 (Girth) + \theta_3 (Height) + ... + \theta_{11} (Age\_>10) $$

ูุฐู ูู ุงูุฏูุงู ุงูุชู ุนุฑููุงูุง ูู ุฏุฑุณ ุงูุฅูุญุฏุงุฑ ุงูุฎุทู ุงููุชุนุฏุฏุ ูุงูุชู ุณูุณุชุฎุฏููุง ูุฑู ุฃุฎุฑู:

```python
def linear_model(thetas, x):
    return  X @ thetas

def mse_loss(thetas, x_vals, y_vals):
    return np.mean((y - linear_model(thetas, X)) ** 2)

def grad_mse_loss(thetas, x_vals, y_vals):
    n = len(x_vals)
    return -2 / n * (X.T @ y  - X.T @ X @ thetas)
```

ูููุฏุฑู ุนูู ุฅุณุชุฎุฏุงู ุงูุฏูุงู ุงูุณุงุจููุ ูุฑูุฏ `X` ู `y`. ูููููุง ุฃู ูุญุตู ุนููููุง ูู ุจูุงูุงุชูุง. ุชุฐูุฑ ุงู `X` ู `y` ูุฌุจ ุงู ุชููู ูุตูููุงุช ูู NumPy ูุชุชููู ูู ุงูููุงู ุจุนูููุฉ ุงูุถุฑุจ ุจุฅุณุชุฎุฏุงู ุงูุฑูุฒ `@`:

```python
X_train = X_train.values
y_train = y_train.values
```

ุงูุขูุ ููุท ูุญุชุงุฌ ูุฅุณุชุฎุฏุงู ุงูุฏุงูุฉ `minimize` ุงูุชู ุนุฑููุงูุง ูู ุงูุฌุฒุก ุงูุณุงุจู:

```python
thetas = minimize(mse_cost, grad_mse_cost, X_train, y_train)
```

```ruby
theta: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.] | cost: 23979.72
theta: [0.01 0.53 0.65 0.56 0.   0.   0.   0.   0.   0.   0.   0.  ] | cost: 1214.03
theta: [-0.07  1.84  2.55 -2.87 -0.02 -0.13 -0.34  0.19  0.07 -0.22 -0.3   0.43] | cost: 1002.46
theta: [-0.25 -0.76  4.81 -3.06 -0.08 -0.38 -1.11  0.61  0.24 -0.66 -0.93  1.27] | cost: 815.50
theta: [-0.44 -0.33  4.08 -2.7  -0.14 -0.61 -1.89  1.02  0.4  -1.06 -1.57  2.09] | cost: 491.91
theta: [-1.52  0.85  2.   -1.58 -0.52 -2.22 -5.63  3.29  1.42 -2.59 -5.14  5.54] | cost: 140.86
theta: [-2.25  0.9   1.72 -1.3  -0.82 -3.52 -7.25  4.64  2.16 -2.95 -7.32  6.61] | cost: 130.33
theta: [ -4.16   0.84   1.32  -0.78  -1.65  -7.09 -10.4    7.82   4.18  -3.44
 -12.61   8.24] | cost: 116.92
theta: [ -5.89   0.75   1.17  -0.5   -2.45 -10.36 -11.81  10.04   6.08  -3.6
 -16.65   8.45] | cost: 110.37
theta: [ -7.75   0.67   1.13  -0.35  -3.38 -13.76 -11.84  11.55   8.2   -3.8
 -20.     7.55] | cost: 105.74
theta: [ -9.41   0.64   1.15  -0.31  -4.26 -16.36 -10.81  11.97  10.12  -4.33
 -21.88   6.15] | cost: 102.82
theta: [-11.08   0.66   1.17  -0.32  -5.18 -18.28  -9.43  11.61  11.99  -5.37
 -22.77   4.69] | cost: 100.70
theta: [-12.59   0.69   1.16  -0.32  -6.02 -19.17  -8.53  10.86  13.54  -6.65
 -22.89   3.73] | cost: 99.34
theta: [-14.2    0.72   1.14  -0.3   -6.89 -19.35  -8.29  10.03  14.98  -7.99
 -22.74   3.14] | cost: 98.30
theta: [-16.14   0.73   1.11  -0.26  -7.94 -19.03  -8.65   9.3   16.47  -9.18
 -22.59   2.76] | cost: 97.35
theta: [-18.68   0.73   1.1   -0.21  -9.27 -18.29  -9.42   8.76  18.14 -10.04
 -22.55   2.39] | cost: 96.38
theta: [-21.93   0.72   1.1   -0.17 -10.94 -17.19 -10.25   8.5   19.92 -10.36
 -22.66   1.99] | cost: 95.35
theta: [-26.08   0.7    1.13  -0.14 -13.03 -15.78 -10.79   8.54  21.78 -10.05
 -22.83   1.59] | cost: 94.18
theta: [-31.35   0.69   1.17  -0.13 -15.59 -14.12 -10.69   8.9   23.61  -9.19
 -22.93   1.32] | cost: 92.84
theta: [-37.51   0.7    1.21  -0.13 -18.44 -12.47  -9.79   9.52  25.14  -8.06
 -22.78   1.38] | cost: 91.40
theta: [-43.57   0.72   1.23  -0.12 -21.06 -11.3   -8.4   10.2   25.98  -7.16
 -22.24   1.87] | cost: 90.06
theta: [-48.96   0.74   1.23  -0.1  -23.13 -10.82  -7.13  10.76  26.06  -6.79
 -21.34   2.6 ] | cost: 88.89
theta: [-54.87   0.76   1.22  -0.05 -25.11 -10.88  -6.25  11.22  25.55  -6.8
 -20.04   3.41] | cost: 87.62
theta: [-63.83   0.78   1.21   0.02 -27.82 -11.42  -5.83  11.68  24.36  -6.96
 -17.97   4.26] | cost: 85.79
theta: [-77.9    0.8    1.22   0.13 -31.81 -12.47  -6.17  12.03  22.29  -6.98
 -14.93   4.9 ] | cost: 83.19
theta: [-94.94   0.81   1.26   0.23 -36.3  -13.73  -7.37  11.98  19.65  -6.47
 -11.73   4.88] | cost: 80.40
theta: [-108.1     0.81    1.34    0.28  -39.34  -14.55   -8.72   11.32   17.48
   -5.47   -9.92    4.21] | cost: 78.34
theta: [-115.07    0.81    1.4     0.29  -40.38  -14.75   -9.46   10.3    16.16
   -4.47   -9.7     3.5 ] | cost: 77.07
theta: [-119.8     0.81    1.44    0.28  -40.43  -14.6    -9.61    9.02   15.09
   -3.67  -10.25    3.05] | cost: 76.03
theta: [-125.16    0.82    1.47    0.3   -40.01  -14.23   -9.3     7.48   13.79
   -3.14  -11.09    2.94] | cost: 74.96
theta: [-131.24    0.83    1.48    0.33  -39.39  -13.76   -8.71    6.21   12.41
   -3.16  -11.79    3.17] | cost: 74.03
theta: [-137.42    0.84    1.48    0.39  -38.62  -13.25   -8.11    5.57   11.18
   -3.67  -12.11    3.47] | cost: 73.23
theta: [-144.82    0.85    1.47    0.46  -37.36  -12.53   -7.56    5.47    9.93
   -4.57  -12.23    3.56] | cost: 72.28
theta: [-155.48    0.86    1.48    0.54  -34.88  -11.3    -6.98    5.95    8.38
   -5.92  -12.27    3.13] | cost: 70.91
theta: [-167.86    0.88    1.52    0.62  -31.01   -9.63   -6.53    7.03    6.9
   -7.3   -12.29    1.91] | cost: 69.33
theta: [-176.09    0.89    1.57    0.64  -27.32   -8.32   -6.41    8.07    6.31
   -7.84  -12.29    0.44] | cost: 68.19
theta: [-178.63    0.9     1.6     0.62  -25.15   -7.88   -6.5     8.52    6.6
   -7.51  -12.19   -0.39] | cost: 67.59
theta: [-179.83    0.91    1.63    0.6   -23.4    -7.84   -6.6     8.61    7.27
   -6.83  -11.89   -0.72] | cost: 67.08
theta: [-182.79    0.91    1.66    0.58  -20.55   -8.01   -6.68    8.49    8.44
   -5.7   -11.11   -0.69] | cost: 66.27
theta: [-190.23    0.93    1.68    0.6   -15.62   -8.38   -6.68    8.1    10.26
   -4.1    -9.46    0.01] | cost: 65.11
theta: [-199.13    0.93    1.69    0.67  -11.37   -8.7    -6.55    7.67   11.53
   -3.17   -7.81    1.13] | cost: 64.28
theta: [-203.85    0.93    1.68    0.72  -10.03   -8.78   -6.42    7.5    11.68
   -3.25   -7.13    1.86] | cost: 64.01
theta: [-204.24    0.93    1.67    0.74  -10.33   -8.74   -6.39    7.52   11.46
   -3.52   -7.17    1.97] | cost: 63.98
theta: [-204.06    0.93    1.67    0.74  -10.48   -8.72   -6.39    7.54   11.39
   -3.59   -7.22    1.95] | cost: 63.98
theta: [-204.03    0.93    1.67    0.74  -10.5    -8.72   -6.39    7.54   11.39
   -3.6    -7.22    1.95] | cost: 63.98
theta: [-204.03    0.93    1.67    0.74  -10.5    -8.72   -6.39    7.54   11.39
   -3.6    -7.22    1.95] | cost: 63.98
theta: [-204.03    0.93    1.67    0.74  -10.5    -8.72   -6.39    7.54   11.39
   -3.6    -7.22    1.95] | cost: 63.98
theta: [-204.03    0.93    1.67    0.74  -10.5    -8.72   -6.39    7.54   11.39
   -3.6    -7.22    1.95] | cost: 63.98
theta: [-204.03    0.93    1.67    0.74  -10.5    -8.72   -6.39    7.54   11.39
   -3.6    -7.22    1.95] | cost: 63.98
theta: [-204.03    0.93    1.67    0.74  -10.5    -8.72   -6.39    7.54   11.39
   -3.6    -7.22    1.95] | cost: 63.98
```

ููููุฐุฌูุง ูุจุฏู ูุงูุชุงูู:

$$ y = -204.03 + 0.93x_1 + ... -7.22x_{9} + 1.95x_{11} $$

ูููุงุฑู ูุฐู ุงููุนุงุฏูู ุงูุชู ุญุตููุง ุนูููุง ูุน ุฃุฎุฑู ูุฏ ูุญุตู ุนูููุง ูู ูููุฐุฌ ุงูุฅูุญุฏุงุฑ ุงูุฎุทู ูู ููุชุจุฉ `sklearn`:

```python
model = LinearRegression(fit_intercept=False)
model.fit(X_train[:, :14], y_train)
print("Coefficients", model.coef_)
```

```ruby
Coefficients [-204.03    0.93    1.67    0.74  -10.5    -8.72   -6.39    7.54   11.39
   -3.6    -7.22    1.95]
```

ูุธูุฑ ุงููุนุงูู ูุทุงุจูุงู ููุง ุญุตููุง ุนููู! ุฏูุงููุง ุงูุชู ูุชุจูุงูุง ุงูุชุฌุช ููุณ ุงููููุฐุฌ  ููุง ูู ุงูุชุฌุชู ููุชุจุฉ ุจุงูุซูู!

ุชูููุง ุจูุฌุงุญ ูู ุถุจุท ุงููููุฐุฌ ุงูุฎุทู!

### ุชูููู ูููุฐุฌูุง

ุฎุทูุชูุง ุงูุชุงููู ูู ุชูููู ูุชุงุฆุฌ ุงููููุฐุฌ ุจุฅุณุชุฎุฏุงู ุจูุงูุงุช ุงูุฅุฎุชุจุงุฑ. ูุญุชุงุฌ ูุชุทุจูู ุฌููุน ูุง ูุนููุงู ุนูู ุจูุงูุงุช ุงูุชุฏุฑูุจ ูู ุจูุงูุงุช ุงูุฅุฎุชุจุงุฑ ูุจู ุงู ูุฏุฎููุง ุฅูู ุงููููุฐุฌ ููุชููุน: 

```python
X_test.drop(['Sex', 'WeightAlt'], axis=1, inplace=True)
X_test = pd.get_dummies(X_test, columns=['BCS', 'Age'])
age_over_10 = X_test['Age_10-15'] | X_test['Age_15-20'] | X_test['Age_>20']
X_test['Age_>10'] = age_over_10
X_test.drop(['Age_10-15', 'Age_15-20', 'Age_>20'], axis=1, inplace=True)
X_test.drop(['BCS_3.0', 'Age_5-10'], axis=1, inplace=True)
X_test = X_test.assign(bias=1)
X_test = X_test.reindex(columns=['bias'] + list(X_test.columns[:-1]))

X_test
```

**Age\_>10**|**Age\_<2**|**Age\_2-5**|**BCS\_4.0**|**BCS\_3.5**|**BCS\_2.5**|**BCS\_2.0**|**BCS\_1.5**|**Height**|**Girth**|**Length**|**bias**| 
:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:
1|0|0|0|0|1|0|0|103|119|98|1|490
0|0|1|0|0|0|0|0|105|114|86|1|75
1|0|0|0|0|0|0|0|101|114|94|1|352
...|...|...|...|...|...|...|...|...|...|...|...|...
0|0|1|0|0|0|0|0|102|114|94|1|182
0|0|0|0|0|1|0|0|105|113|104|1|334
0|0|0|0|0|0|0|0|110|124|104|1|543

```ruby
108 rows ร 12 columns
```

ูููู ุจุฅุฏุฎุงู `X_test` ุฅูู `predict` ูู ูููุฐุฌูุง ุงูุฎุทู `LinearRegression`:

```python
X_test = X_test.values
predictions = model.predict(X_test)
```

ุงูุขู ููุทูุน ุนูู ูุชูุฌุฉ ุงูุฎุทุฃ ุงูุชุฑุจูุนู ุงููุชูุณุท:

```python
mse_test_set(predictions)
```

```ruby
7261.974205350604
```

ุจูุฐู ุงูุชููุนุงุชุ ูููููุง ุฑุณู ูุชูุฌุฉ ุงููุงุฑู ุจูู ุงูุชููุน ููุงุฑูู ุจุงููุชุงุฆุฌ ุงูุญูููู Residual plot:

```python
y_test = y_test.values
resid = y_test - predictions
resid_prop = resid / y_test
plt.scatter(np.arange(len(resid_prop)), resid_prop, s=15)
plt.axhline(0)
plt.title('Residual proportions (resid / actual Weight)')
plt.xlabel('Index of row in data')
plt.ylabel('Error proportion');
```

<p align="center"> 
<img src='{{ site.baseurl }}/img/chapter13/linear_case_study_91_0.png'>
</p>

ูุจุฏู ุงู ุงููููุฐุฌ ูุคุฏู ุจุดูู ุฑุงุฆุน! ูุชูุฌุฉ ุงููุงุฑู ุจูู ุงูุชููุน ูุงููุชุงุฆุฌ ุงูุญูููู ุชุธูุฑ ุงู ุชููุนูุง ูุงู ุจุญุฏ ุฃุนูู 15% ูู ุงููุชูุฌุฉ ุงูุญูููู.

[LinearLeastSquares]: https://towardsdatascience.com/linear-regression-using-least-squares-a4c3456e8570
[Scalar]: https://www.youtube.com/watch?v=rcDXQ-5H8mk
[Vector]: https://www.mathsisfun.com/algebra/scalar-vector-matrix.html