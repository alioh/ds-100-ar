---
title: ุงูููุงุฐุฌ ูุงูุชููุนุงุช
show_title: true
chapter_number: 10
chapter_text: ุงููุตู ุงูุนุงุดุฑ
chapter_lessons: [[0, 'ููุฏูุฉ'], [1, 'ุงูููุงุฐุฌ'], [2, 'ุฏุงูุฉ ุงูุฎุณุงุฑุฉ'], [3, 'ุฏุงูุชู ุงูุฎุณุงุฑุฉ Absolute ู Huber']]
chapter_sublessons: [
    [],
    ['ุงููููุฐุฌ ุงูุจุณูุท', 'ูุงุฆุฏุฉ ุฏุงูุฉ ุงูุฎุณุงุฑุฉ'],
    ['ุฏุงูุฉ ุงูุฎุณุงุฑุฉ ุงูุฃููู ููุง: ุงูุฎุทุฃ ุงูุชุฑุจูุนู ุงููุชูุณุท', ['ุชุจุณูุท ุงูุฏุงูุฉ','ุชูููู ุงูุฎุณุงุฑุฉ'], 'ุชูููู ุงูุฎุทุฃ ุงูุชุฑุจูุนู ุงููุชูุณุท', 'ุงูุนูุฏุฉ ููุจูุงูุงุช ุงูุฃุตููุฉ', 'ููุฎุต ุฏุงูุฉ ุงูุฎุณุงุฑุฉ'],
    [['ูุชูุณุท ุงูุฎุทุฃ ุงูุญุชูู', 'ููุงุฑูุฉ ุจูู MSE ู MAE'], 'ุงูููู ุงูุดุงุฐุฉ', 'ุชูููู ูุชูุณุท ุงูุฎุทุฃ ุงูุญุชูู', ['ููุงุฑูุฉ MSE ู MAE', 'ุฏุงูุฉ ุงูุฎุณุงุฑุฉ Huber'], 'ููุฎุต ุฏุงูุชู ุงูุฎุณุงุฑุฉ Absolute ู Huber']
]
layout: default
---

## ููุฏูุฉ

> ุจุดูู ุนุงูุ ุฌููุน ุงูููุงุฐุฌ ุฎุงุทุฆุฉุ ูููู ุจุนุถูุง ูููุฏ.
>
> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;โ [ุฌูุฑุฌ ุจููุณุ ุฅุญุตุงุฆู](https://www.wikiwand.com/en/George_E._P._Box)

ุชุญุฏุซูุง ุนู ุชูููู ุงูุณุคุงูุ ุชูุธูู ุงูุจูุงูุงุช ูุงูุชุญููู ุงูุงุณุชูุดุงูู ููุจูุงูุงุชุ ุงูุฎุทูุงุช ุงูุซูุงุซ ุงูุฃููู ูู ุฏูุฑุฉ ุญูุงุฉ ุนูู ุงูุจูุงูุงุช. ูุฑุฃููุง ุฃู ุงูุชุญููู ุงูุงุณุชูุดุงูู ูุธูุฑ ุนูุงูุงุช ุจูู ุงูููู ูู ุงูุจูุงูุงุช. ููู ูููููุง ุงูุชุญูู ุฅุฐุง ูุงูุช ูุฐู ุงูุนูุงูุฉ ุญูููุฉ ุฃู ูุงุ ููู ูููููุง ุงุณุชุฎุฏุงู ูุฐู ุงูุนูุงูุงุช ููุญุตูู ุนูู ุชููุนุงุช ุนู ุงููุณุชูุจูุ ููุฅุฌุงุจุฉ ุนูู ูุฐู ุงูุฃุณุฆูุฉ ุณูุญุชุงุฌ ูุฃุฏุงุฉ ุฑูุงุถูุฉ ูุจูุงุก ุงูููุงุฐุฌ ูุงูุชููุนุงุช.

ุงููููุฐุฌ ูู ุนุจุงุฑุฉ ุนู ุฃูุถู ุชูุซูู ููุธุงููุง. ูุซูุงูุ ุฅุฐุง ูููุง ุจุฑูู ูุฑู ูู ุงููููุงุฐ ูู ููู ุจุฑุฌ ุจูุฒุง ุงููุงุฆูุ ูููุฐุฌ ุจุณูุท ููุฌุงุฐุจูุฉ ุณูุชููุน ุฃู ุงููุฑู ุณุชุฑุชุทู ุจุงูุฃุฑุถ ุจุณุฑุนุฉ 9. 8 ู/ุซยฒ. ูุฐุง ุงููููุฐุฌ ุณูุญ ููุง ุจุชููุน ูู ุณูุฃุฎุฐ ุงููุฑู ูู ููุช ูููุตูู ุฅูู ุงูุฃุฑุถ ุจุงุณุชุฎุฏุงู ููุงููู ุงูุญุฑูุฉ.

ูุฐุง ุงููููุฐุฌ ููุฌุงุฐุจูุฉ ููุถุญ ุณููู ูุฃุฏุงุก ูุธุงููุง ูููู ููุท ูู ุงูุชููุนุ ูุง ูููู ุจุญุณุงุจ ุชุฃุซูุฑ ุญุฑูุฉ ุงูููุงุกุ ูุงูุทูู ูู ุงูููุงุก ูุงูุชุฃุซูุฑุงุช ุงูุฃุฎุฑู ุนูู ุฌุงุฐุจูุฉ ุงูุฃุฌุณุงู ุฃุซูุงุก ุงูุณููุท. ุจุณุจุจ ูุฐู ุงูุนูุงูู ุบูุฑ ุงููุฏุฑูุณุฉุ ูููุฐุฌูุง ุณููุชุฌ ุฏุงุฆูุงู ุชููุนุงุช ุฎุงุทุฆุฉ! ููููุ ุงููููุฐุฌ ุงูุจุณูุท ููุฌุงุฐุจูุฉ ูุนุชุจุฑ ุฏููู ุจุดูู ูุงูู ูู ูุซูุฑ ูู ุงูุฃุญูุงู ููุง ูุฌุนูู ูุณุชุฎุฏู ูููุนููู ุงูููู.

ูุจููุณ ุงูุทุฑููุฉุ ูู ูููุฐุฌ ูููู ุจุชุนุฑููู ุจุงุณุชุฎุฏุงู ุจูุงูุงุช ูุนุชุจุฑ ุชูุฏูุฑ ููุง ูู ุจุงููุงูุน. ุนูุฏูุง ูุง ูููู ุงูุชูุฏูุฑ ุฏููู ุฌุฏุงูุ ูููุฐุฌูุง ูููู ุงุณุชุฎุฏุงูู ูููุฏ ูุนููู. ูุจุทุจูุนุฉ ุงูุญุงูุ ุณุชุธูุฑ ููุง ุฃุณุฆูุฉ ุฃุณุงุณูู ูุซูุ ููู ูุฎุชุงุฑ ุงููููุฐุฌุ ููู ูุนุฑู ูุง ุฅุฐุง ููุง ูุญุชุงุฌ ูููุฐุฌ ุฃูุซุฑ ุชุนููุฏุงูุ

ูู ุงููุตูู ุงููุงุฏูุฉ ูู ูุฐุง ุงููุชุงุจุ ุณูููู ุจุชุทููุฑ ุฃุฏูุงุช ุญุณุงุจูุฉ ูุชุตููู ููุฏุฑุจ ุงููููุฐุฌ ุนูู ุงูุจูุงูุงุช. ุณูููู ุฃูุถุง ุจุงูุชุนุฑู ุนูู ุฃุฏูุงุช ุงุณุชูุชุงุฌูุฉ ุชููููุง ูู ูุนุฑูุฉ ุฅุฐุง ูุงู ุจุฅููุงููุง ุชุนููู ููุงุฐุฌูุง.

## ุงูููุงุฐุฌ

ูู ุงูููุงูุงุช ุงููุชุญุฏุฉุ ุงููุซูุฑ ูู ุฒูุงุฑ ุงููุทุงุนู ูุชุฑููู ุจุนุถ ูู ุงููุงู ูููุงุฏู ุฃุซูุงุก ุฏูุนูู ูุซูู ูุฌุจุงุชูู. ุฑุบู ุฃูู ูู ุงููุนุฑูู ูู ุงูููุงูุงุช ุงููุชุญุฏุฉ ุฃู 15% ูู ูุฌููุน ุงููุงุชูุฑุฉ ูููู ูุฅูุฑุงููุฉุ ุฅูุง ุฃู ุจุนุถ ุงููุทุงุนู ูุฏููุง ุฒุจุงุฆู ูุฎูุตูู ุฃูุซุฑ ูู ุบูุฑูุง ููุฏููู ุงููุฒูุฏ ูู ุงููุงู ูุฅูุฑุงููุฉ.

ุฃุญุฏ ุงูููุงุฏู ุงูููุชููู ุฃุฑุงุฏ ูุนุฑูุฉ ูุง ูุฏ ูุญุตู ุนููู ูู ุฅูุฑุงููุฉ ููุงู ุจุฌูุน ูุนูููุงุช ุนู ูุงูุฉ ุงูุทุงููุงุช ุงูุชู ุฎุฏููุง ูู ุบุถูู ุดูุฑ:

```python
tips = sns.load_dataset('tips')
tips
```

**size**|**time**|**day**|**smoker**|**sex**|**tip**|**total\_bill**| 
:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:
2|Dinner|Sun|No|Female|1.01|16.99|0
3|Dinner|Sun|No|Male|1.66|10.34|1
3|Dinner|Sun|No|Male|3.5|21.01|2
...|...|...|...|...|...|...|...
2|Dinner|Sat|Yes|Male|2|22.67|241
2|Dinner|Sat|No|Male|1.75|17.82|242
2|Dinner|Thur|No|Female|3|18.78|243

```center-result
244 rows ร 7 columns
```

```python
sns.distplot(tips['tip'], bins=np.arange(0, 10.1, 0.25), rug=True)
plt.xlabel('Tip Amount in Dollars')
plt.ylabel('Proportion per Dollar');
```

ูููููุง ุฑุณู ูุฏุฑุฌ ุชูุฑุงุฑู ููุฌููุน ุงูุฅูุฑุงููุงุช:

<p align='center'>
<img src='{{ site.baseurl }}/img/chapter10/hist-totaltips.png'>
</p>

ุจุฅููุงููุง ููุงุญุธุฉ ุจุนุถ ุงูุฃููุงุท ูู ุงูุจูุงูุงุช. ูุซูุงูุ ููุงู ุชูุฑุงุฑ ูุจูุฑ ูููููุฉ 2<span>$</span> ูุบุงูุจ ุงูุฅูุฑุงููุงุช ูู ูุถุงุนูุงุช 0.50<span>$</span>.

ุญุงููุงูุ ูุญู ููุชููู ุจูุณุจุฉ ุงูุฅูุฑุงููุฉ: ูููุฉ ุงูุฅูุฑุงููุฉ ูุณูุฉ ูุฌููุน ุงููุงุชูุฑู. ูููููุง ุฅูุดุงุก ุนุงููุฏ ุฌุฏูุฏ ูู ุงู DataFrame ูุญูุธ ูุฐู ุงููููู ููุนุฑุถ ุชูุฒูุน ุงููุชุงุฆุฌ:

```python
tips['pcttip'] = tips['tip'] / tips['total_bill'] * 100
sns.distplot(tips['pcttip'], rug=True)
plt.xlabel('Percent Tip Amount')
plt.ylabel('Proportion per Percent');
```

<p align='center'>
<img src='{{ site.baseurl }}/img/chapter10/hist-tipspercent.png'>
</p>

ูุจุฏู ุฃู ุฃุญุฏ ุงูุฒุจุงุฆู ุชุฑู ูููุงุฏู ุฅูุฑุงููุฉ ูููุชูุง 70%! ูููู ุฃุบูุจ ุงูุฅูุฑุงููุงุช ูุงู ุฃูู ูู 30%. ูููุฑุจ ุงูุฑุณู ุงูุจูุงูู ุฅูู ุฐูู ุงูุฌุฒุก:

```python
sns.distplot(tips['pcttip'], bins=np.arange(30), rug=True)
plt.xlim(0, 30)
plt.xlabel('Percent Tip Amount')
plt.ylabel('Proportion per Percent');
```

<p align='center'>
<img src='{{ site.baseurl }}/img/chapter10/hist-tipslessthan30percent.png'>
</p>

ููุงุญุธ ุฃู ุชูุฒูุน ุงูุจูุงูุงุช ูู ุงูุบุงูุจ ุญูู 15% ูุน ูุฌููุน ุชูุฑุงุฑ ุฃุนูู ุญูู 20%. ูููุชุฑุถ ุฃู ูุงุฏููุง ูุฑูุฏ ูุนุฑูุฉ ูู ุงููุณุจุฉ ุงูุชู ุณูุญุตู ุนูููุง ูู ุงูุฒุจุงุฆู. ููุฅุฌุงุจุฉ ุนูู ุงูุณุคุงูุ ูููููุง ุจูุงุก ูููุฐุฌ ูุชููุน ูู ูุจูุบ ุงูุฅูุฑุงููุฉ ุงูุฐู ุณูุญุตู ุนูููุง ุงููุงุฏู.

### ุงููููุฐุฌ ุงูุจุณูุท

ุฃุญุฏ ุฃูุซูู ุนูู ุงููููุฐุฌ ุงูุจุณูุท ูู ุชุฌุงูู ูู ุงูุจูุงูุงุช ูุฐูุฑ ุฃูู ูู ุงููุนุฑูู ูู ุงูููุงูุงุช ุงููุชุญุฏุฉ ุฅุนุทุงุก ุฅูุฑุงููุฉ ุจููุฏุงุฑ 15% ูู ูุจูุบ ุงููุงุชูุฑุฉุ ุจุฐูู ูุญุตู ุงููุงุฏู ุฏุงุฆูุงู ุนูู 15% ูู ูู ุฒุจูู. ุนูู ุงูุฑุบู ูู ุจุณุงุทุชูุ ุณูุณุชุฎุฏู ูุฐู ุงููููุฐุฌ ููุชุนุฑูู ุจุจุนุถ ุงููุชุบูุฑุงุช ูุงุญูุงู.

ูุฐุง ุงููููุฐุฌ ููุชุฑุถ ุฃู ููุงู ูุณุจู ูุญูุฏู ุตุญูุญู ููู ุงูุฅูุฑุงููุงุช ุงูุชู ุณูุญุตู ุนูููุง ุงููุงุฏู ูู ูู ุฒุจุงุฆูู. ูุฐู ูู *ูุนุงูู ุงููุฌุชูุน Population Parameter* ููุณุจุฉ ุงูุฅูุฑุงููุฉุ ูุงูุชู ุณูุฑูุฒ ููุง ุจุงูุฑูุฒ $ \theta^* $. [๐][PopulationParameterEN] [๐][PopulationParameterAR]

ุจุนุฏ ูุฑุถูุชูุง ุงูุณุงุจูุฉุ ูููุฐุฌูุง ุณูููู ุฅู ุชููุนู ููููุฉ $ \theta^* $ ูู 15%. ุณูุณุชุฎุฏู ุงูุฑูุฒ $ \theta $ ููุตู ุงูุชููุน (ุงูุชูุจุค).

ุจุฑููุฒ ุฑูุงุถูุฉุ ูุฅู ูููุฐุฌูุง ููุฑุถ ุงูุชุงูู:

$$ \theta = 15 $$

ูู ุงููุงุถุญ ุฃู ูุฐุง ุงููููุฐุฌ ูุญุชูู ุนูู ูุดุงููุ ุฅุฐุง ูุงู ุงููููุฐุฌ ุตุญูุญุ ูุฅู ุฌููุน ุงูุฒุจุงุฆู ูู ุจูุงูุงุชูุง ูุฏ ุฃุนุทูุง ุฅูุฑุงููุฉ ุจูููุฉ 15%. ููููุ ูุฐุง ุงููููุฐุฌ ุณูุนุทู ุชุฎูููุงู ูุนูููุงู ูู ูุซูุฑ ูู ุงูุฃุญูุงู. ุจุงูุฃุตุญุ ูุฐุง ุงููููุฐุฌ ูุนุชุจุฑ ุงูุฃูุซุฑ ูุงุฆุฏุฉ ุจุงููุณุจุฉ ููุง ุฅุฐุง ูู ููู ูุฏููุง ุฃู ูุนูููุงุช ุนู ุงููุงุฏู ูุงูุฒุจุงุฆู ุณูู ุฃููู ูู ุงูููุงูุงุช ุงููุชุญุฏุฉ.

ุจูุง ุฃู ุงููุงุฏู ูุฏููุง ูุงู ุจุฌูุน ุจูุงูุงุชุ ูููููุง ุงุณุชุฎุฏุงู ุงููุนูููุงุช ุงูุชุงุฑูุฎ ููุฅูุฑุงููุงุช ุงูุชู ุญุตู ุนูููุง ูุจูุงุก ูููุฐุฌ ูุนุทู ุชูุจุค ุจุฏูู ุนู 15% ุงููุนุฑููุฉ ุจูู ูุทุงุนู ุงูููุงูุงุช ุงููุชุญุฏุฉ.

### ูุงุฆุฏุฉ ุฏุงูุฉ ุงูุฎุณุงุฑุฉ

ุนุฑุถูุง ุณุงุจูุงู ุชูุฒูุน ูุณุจุฉ ุงูุฅูุฑุงููุงุช ูู ุงูุจูุงูุงุช:

<p align='center'>
<img src='{{ site.baseurl }}/img/chapter10/hist-tipslessthan30percent.png'>
</p>

ูููุชุฑุถ ุฃููุง ูุฑูุฏ ููุงุฑูุฉ ุฎูุงุฑูู ู $ \theta $: $ 10% $ ู $ 15% $. ูููููุง ุฅุธูุงุฑ ูุฐูู ุงูุฎูุงุฑูู ูู ุฑุณููุง ุงูุจูุงูู:

<p align='center'>
<img src='{{ site.baseurl }}/img/chapter10/hist-tips10and15percent.png'>
</p>

ุจุดูู ูุงุถุญุ ูุธูุฑ ุฃู ุงุฎุชูุงุฑ $ \theta = 15 $ ูุจุฏู ุฃูุถู ูู $ \theta = 10 $ ุจูููุงุกูุง ุนูู ุงูุจูุงูุงุช. ููุงุฐุงุ ุนูุฏูุง ููุงุญุธ ููุงุท ุงูุจูุงูุงุชุ ูุฑู ุฃู ุฃูุซุฑ ุงูุจูุงูุงุช ูุงูุช ุฃูุฑุจ ู 15 ูู 10.

ุนูู ุงูุฑุบู ุฃู $ \theta = 15 $ ุชุจุฏู ุฎูุงุฑูุง ุฃูุถูุ ูุง ูุนุฑู ูุง ุฅุฐุง ูุงูุช ูู ุฃูุถู ูู $ \theta = 16 $. ููููู ุจุงุฎุชูุงุฑ ุฏููู ุจูู ูุฎุชูู ุงุญุชูุงูุงุช $ \theta $ุ ูุฑูุฏ ุฃู ูุนูู ููู $ \theta $ ุฑูู ูุชุบูุฑ ูููุณ ูุง ุฅุฐุง ูุงู ููุงุณุจ ูุจูุงูุงุชูุง. ูุนูู ุฐููุ ูุญุชุงุฌ ูุฏุงูุฉ ุชุฃุฎุฐ ูููู ู $ \theta $ ูููู ูู ุจูุงูุงุชูุงุ ูุชูุชุฌ ููุง ุฑููุงู ูููููุง ุงุณุชุฎุฏุงูู ูุงุฎุชูุงุฑ ุฃูุถู ุงูููู ู $ \theta $.

ุชุณูู ูุฐู ุงูุฏุงูุฉ ุจ **ุฏุงูุฉ ุงูุฎุณุงุฑุฉ**.

## ุฏุงูุฉ ุงูุฎุณุงุฑุฉ

ููุฐูุฑ ูุฑุถูุชูุง ุงูุณุงุจูุฉ: ุงูุชุฑุถูุง ุฃู ููุงู ูุณุจู ูุงุญุฏุฉ ููุฅูุฑุงููุฉ ุจูู ุฌููุน ุงููุฌุชูุน $ \theta^* $. ูููุฐุฌูุง ูุชููุน ูุฐุง ุงูุฑููุ ุณูุณุชุฎุฏู $ \theta $ ูุชุฑููุฒ ุชููุนูุง. ูุฑูุฏ ุงุณุชุฎุฏุงู ุงูุจูุงูุงุช ุงูุชู ุฌูุนูุงูุง ุนู ุงูุฅูุฑุงููุงุช ูุญุณุงุจ ูููุฉ $ \theta $.

ูุชุญุฏูุฏ ุฃู ูููู ูู $ \theta $ ูู ุงูุตุญูุญุฉุ ุนุฑููุง **ุฏุงูุฉ ุงูุฎุณุงุฑุฉ**. ุฏุงูุฉ ุงูุฎุณุงุฑุฉ ูู ุฏุงูุฉ ุฑูุงุถูุฉ ุชุฃุฎุฐ ุชููุน ู $ \theta $ ูููุทุฉ ูู ุจูุงูุงุชูุง $ y_1, y_2, \ldots, y_n $ุ ูุชุฃุชู ุจูุชูุฌุฉ ุนุจุงุฑุฉ ุนู ุฑููุ **ุงูุฎุณุงุฑุฉ**ุ ูููุณ ูุฏู ุฏูุฉ $ \theta $ ูุจูุงูุงุชูุง. ุจุฑููุฒ ุฑูุงุถูุฉุ ูุฑูุฏ ูุชุงุจุฉ ุงูุฏุงูุฉ:

$$ L(\theta, y_1, y_2, \ldots, y_n) =\ \ldots $$

ุจุดูู ุนุงูุ ุงููุชูุฌุฉ ูู ุฏุงูุฉ ุงูุฎุณุงุฑุฉ ุนูุฏูุง ุชููู ุฑููุงู ุตุบูุฑ ูุฅู ูููุฉ $ \theta $ ููุงุณุจุฉ ูุฅุฐุง ูุงูุช ุงููุชูุฌุฉ ูู ุงูุฏุงูุฉ ุฑูู ูุจูุฑ ูุฅู ูููุฉ $ \theta $ ููุณุช ููุงุณุจู. ููุฏุฑุจ ุงููููุฐุฌุ ูุฎุชุงุฑ ููู ู $ \theta $ ุงูุชู ุชูุชุฌ ููุง ุฃุฑูุงู ุตุบูุฑุฉ ูู ุฏุงูุฉ ุงูุฎุณุงุฑุฉุ ุงูููู $ \theta $ ุงูุชู **ุชููู ูู ุงูุฎุณุงุฑุฉ**. ูุณุชุฎุฏู ุงูุฑูุฒ $ \hat{\theta} $ ููุฅุดุงุฑุฉ ูููู $ \theta $ ุงูุชู ุชููู ูู ุฏุงูุฉ ุงูุฎุณุงุฑุฉ.

ูููุชุฑุถ ูุฑุฉ ุฃุฎุฑู ุงูููู ุงูุชุงููุฉ ู $ \theta $: $ \theta = 10 $ ู $ \theta = 15 $:

```python
sns.distplot(tips['pcttip'], bins=np.arange(30), rug=True)

plt.axvline(x=10, c='darkblue', linestyle='--', label=r'$ \theta = 10$')
plt.axvline(x=15, c='darkgreen', linestyle='--', label=r'$ \theta = 15$')
plt.legend()

plt.xlim(0, 30)
plt.xlabel('Percent Tip Amount')
plt.ylabel('Proportion per Percent');
```

<p align='center'>
<img src='{{ site.baseurl }}/img/chapter10/hist-tips10and15percent.png'>
</p>

ุจูุง ุฃู $ \theta = 15 $ ุฃูุฑุจ ูููุซูุฑ ูู ุงูููุงุทุ ูุฅู ุฏุงูุฉ ุงูุฎุณุงุฑุฉ ูู ุงูููุชุฑุถ ุฃู ุชุฃุชู ุฑูู ุฃูู ู $ \theta = 15 $ ูุฑูู ุฃุนูู ู $ \theta = 10 $.

ููุณุชุฎุฏู ูุฐู ุงููุนูููู ูุฅูุดุงุก ุฏุงูุฉ ุงูุฎุณุงุฑุฉ.

### ุฏุงูุฉ ุงูุฎุณุงุฑุฉ ุงูุฃููู ููุง: ุงูุฎุทุฃ ุงูุชุฑุจูุนู ุงููุชูุณุท

ูุฑูุฏ ุงู ุชููู ูููุฉ $ \theta $ ูุฑูุจู ูู ุงููุซูุฑ ูู ุงูููุงุท ูู ุจูุงูุงุชูุง. ูุฐุงุ ูููู ุจุชุนุฑูู ุฏุงูุฉ ุฎุณุงุฑุฉ ูุทุจููุง ุนูู ุจูุงูุงุชูุง ูุชุฃุชู ุจูุชุงุฆุฌ ุนุงููู ู $ \theta $ ุฅุฐุง ูุงูุช ุจุนูุฏุฉ ุนู ุงููุซูุฑ ูู ุงูุจูุงูุงุช. ูุจุฏุฃ ุจุฏุงูุฉ ุฎุณุงุฑุฉ ุจุณูุทู ูุทูุน ุนูููุง *ุงูุฎุทุฃ ุงูุชุฑุจูุนู ุงููุชูุณุท Mean Squared Error*ุ ููุง ููุฑุชูุง:

- ูุฎุชุงุฑ ูููู ู $ \theta $.
- ููู ูููู ูู ุจูุงูุงุชูุงุ ูุฃุฎุฐ ุงููุฑู ุงูุชุฑุจูุนู ุจูู ุชูู ุงููููุฉ ู $ \theta $: $ (y_i - \theta)^2 $. ุทุฑููุฉ ุงูุชุฑุจูุน ูู ูุณููุฉ ุณููู ูุชุญููู ุงูููู ุงูุณูุจูุฉ ุฅูู ููู ุฅูุฌุงุจูุฉ. ูุฑูุฏ ุงูููุงู ุจุฐูู ูุฃู ุฅุฐุง ูุงูุช $ ( y_i = 14 $ ูุฅู ููุง ุงููููุชูู $ \theta = 10 $ ู $ \theta = 18 $ ูุนุชุจุฑุงู ุจุนูุฏูู ุนู ุจุงูู ุงูููุงุท ููุนุชุจุฑูู ููู ุบูุฑ ููุงุณุจุฉ.
- ููููุงู ุจุนูููุฉ ุงูุญุณุงุจ ูุฏุงูุฉ ุงูุฎุณุงุฑุฉุ ูุฃุฎุฐ ูุชูุณุท ูู ูููู ูููุฑู ุงูุชุฑุจูุนู.

$$ \begin{aligned}
L(\theta, y_1, y_2, \ldots, y_n)
&= \text{average}\left\{ (y_1 - \theta)^2, (y_2 - \theta)^2, \ldots, (y_n - \theta)^2 \right\} \\
&= \frac{1}{n} \left((y_1 - \theta)^2 + (y_2 - \theta)^2 + \ldots + (y_n - \theta)^2 \right) \\
&= \frac{1}{n} \sum_{i = 1}^{n}(y_i - \theta)^2\\
\end{aligned} $$

ูุชุงุจุฉ ุฏุงูุฉ ูู ุจุงูุซูู ููููุงู ุจุนูููุฉ ุญุณุงุจ ุฏุงูุฉ ุงูุฎุณุงุฑุฉ ูุฐู ุณูู ุฌุฏุงู:

```python
def mse_loss(theta, y_vals):
    return np.mean((y_vals - theta) ** 2)
```

ููุฑู ููููุฉ ุฃุฏุงุก ูุฐู ุงูุฏุงูุฉ. ูููุฑุถ ุฃู ูุฏููุง ุจูุงูุงุช ุชุญุชูู ุนูู ูููุฉ ูุงุญุฏ ููุทุ $ y_1 = 14 $. ูููููุง ุชุฌุฑุจุฉ ุฃูุซุฑ ูู ูููู ู $ \theta $ ููุฑู ูุชูุฌุฉ ุฏุงูุฉ ุงูุฎุณุงุฑุฉ ููู ูููู:

```python
# ูุง ููู ูุนุฑูุฉ ูุง ูุฌุฑู ูู ุงูููุฏ ุงูุจุฑูุฌู ุงูุชุงููุ ูุชูุฌุฉ ุงูููุฏ ูู ุงูุตูุฑุฉ ูู ุงูุฃุณูู
def try_thetas(thetas, y_vals, xlims, loss_fn=mse_loss, figsize=(10, 7), cols=3):
    if not isinstance(y_vals, np.ndarray):
        y_vals = np.array(y_vals)
    rows = int(np.ceil(len(thetas) / cols))
    plt.figure(figsize=figsize)
    for i, theta in enumerate(thetas):
        ax = plt.subplot(rows, cols, i + 1)
        sns.rugplot(y_vals, height=0.1, ax=ax)
        plt.axvline(theta, linestyle='--',
                    label=rf'$ \theta = {theta} $')
        plt.title(f'Loss = {loss_fn(theta, y_vals):.2f}')
        plt.xlim(*xlims)
        plt.yticks([])
        plt.legend()
    plt.tight_layout()

try_thetas(thetas=[11, 12, 13, 14, 15, 16],
           y_vals=[14], xlims=(10, 17))
```

<p align='center'>
<img src='{{ site.baseurl }}/img/chapter10/hists-lossfunctions14.png'>
</p>

ููุง ุชููุนูุงุ ูููุฉ ุฏุงูุฉ ุงูุฎุณุงุฑุฉ ุฃุนูู ูููุง ูุงูุช $ \theta $ ุฃุจุนุฏ ูู ูุฌูุน ุงูุจูุงูุงุช ูุฃูู ูููุง ูุงูุช ุฃูุฑุจ ุฃู ูู ููุณ ุงูููุทุฉ. ููุฑู ููู ูุชุตุฑู ุงูุฎุทุฃ ุงูุชุฑุจูุนู ุงููุชูุณุท ุฅุฐุง ูุงูุช ูุฏููุง ุฃูุซุฑ ูู ูููู. ูุชูู ุจูุงูุงุชูุง ูู ุงูููู ุงูุชุงููุฉ: $ [11,12,15,17,18] $

```python
try_thetas(thetas=[12, 13, 14, 15, 16, 17],
           y_vals=[11, 12, 15, 17, 18],
           xlims=(10.5, 18.5))
```

<p align='center'>
<img src='{{ site.baseurl }}/img/chapter10/hists-lossfunctions5datapoints.png'>
</p>

ูู ููู $ \theta $ ุงูุณุงุจูุฉ ูุฑู ุฃู $ \theta = 15 $ ูุฏููุง ุฃูู ูุชูุฌุฉ ูุฏุงูุฉ ุงูุฎุณุงุฑุฉ. ูููุ ููุฌุฏ ุฑูู ุจูู 14 ู 15 ูุฏ ูุญุตู ุนูู ูุชูุฌุฉ ุฃูู ูุฏุงูุฉ ุงูุฎุณุงุฑุฉ. ููุญุงูู ุงูุจุญุซ ุนู ุชูู ุงููููู ุงูุฃูุถู ู $ \theta $

```python
import numpy as np
import matplotlib.pyplot as plt
import pandas as pd
import seaborn as sns
%matplotlib inline
import ipywidgets as widgets
from ipywidgets import interact, interactive, fixed, interact_manual

def try_thetas_interact(theta, y_vals, xlims, loss_fn=mse_loss):
    if not isinstance(y_vals, np.ndarray):
        y_vals = np.array(y_vals)
    plt.figure(figsize=(4, 3))
    sns.rugplot(y_vals, height=0.1)
    plt.axvline(theta, linestyle='--')
    plt.xlim(*xlims)
    plt.yticks([])
    print(f'Loss for theta = {theta}: {loss_fn(theta, y_vals):.2f}')

def mse_interact(theta, y_vals, xlims):
    plot = interactive(try_thetas_interact, theta=theta,
                       y_vals=fixed(y_vals), xlims=fixed(xlims),
                       loss_fn=fixed(mse_loss))
    plot.children[-1].layout.height = '240px'
    return plot
    
mse_interact(theta=(12, 17, 0.2),
             y_vals=[11, 12, 15, 17, 18],
             xlims=(10.5, 18.5))
```

> ุงูููุฏ ุงูุณุงุจู ููุชุฌ ุฑุณู ุจูุงูู ุชูุงุนููุ ูููููุง ููู ุงูุชุญูู ุจูููุฉ $ \theta $ ุฅูู ุฃู ูุญุตู ุนูู ูุชูุฌุฉ ููุงุณุจุฉ ูุฏุงูุฉ ุงูุฎุณุงุฑุฉ. ูุฐุง ุงูุทุฑููุฉ ุงูุชูุงุนููุฉ ุชุนูู ููุท ูู Jupyter Notebook ูุฐุง ุฅุฐุง ุฃุฑุฏ ุชุฌุฑุจุชูุง ูู ุจุชุดุบูู ูุงูู ุงูููุฏ ุงูุจุฑูุฌู ูุน ุฅุถุงูุฉ ุงูููุชุจุงุช ุงูุชู ูุญุชุงุฌูุง ูุงููุงู ูู Jupyter Notebook.

<p align='center'>
<img src='{{ site.baseurl }}/img/chapter10/hists-lossfunction146.gif'>
</p>

ููุงุญุธ ุงู ุฏุงูุฉ ุงูุฎุทุฃ ุงูุชุฑุจูุนู ุงููุชูุณุท ุชุคุฏู ุนูููุง ุจุดูู ูุชูู ูุฐูู ุจููุงููุง ุจูุนุงูุจุฉ ููู $ \theta $ ุงูุชู ุชููู ุจุนูุฏุฉ ุนู ูุฌููุน ุงูุจูุงูุงุช. ููุฑู ุงูุขู ูููุฉ ุฏุงูุฉ ุงูุฎุณุงุฑุฉ ูุจูุงูุงุช ุงููุณุจุฉ ุงููุฆููุฉ ููุฅูุฑุงููุฉุ ูุฑุณู ุงูุชูุฒูุน ุฃููุง:

<p align='center'>
<img src='{{ site.baseurl }}/img/chapter10/hist-tipslessthan30percent.png'>
</p>

ููุฌุฑุจ ุงูุขู ููู ูุฎุชููุฉ ู $ \theta $:

```python
try_thetas(thetas=np.arange(14.5, 17.1, 0.5),
           y_vals=tips['pcttip'],
           xlims=(0, 30))
```

<p align='center'>
<img src='{{ site.baseurl }}/img/chapter10/hists-lossfunctionstips.png'>
</p>

ุจููุณ ุงูุทุฑููุฉ ุงูุณุงุจูุฉุ ูููู ุงูููุงู ุจุฑุณู ุจูุงูู ุชูุงุนูู ูููุงุญุธุฉ ุงูุชุบูุฑ ูุน ุชุบููุฑ ูููุฉ $ \theta $:

```python
mse_interact(theta=(13, 17, 0.25),
             y_vals=tips['pcttip'],
             xlims=(0, 30))
```

<p align='center'>
<img src='{{ site.baseurl }}/img/chapter10/hists-lossfunctioninteracttip.gif'>
</p>

ููุงุญุธ ุงู ุงูุถู ูููุฉ ู $ \theta $ ูู 16.00ุ ุงุนูู ุจูููู ูู ุชููุนูุง ุงูุฃูู 15% ููู ุฅูุฑุงููุฉ.

### ุชุจุณูุท ุงูุฏุงูุฉ

ูููุง ุจุชุนุฑูู ุฃูู ุฏุงูุฉ ุฎุณุงุฑุฉ ููุงุ ุงูุฎุทุฃ ุงูุชุฑุจูุนู ุงููุชูุณุท (MSE). ููุชุฌ ููุง ุฑูู ุนุงูู ูููู $ \theta $ ุงูุจุนูุฏุฉ ุนู ูุฌููุน ุงูุจูุงูุงุช. ุฑูุงุถูุงูุ ูููููุง ุชุนุฑูู ุงูุฏุงูุฉ ูุงูุชุงูู:

$$ \begin{aligned}
L(\theta, y_1, y_2, \ldots, y_n)
&= \frac{1}{n} \sum_{i = 1}^{n}(y_i - \theta)^2\\
\end{aligned} $$

ุณุชููู ุงูุฏุงูุฉ ุจุฅูุชุงุฌ ุฃุฑูุงู ูุฎุชููุฉ ููุฎุณุงุฑุฉ ุนูุฏูุง ูููู ุจุฃู ุชุบูุฑ ุณูุงุก ู $ \theta $ ุฃู $ y_1, y_2, \ldots, y_n $. ูุงุญุธูุง ุฐูู ุนูุฏ ุชุฌุฑุจุชูุง ููู ูุฎุชููุฉ ู $ \theta $ ูุนูุฏ ุฅุถุงูุชูุง ููู ุงุถุงููู ููุจูุงูุงุช.

ูุงุฎุชุตุงุฑุ ูููููุง ุชุนุฑูู ุงููุตูููุฉ: $ \textbf{y} = [ y_1, y_2, \ldots, y_n ] $. ุซู ููุชุจ ุฏุงูุฉ ุงูุฎุทุฃ ุงูุชุฑุจูุนู ุงููุชูุณุท ูุงูุชุงูู:

$$ \begin{aligned}
L(\theta, \textbf{y})
&= \frac{1}{n} \sum_{i = 1}^{n}(y_i - \theta)^2\\
\end{aligned} $$

#### ุชูููู ุงูุฎุณุงุฑุฉ

ุญุชู ุงูุขูุ ูุฌุฏูุง ุฃูุถู ูููู ู $ \theta $ ุจุชุฌุฑุจุฉ ุฃูุซุฑ ูู ูููู ูุงุฎุชูุงุฑ ุฃูู ูููู ุจุนุฏ ุชุทุจูู ุฏุงูุฉ ุงูุฎุณุงุฑุฉ. ุนูู ุงูุฑุบู ูู ูุงุนููุฉ ูุฐู ุงูุทุฑููุฉุ ูููููุง ุฅูุฌุงุฏ ุทุฑู ุฃูุถู ุจุงุณุชุฎุฏุงู ุฎุตุงุฆุต ุฏุงูุฉ ุงูุฎุณุงุฑุฉ.

ูููุซุงู ุงูุชุงููุ ุงุณุชุฎุฏููุง ุจูุงูุงุช ุชุญุชูู ุนูู ุงูููู ุงูุชุงููุฉ: $ \textbf{y} = [ 11, 12, 15, 16, 17 ] $.

```python
try_thetas(thetas=[12, 13, 14, 15, 16, 17],
           y_vals=[11, 12, 15, 17, 18],
           xlims=(10.5, 18.5))
```

<p align='center'>
<img src='{{ site.baseurl }}/img/chapter10/hists-lossfunctions5datapoints.png'>
</p>

ูู ุงููุซุงู ุงุณุชุฎุฏููุง ูููุฉ ู $ \theta $ ุจูู 12 ู 17ุ ุนูุฏ ุชุบูุฑ ูููุฉ $ \theta $ุ ุชุจุฏุฃ ูุชูุฌุฉ ุงูุฏุงูุฉ ูุฑุชูุนู (10.92) ูุชูู ุญุชู ูุตู ุฅูู $ \theta = 15 $ุ ุซู ุชุฒูุฏ ุจุนุฏูุง. ูููููุง ููุงุญุธุฉ ุชุบูุฑ ูุชูุฌุฉ ุฏุงูุฉ ุงูุฎุณุงุฑุฉ ูููุง ุบูุฑูุง ูููุฉ $ \theta $ุ ูููุงุฑู ุงูุชุบูุฑ ูู ูู ูุฑุฉ ูููู ูููุง ุจุชุบูุฑ ูููุฉ $ \theta $:

```python
thetas = np.array([12, 13, 14, 15, 16, 17])
y_vals = np.array([11, 12, 15, 17, 18])
losses = [mse_loss(theta, y_vals) for theta in thetas]

plt.scatter(thetas, losses)
plt.title(r'Loss vs. $ \theta $ when $\bf{y}$$ = [11, 12, 15, 17, 18] $')
plt.xlabel(r'$ \theta $ Values')
plt.ylabel('Loss');
```

<p align='center'>
<img src='{{ site.baseurl }}/img/chapter10/losstotheta.png'>
</p>

ูุฎุทุท ุงููุชููุดูุชููุช ุงูุณุงุจู ูุธูุฑ ุชูุฌู ููุฃุณููุ ุซู ููุฃุนูู ููุง ูุงุญุธูุง ูุณุจูุงู. ูููููุง ุงุณุชุฎุฏุงู ุงููุฒูุฏ ูู ููู $ \theta $ ููุดุงูุฏุฉ ูุงูู ุงูููุญูู ุนูุฏูุง ุชุชุบูุฑ ุงูุฎุณุงุฑุฉ ูููุง ุบูุฑูุง ูููุฉ $ \theta $.

```python
thetas = np.arange(12, 17.1, 0.05)
y_vals = np.array([11, 12, 15, 17, 18])
losses = [mse_loss(theta, y_vals) for theta in thetas]

plt.plot(thetas, losses)
plt.title(r'Loss vs. $ \theta $ when $\bf{y}$$ = [11, 12, 15, 17, 18] $')
plt.xlabel(r'$ \theta $ Values')
plt.ylabel('Loss');
```

<p align='center'>
<img src='{{ site.baseurl }}/img/chapter10/modeling_loss_functions_29_0.png'>
</p>

ุงูุฑุณู ุงูุจูุงูู ุงูุณุงุจู ูุคูุฏ ููุง ุฃู $ \theta = 15 $ ูู ุชูู ุงูุฎูุงุฑ ุงูุฃูุถูุ ุฑูู ู $ \theta $ ุจูู 14 ู 15 ูุงู ูููุฉ ุงูุฎุณุงุฑุฉ ููู ุฃูู. ูููููุง ุงุณุชุฎุฏุงู ุงูุชูุงุถู ูุงูุชูุงูู ูุญุณุงุจ ูููุฉ ุฐูู ุงูุฑูู ุจุงูุถุจุท. ุจูููุฉ ุฎุณุงุฑุฉ ุฃููุ ูุดุชูุฉ ุฏุงูุฉ ุงูุฎุณุงุฑุฉ ูููููุฉ $ \theta $ ุชููู 0.

ูุจุฏุฃ ุฃููุงู ุจุฏุงูุฉ ุงูุฎุณุงุฑุฉ ุงูุชู ุนุฑููุงูุง:

$$ \begin{aligned}
L(\theta, \textbf{y})
&= \frac{1}{n} \sum_{i = 1}^{n}(y_i - \theta)^2\\
\end{aligned} $$

ุซู ูููู ุจุฅุฏุฎุงู ููุงุทูุง $ \textbf{y} = [11, 12, 15, 17, 18] $ ูููุนุงุฏูุฉ:

$$ \begin{aligned}
L(\theta, \textbf{y})
&= \frac{1}{5} \big((11 - \theta)^2 + (12 - \theta)^2 + (15 - \theta)^2 + (17 - \theta)^2 + (18 - \theta)^2 \big)\\
\end{aligned} $$

ูุญุณุงุจ ูููุฉ $ \theta $ ุงูุชู ุชููู ูู ุฏุงูุฉ ุงูุฎุณุงุฑุฉุ ูููู ุจุญุณุงุจ ุงููุดุชูุฉ ู $ \theta $:

$$ \begin{aligned}
\frac{\partial}{\partial \theta} L(\theta, \textbf{y})
&= \frac{1}{5} \big(-2(11 - \theta) - 2(12 - \theta) - 2(15 - \theta) - 2(17 - \theta) -2(18 - \theta) \big)\\
&= \frac{1}{5} \big(10 \cdot \theta - 146 \big)\\
\end{aligned} $$

ุซู ูููู ุจุงูุจุญุซ ุนู ูููุฉ $ \theta $ ุงูุชู ูุดุชูุชููุง ุชุณุงูู ุตูุฑ:

$$ \begin{aligned}
\frac{1}{5} \big(10 \cdot \theta - 146 \big) &= 0 \\
10 \cdot \theta - 146 &= 0 \\
\theta &= 14.6
\end{aligned} $$

ูุฌุฏูุง ูููุฉ $ \theta $ ุงูุฃููุ ูููุง ูู ูุชููุนุ ูุงูุช ุจูู 14 ู 15. ูุฑูุฒ ููููุฉ $ \theta $ ุฐุงุช ุงูุฃูู ุฎุณุงุฑุฉ ุจุงูุฑูุฒ $ \hat{\theta} $. ุงูุขูุ ููุจูุงูุงุช ุงูุชุงููุฉ $ \textbf{y} = [11, 12, 15, 17, 18] $ ู ุฏุงูุฉ ุงูุฎุณุงุฑุฉ MSE:

$$ \hat{\theta} = 14.6 $$

ุฅุฐุง ุญุณุจูุง ูุชูุณุท ุงูุจูุงูุงุช ูุฏููุงุ ููุงุญุธ ุงูุชุงูู:

$$ \text{mean} (\textbf{y}) = \hat{\theta} = 14.6 $$

### ุชูููู ุงูุฎุทุฃ ุงูุชุฑุจูุนู ุงููุชูุณุท

ููุง ูู ูุงุถุญุ ุงููุชูุฌุฉ ุงูุณุงุจูุฉ (ุชุณุงูู ูููุฉ ุงููุชูุณุท ูุน $ \hat{\theta} $ ) ููุณุช ูุฌุฑุฏ ุตุฏููุ ุงููุชูุณุท ูููู ุงูุจูุงูุงุช *ุฏุงุฆูุงู* ูุง ูุณุงูู $ \hat{\theta} $ุ ููููุฉ $ \theta $ ุงูุชู ุชููู ูู ุงูุฎุณุงุฑุฉ ุจุฏุงูุฉ MSE.

ูุนุฑุถ ุฐููุ ูุฃุฎุฐ ูุดุชูุฉ ุฏุงูุฉ ุงูุฎุณุงุฑุฉ ูุฑู ุฃุฎุฑู. ูููู ุจุฏูุงู ูู ุฅุถุงูุฉ ุงูุจูุงูุงุช ุฅูููุงุ ูุจูู ุงูุฑูุฒ $ y_i $ ููุนูููุง ุนูู ุฌููุน ุงูุจูุงูุงุช.

$$ \begin{aligned}
L(\theta, \textbf{y})
&= \frac{1}{n} \sum_{i = 1}^{n}(y_i - \theta)^2\\
\frac{\partial}{\partial \theta} L(\theta, \textbf{y})
&= \frac{1}{n} \sum_{i = 1}^{n} -2(y_i - \theta) \\
&= -\frac{2}{n} \sum_{i = 1}^{n} (y_i - \theta) \\
\end{aligned} $$

ุจูุง ุฃููุง ูู ูุนูุถ ุฃู ูููุฉ ูููุชุบูุฑ $ y_i $ุ ูููู ุฃู ูุณุชุฎุฏู ุงููุนุงุฏูุฉ ุนูู ุฃู ุจูุงูุงุช ุจุฃู ุญุฌู.

ุงูุขูุ ูุนูุถ ูููุฉ ุงููุดุชูุฉ ุจุตูุฑ ููุญุงูู ุฅูุฌุงุฏ $ \theta $ ูุฅูุฌุงุฏ ุฃูู ูููุฉ ูุฏุงูุฉ ุงูุฎุณุงุฑุฉ ููุง ูุนููุง ุณุงุจูุงู:

$$ \begin{aligned}
-\frac{2}{n} \sum_{i = 1}^{n} (y_i - \theta) &= 0 \\
\sum_{i = 1}^{n} (y_i - \theta) &= 0 \\
\sum_{i = 1}^{n} y_i - \sum_{i = 1}^{n} \theta &= 0 \\
\sum_{i = 1}^{n} \theta &= \sum_{i = 1}^{n} y_i \\
n \cdot \theta &= y_1 + \ldots + y_n \\
\theta &= \frac{y_1 + \ldots + y_n}{n} \\
\hat \theta = \theta &= \text{mean} (\textbf{y})
\end{aligned} $$

ููุงุญุธ ููุง ูู ูุงุถุญุ ุฃู ููุงู ูููู ูุงุญุฏุฉ ู $ \theta $ ุงูุชู ุชุนุทู ุฃูู ูููู ู MSE ุฃูุงู ูุงูุช ุงูููู ุฏุงุฎู ุงูุจูุงูุงุช. ููุฎุทุฃ ุงูุชุฑุจูุนู ุงููุชูุณุทุ ูุนูู ุฃู $ \hat{\theta} $ ูู ุฏุงุฆูุงู ุชุณุงูู ุงููุชูุณุท ููุจูุงูุงุช.

### ุงูุนูุฏุฉ ููุจูุงูุงุช ุงูุฃุตููุฉ

ููุณ ุนูููุง ุงุฎุชุจุงุฑ ุฃู ููู ุฃุนูู ู $ \theta $ ููุง ูุนููุง ูุณุจูุงู. ูููููุง ุฅูุฌุงุฏ ูุชูุณุท ุงูุฅูุฑุงููุงุช ููููู:

```python
np.mean(tips['pcttip'])
```

```ruby
16.08025817225047
```

ููุฑุณูู:

```python
sns.distplot(tips['pcttip'], bins=np.arange(30), rug=True)

plt.axvline(x=16.08, c='darkblue', linestyle='--', label=r'$ \hat \theta = 16.08$')
plt.legend()

plt.xlim(0, 30)
plt.title('Distribution of tip percent')
plt.xlabel('Percent Tip Amount')
plt.ylabel('Proportion per Percent');
```

<p align='center'>
<img src='{{ site.baseurl }}/img/chapter10/hist-tipsdistribution.png'>
</p>

### ููุฎุต ุฏุงูุฉ ุงูุฎุณุงุฑุฉ

ูููุง ุจุงูุชุนุฑู ุนูู **ูููุฐุฌ ุซุงุจุช**ุ ูููุฐุฌ ุฏุงุฆูููุง ูุง ููุชุฌ ููุง ููุณ ุงูุฑูู ููู ุจูุงูุงุชูุง.

ู ุชุนุฑููุง ุนูู **ุฏุงูุฉ ุงูุฎุณุงุฑุฉ** $ L(\theta, \textbf{y}) $ ุงูุชู ุชููุณ ูุฏู ููุงุกุฉ ูููู ูุนููุฉ ู $ \theta $ ููุจูุงูุงุช. ูู ูุฐุง ุงูุฌุฒุก ุชุนุฑููุง ุฃูุถุง ุนูู ุฏุงูุฉ ุฎุณุงุฑุฉ ุงูุฎุทุฃ ุงูุชุฑุจูุนู ุงููุชูุณุท ูุฃุธูุฑูุง ุฃู $ \hat{\theta} = \text{mean}(\textbf{y}) $ ูููููุฐุฌ ุงูุซุงุจุช.

ุงูุทุฑููุฉ ุงูุชู ุงุณุชุฎุฏููุงูุง ูู ูุฐุง ุงูุฌุฒุก ูุงูุชู ุชุทุจู ุนูู ุงู ููุน ูู ุงูููุงุฐุฌ:
- ุงุฎุชูุงุฑ ุงููููุฐุฌ.
- ุงุฎุชูุงุฑ ุฏุงูุฉ ุงูุฎุณุงุฑุฉ.
- ุชุฏุฑูุจ ุงููููุฐุฌ ุนู ุทุฑูู ุชูููู ูููุฉ ุงูุฎุณุงุฑุฉ.

ูู ูุฐุง ุงููุชุงุจุ ุฌููุน ุทุฑู ุฅูุดุงุก ุงูููุงุฐุฌ ุชุจุฏุฃ ูุชุชูุณุน ูู ุฃู ูู ูุฐู ุงูููุงุท.

## ุฏุงูุชู ุงูุฎุณุงุฑุฉ Absolute ู Huber

ูุชุฏุฑูุจ ูููุฐุฌุ ูุฎุชุงุฑ ุฏุงูุฉ ุฎุณุงุฑุฉ ููุชุบูุฑุงุช ุงููููุฐุฌ ุงูุชู ุชููู ูู ุงูุฎุณุงุฑุฉ. ูู ุงูุฌุฒุก ุงูุณุงุจูุ ุชุนุฑููุง ุนูู ุฏุงูุฉ ุงูุฎุณุงุฑุฉ MSE:

$$ \begin{aligned}
L(\theta, \textbf{y})
&= \frac{1}{n} \sum_{i = 1}^{n}(y_i - \theta)^2\\
\end{aligned} $$

ุงุณุชุฎุฏููุง ูููุฐุฌ ุซุงุจุช ูุชููุน ููุณ ุงูุฑูู $ \theta $ ูุฌููุน ุงูุจูุงูุงุช. ุนูุฏูุง ุฏุฑุจูุง ุงููููุฐุฌ ุจุงุณุชุฎุฏุงู ุฏุงูุฉ ุงูุฎุณุงุฑุฉ MSEุ ูุฌุฏูุง ุฃู $ \hat{\theta} = \text{mean} (\textbf{y}) $. ูู ุจูุงูุงุช ุงูุฅูุฑุงููุงุชุ ูุฌุฏูุง ุฃู ุงููููุฐุฌ ูุชููุน 16.8% ููููุง ูู ูุชูุณุท ูุณุจ ุงูุฅูุฑุงููุงุช.

ูู ูุฐุง ุงูุฌุฒุกุ ุณูุชุนุฑู ุนูู ุฏุงูุชูู ุฎุณุงุฑุฉ ููุง **ูุชูุณุท ุงูุฎุทุฃ ุงูุญุชูู Mean Absolute Error (MAE)** ู **ููุจุฑ Huber**.

### ูุชูุณุท ุงูุฎุทุฃ ุงูุญุชูู

ุงูุขูุ ุณูุจูู ุงููููุฐุฌ ููุง ูู ููู ุณูุบูุฑ ุฏุงูุฉ ุงูุฎุณุงุฑุฉ. ุจุฏูุงู ูู ุฃุฎุฐ ุงููุฑู ุงูุชุฑุจูุนู ุจูู ูู ููุทุฉ ูุชููุนูุงุ ูุฐู ุงูุฏุงูุฉ ุชุฃุฎุฐ ุงููุฑู ุงูุญุชูู:

$$ \begin{aligned}
L(\theta, \textbf{y})
&= \frac{1}{n} \sum_{i = 1}^{n} |y_i - \theta| \\
\end{aligned} $$

#### ููุงุฑูุฉ ุจูู MSE ู MAE

> ูุนุฑู ุงููุงุชุจ ุฃููุงู ุฏูุงู ุณูุณุชุฎุฏููุง ููููุงุฑูุฉ ุจูู MSE ู MAE. ูุนุฑูุฉ ูุนูู ุงูููุฏ ุงูุจุฑูุฌู ููุง ูุง ููู.

```python
tips = sns.load_dataset('tips')
tips['pcttip'] = tips['tip'] / tips['total_bill'] * 100

def mse_loss(theta, y_vals):
    return np.mean((y_vals - theta) ** 2)

def abs_loss(theta, y_vals):
    return np.mean(np.abs(y_vals - theta))

def compare_mse_abs(thetas, y_vals, xlims, figsize=(10, 7), cols=3):
    if not isinstance(y_vals, np.ndarray):
        y_vals = np.array(y_vals)
    rows = int(np.ceil(len(thetas) / cols))
    plt.figure(figsize=figsize)
    for i, theta in enumerate(thetas):
        ax = plt.subplot(rows, cols, i + 1)
        sns.rugplot(y_vals, height=0.1, ax=ax)
        plt.axvline(theta, linestyle='--',
                    label=rf'$ \theta = {theta} $')
        plt.title(f'MSE = {mse_loss(theta, y_vals):.2f}\n'
                  f'MAE = {abs_loss(theta, y_vals):.2f}')
        plt.xlim(*xlims)
        plt.yticks([])
        plt.legend()
    plt.tight_layout()
```

```python
compare_mse_abs(thetas=[11, 12, 13, 14, 15, 16],
                y_vals=[14], xlims=(10, 17))
```

<p align='center'>
<img src='{{ site.baseurl }}/img/chapter10/compare-msemae.png'>
</p>

ููุงุญุธ ุฃู MSE ุนุงุฏุฉ ูุง ุชููู ุฃุนูู ูู MAE ููู ุฏุงูุฉ ุงูุฎุณุงุฑุฉ ูููุง ุชุฑุจูุนูุฉ. ููุฑู ูุง ูุญุฏุซ ุนูุฏูุง ูููู ูุฏููุง ุงูุฎูุณ ููุงุท ุงูุชุงููุฉ: $ \textbf{y} = [ 12.1, 12.8, 14.9, 16.3, 17.2 ] $

<p align='center'>
<img src='{{ site.baseurl }}/img/chapter10/compare-msemae5points.png'>
</p>

ุชุฐูุฑ ุฃู ูุชูุฌุฉ ุฏุงูุฉ ุงูุฎุณุงุฑุฉ ูุง ุชูููุง ูุซูุฑุงูุ ููู ุชูููุง ููุท ุจููุงุฑูุฉ ุงููููุฉ ุงููุฎุชููุฉ ู $ \theta $. ุนูุฏูุง ูุฎุชุงุฑ ุฏุงูุฉ ุฎุณุงุฑุฉุ ุณูุจุญุซ ุนู $ \hat{\theta} $ุ ูููุฉ $ \theta $ ุงูุชู ูุฏููุง ุฃูู ูููู ููุฎุณุงุฑุฉ. ูุฐุงุ ูุญู ููุชู ูุง ุฐุง ูุงูุช ุฏุงูุฉ ุงูุฎุณุงุฑุฉ ุชูุชุฌ ูุชุงุฆุฌ ูุฎุชููุฉ ู $ \hat{\theta} $.

ุญุชู ุงูุขูุ ููุง ุฏุงูุชู ุงูุฎุณุงุฑุฉ ูุชููุชุงู ุนูู $ \hat{\theta} $. ูู ูุงุญุธูุงุ ุณูุฑู ุจุนุถ ุงูุงุฎุชูุงูุงุช. ููุฑุณู ูุชุงุฆุฌ ุงูุฎุณุงุฑุฉ ูุน $ \theta $ ููู ูููู ูุฏููุง:

```python
thetas = np.array([12, 13, 14, 15, 16, 17])
y_vals = np.array([12.1, 12.8, 14.9, 16.3, 17.2])
mse_losses = [mse_loss(theta, y_vals) for theta in thetas]
abs_losses = [abs_loss(theta, y_vals) for theta in thetas]

plt.scatter(thetas, mse_losses, label='MSE')
plt.scatter(thetas, abs_losses, label='MAE')
plt.title(r'Loss vs. $ \theta $ when $ \bf{y}$$= [ 12.1, 12.8, 14.9, 16.3, 17.2 ] $')
plt.xlabel(r'$ \theta $ Values')
plt.ylabel('Loss')
plt.legend();
```

<p align='center'>
<img src='{{ site.baseurl }}/img/chapter10/compare-msemaetheta.png'>
</p>

ุซูุ ูุณุชุฎุฏู ููู ุฃูุซุฑ ู $ \theta $ ููููู ุงูููุญูู ุฃูุซุฑ ุณูุงุณุฉ:

```python
thetas = np.arange(12, 17.1, 0.05)
y_vals = np.array([12.1, 12.8, 14.9, 16.3, 17.2])
mse_losses = [mse_loss(theta, y_vals) for theta in thetas]
abs_losses = [abs_loss(theta, y_vals) for theta in thetas]

plt.plot(thetas, mse_losses, label='MSE')
plt.plot(thetas, abs_losses, label='MAE')
plt.title(r'Loss vs. $ \theta $ when $ \bf{y}$$ = [ 12.1, 12.8, 14.9, 16.3, 17.2 ] $')
plt.xlabel(r'$ \theta $ Values')
plt.ylabel('Loss')
plt.legend();
```

<p align='center'>
<img src='{{ site.baseurl }}/img/chapter10/compare-msemaethetasmooth.png'>
</p>

ุซูุ ููุฑุจ ุงูุฑุณู ุงูุจูุงูู ุฅูู ุงูููู ุจูู 1.5 ู 5 ุนูู ุงููุญูุฑ y ููุฑู ุงููุฑู ุนูู ุงูููู ุงูุฏููุง ุจุดูู ุฃูุถุญ. ุญุฏุซูุง ุงูููู ุงูุฏููุง ุจุฎุทูุท ูููููููุทูุฉ:

```python
thetas = np.arange(12, 17.1, 0.05)
y_vals = np.array([12.1, 12.8, 14.9, 16.3, 17.2])
mse_losses = [mse_loss(theta, y_vals) for theta in thetas]
abs_losses = [abs_loss(theta, y_vals) for theta in thetas]

plt.figure(figsize=(7, 5))
plt.plot(thetas, mse_losses, label='MSE')
plt.plot(thetas, abs_losses, label='MAE')
plt.axvline(np.mean(y_vals), c=sns.color_palette()[0], linestyle='--',
            alpha=0.7, label='Minimum MSE')
plt.axvline(np.median(y_vals), c=sns.color_palette()[1], linestyle='--',
            alpha=0.7, label='Minimum MAE')


plt.title(r'Loss vs. $ \theta $ when $ \bf{y}$$ = [ 12.1, 12.8, 14.9, 16.3, 17.2 ] $')
plt.xlabel(r'$ \theta $ Values')
plt.ylabel('Loss')
plt.ylim(1.5, 5)
plt.legend()
plt.tight_layout();
```

<p align='center'>
<img src='{{ site.baseurl }}/img/chapter10/compare-msemaethetaminima.png'>
</p>

ูุฌุฏูุง ุจุนุฏ ุชุฌุฑุจุชูุง ุฃู MSE ู MAE ูุฏ ููุชุฌ ุนูููุง ููู ูุฎุชููุฉ ู $ \hat{\theta} $ ูููุณ ุงูุจูุงูุงุช. ุชุญููู ุฃูุซุฑ ุฏูู ุฃูุถุญ ููุง ูุชู ูููู ุงูุงุฎุชูุงูุ ูุณุจุจู.

### ุงูููู ุงูุดุงุฐุฉ

ุฃุญุฏ ุงูุงุฎุชูุงูุงุช ุงูุชู ููุงุญุธูุง ูู ุงูุฑุณู ุงูุจูุงูู ุงูุณุงุจู ููููุฉ ุงูุฎุณุงุฑุฉ ู $ \theta $ ูู ุดูู ููุญูู ุงูุฎุณุงุฑุฉ. ุฑุณู MSE ุฃูุชุฌ ููุง ููุญูู ูุทุนู ูููุงูุฆ. [๐][ParabolaEN]

ุจูููุง ุฑุณู MAE ุฃูุชุฌ ููุง ููุง ูุจุฏู ููุฃููุง ุฎุทูุท ูุชุตูุฉ ุจุจุนุถูุง. ูุฐุง ูุจุฏู ูููููุงู ุฅุฐุง ูุง ุฃุฎุฐูุง ุจุงูุงุนุชุจุงุฑ ุฃู ุฏุงูุฉ ุงููููุฉ ุงูุญุชููุฉ ูู ุฎุทููุ ูุฐุง ุฃุฎุฐ ุงููุชูุณุท ูููุซูุฑ ูู ุงูุฏูุงู ุงูุญุชููุฉ ุณูุธูุฑ ููุง ููุงุชุฌ ุดุจู ุฎุทูู.

ุจูุง ุฃู MSE ุชุนุชูุฏ ุนูู ุงูุฎุทุฃ ุงูุชุฑุจูุนูุ ุณุชุชุฃุซุฑ ุฃูุซุฑ ุจุงูููู ุงูุดุงุฐุฉ. ุฅุฐุง ูุงูุช $ \theta = 10 $ ูุงุญุฏ ุงูููุงุท ูุงูุช 110ุ ูููุฉ ุงูุฎุทุฃ ูู MSE ููุฐู ุงููููุฉ ุณุชููู 
$ (10 - 110)^2 = 10000 $ ุจูููุง ูู MAEุ ุณุชููู $ |10 - 110| = 100 $. ูููููุง ุฑุณู ุฐูู ุนู ุทุฑูู ุฃุฎุฐ ูุตูููุฉ ูู ุซูุงุซ ููุงุท $ \textbf{y} = [ 12, 13, 14 ] $ ูุงูููุงุฑูุฉ ุจูู ููุญููุง ุงูุฎุณุงุฑุฉ ู $ \theta $ ู MSE ู MAE.

```python
# ุฏุงูุฉ ุชู ูุชุงุจุชูุง ูุชุณุงุนุฏ ุนูู ุงูุฌุงุฏ ุงููุชุงุฆุฌ ูุฑุณู ุงูููุงุฑูุฉ
# ูุง ุชุญุชุงุฌ ููุดุฑุญ
def compare_mse_abs_curves(y3=14):
    thetas = np.arange(11.5, 26.5, 0.1)
    y_vals = np.array([12, 13, y3])
    
    mse_losses = [mse_loss(theta, y_vals) for theta in thetas]
    abs_losses = [abs_loss(theta, y_vals) for theta in thetas]
    mse_abs_diff = min(mse_losses) - min(abs_losses)
    mse_losses = [loss - mse_abs_diff for loss in mse_losses]
    
    plt.figure(figsize=(9, 2))
    
    ax = plt.subplot(121)
    sns.rugplot(y_vals, height=0.3, ax=ax)
    plt.xlim(11.5, 26.5)
    plt.xlabel('Points')
    
    ax = plt.subplot(122)
    plt.plot(thetas, mse_losses, label='MSE')
    plt.plot(thetas, abs_losses, label='MAE')
    plt.xlim(11.5, 26.5)
    plt.ylim(min(abs_losses) - 1, min(abs_losses) + 10)
    plt.xlabel(r'$ \theta $')
    plt.ylabel('Loss')
    plt.legend()


interact(compare_mse_abs_curves, y3=(14, 25));
```

> ููุง ุดุฑุญุช ุณุงุจูุงู ุนูู ุงูุฏูุงู ุงูุชูุงุนููุฉ ุงูุชู ูุงู ุจุชุนุฑูููุง ุงููุงุชุจุ ูุฐู ูุซุงู ุขุฎุฑ ููุง ุญูุซ ูุชุญูู ุงูุฑุณู ุงูุชูุงุนูู ุจูููุฉ ุงููุชุบูุฑ ุงูุฃุฎูุฑ $ y_3 $ ููุงุญุธ ุชุบูุฑ ุงูุฑุณู ูููุง ูุจุฑุช ูููุฉ ุงููุชุบูุฑ ูู 14 ุฅูู 25.

<p align='center'>
<img src='{{ site.baseurl }}/img/chapter10/compare-outlier.gif'>
</p>

ููุงุญุธ ุงูุชุบููุฑ ูู ุงูููุญูู ุนูุฏูุง ุชููู $ y_3 = 14 $ ู $ y_3 = 25 $

<p align='center'>
<img src='{{ site.baseurl }}/img/chapter10/compare-y3-14.png'>
</p>

<p align='center'>
<img src='{{ site.baseurl }}/img/chapter10/compare-y3-25.png'>
</p>

ูููุง ุฃุจุนุฏูุง ุงูููุทุฉ $ y_3 $ ุนู ุจููุฉ ุงูุจูุงูุงุชุ ูุชุญุฑู ููุญูู MSE ูุนู. ุนูุฏูุง ุชููู $ y_3 = 14 $ ูุฅู $ \hat{\theta} = 13 $ ูู MSE ู MAE. ูููู ุนูุฏูุง ุชููู $ y_3 = 25 $ ูุฅู ุฎุณุงุฑุฉ MSE ุชููู $ \hat{\theta} = 16.7 $ ู MAE $ \hat{\theta} = 13 $ุ ุจุฏูู ุชุบููุฑ ููุง ูุงูุช ููุณุจูุงู.

### ุชูููู ูุชูุณุท ุงูุฎุทุฃ ุงูุญุชูู

ุงูุขู ุจุนุฏ ุฃู ุชุนุฑููุง ุนูู ุงููููู ูู ุงููุฑููุงุช ุจูู MSE ู MAEุ ูููููุง ุชูููู ุฎุณุงุฑุฉ MAE ููุฌุนู ุงููุฑู ุจููููุง ุฃูุซุฑ ูุถูุญุงู. ููุง ูุนููุง ูุณุจูุงูุ ุณูุฃุฎุฐ ูุดุชูุฉ ุฏุงูุฉ ุงูุฎุณุงุฑุฉ ู $ \theta $ ููุฌุนููุง ุชุณุงูู ุตูุฑ.

ููููุ ุงููุฑุฉุ ูุฌุจ ุฃู ูุชุนุงูู ูุน ุงุญุชูุงููุฉ ุฃู ุงูุฏุงูุฉ ุงูุญุชููุฉ ููุณุช ุฏุงุฆูุงู ูุงุจูู ููุงุดุชูุงู. ุนูุฏูุง ุชููู $ x > 0 $ ูุฅู $ \frac{\partial}{\partial x} \|x\| = 1 $. ุนูุฏูุง ุชููู $ x < 0 $ ูุฅู $ \frac{\partial}{\partial x} \|x\| = -1 $. ุนูู ุงูุฑุบู ุงู $ \|x\| $ ููุณุช ูุงุจูู ููุงุดุชูุงู ุนูุฏูุง ุชููู $ x = 0 $ุ ุณูุฌุนู $ \frac{\partial}{\partial x} \|x\| = 0 $ ูุชููู ุงููุนุงุฏูุฉ ุณููู ููุชุนุงูู.

ููุชุฐูุฑ ุฃู ูุนุงุฏูุฉ MAE ูู:

$$ \begin{aligned}
L(\theta, \textbf{y})
&= \frac{1}{n} \sum_{i = 1}^{n}|y_i - \theta|\\
&= \frac{1}{n} \left( \sum_{y_i < \theta}|y_i - \theta| + \sum_{y_i = \theta}|y_i - \theta| + \sum_{y_i > \theta}|y_i - \theta| \right)\\
\end{aligned} $$

ูู ุงูุฌุฒุก ุงูุฃุฎูุฑ ูุตููุง ุงูุฌูุน ุฅูู ุซูุงุซุฉ ุฃุดูุงู: ูุงุญุฏ ุนูุฏูุง ุชููู $ y_i < \theta $ ู ุฃุฎุฑู ุนูุฏ $ y_i = \theta $ ูุฃุฎูุฑู ุนูุฏูุง ูููู ูุฏููุง $ y_i > \theta $. ููุงุฐุง ูุฌุนู ุนูููุฉ ุงูุฌูุน ูุนูุฏุฉ ุจูุฐุง ุงูุดููุ ุฅุฐุง ุนูููุง ุฃู $ y_i < \theta $ ูุฅููุง ูุนูู ุฃู $ \|y_i - \theta\| < 0 $ ููุฐูู ูุฅู $ \frac{\partial}{\partial \theta} \|y_i - \theta\| = -1 $ ููุง ูู ุงูุณุงุจู. ูููุทุจู ููุณ ุงูููุทู ุนูู ุฌููุน ุงููุตุทูุญุงุช ุงูุณุงุจู ุฐูุฑูุง ููููู ุฃุฎุฐ ุงููุดุชูุงุช ุฃูุซุฑ ุณูููู.

ุงูุขูุ ูุฃุฎุฐ ุงููุดุชูุฉ ุจุงููุณุจุฉ ู $ \theta $ ููุฌุนููุง ุชุณุงูู ุตูุฑ:

$$
\begin{aligned}
\frac{1}{n} \left( \sum_{y_i < \theta}(-1) + \sum_{y_i = \theta}(0) + \sum_{y_i > \theta}(1) \right) &= 0 \\
\sum_{y_i < \theta}(-1) + \sum_{y_i > \theta}(1) &= 0 \\
-\sum_{y_i < \theta}(1) + \sum_{y_i > \theta}(1) &= 0 \\
\sum_{y_i < \theta}(1) &= \sum_{y_i > \theta}(1) \\
\end{aligned}
$$

ูุงุฐุง ุชุนูู ุงููุชูุฌุฉ ูู ุงูุฃุนููุ ุนูู ุงููุณุงุฑุ ูุฏููุง ูููู ูุงุญุฏุฉ ููู ููุทุฉ ุฃูู ูู $ \theta $. ูุนูู ุงูููููุ ูุฏููุง ูููู ูุงุญุฏุฉ ุฃูุถุงู ููู ููุทุฉ ุฃุนูู ูู $ \theta $. ุงูุขูุ ูุชููู ุงููุนุงุฏูุฉ ุตุญูุญูุ ูุญุชุงุฌ ุฃู ูุฎุชุงุฑ ูููู ู $ \theta $ ูุฏููุง ููุณ ุงูุฑูู ูููุทุฉ ุฃูู ูุฃุนูู. ูุฐุง ูู ุชุนุฑูู *ุงููุณูุท Median* ููุฌููุนู ูู ุงูุฃุฑูุงู. ูุฐุงุ ุงููููุฉ ุงูุฃูู ู $ \theta $ ูู MAE ูู $ \hat \theta = \text{median} (\textbf{y}) $.

ุนูุฏูุง ูููู ูุฏููุง ุนุฏุฏ ูุฑุฏู ูู ุงูููุงุทุ ุงููุณูุท ูู ุจุจุณุงุทู ุงูููุทุฉ ูู ุงููุณุท ุจุนุฏ ุชุฑุชูุจ ุงูููุงุท. ูููู ุฃู ูุฑู ูุซุงู ุนูู ุฐุงู  ูู ุฎูุณ ููุงุทุ ูุชู ุชูููู ุงูุฎุณุงุฑุฉ ุนูุฏูุง ุชููู $ \theta $ ูู ุงููุณูุท:

```python
# ูุฑู ุงุฎุฑูุ ุงููุงุชุจ ุนุฑู ุฏุงูุฉ ุชุณุงุนุฏู ุนูู ุงูุญุณุงุจ ูุงูุฑุณู
# ูุง ุชุญุชุงุฌ ููุนุฑูู ูุนูู ุงูููุฏ ุงูุจุฑูุฌู
def points_and_loss(y_vals, xlim, loss_fn=abs_loss):
    thetas = np.arange(xlim[0], xlim[1] + 0.01, 0.05)
    abs_losses = [loss_fn(theta, y_vals) for theta in thetas]
    
    plt.figure(figsize=(9, 2))
    
    ax = plt.subplot(121)
    sns.rugplot(y_vals, height=0.3, ax=ax)
    plt.xlim(*xlim)
    plt.xlabel('Points')
    
    ax = plt.subplot(122)
    plt.plot(thetas, abs_losses)
    plt.xlim(*xlim)
    plt.xlabel(r'$ \theta $')
    plt.ylabel('Loss')

points_and_loss(np.array([10, 11, 12, 14, 15]), (9, 16))
```

<p align='center'>
<img src='{{ site.baseurl }}/img/chapter10/mae-median-odd.png'>
</p>

ููููุ ุนูุฏูุง ูููู ูุฏููุง ุนุฏุฏ ุฒูุฌู ูู ุงูุฃุฑูุงูุ ุชููููููู ุงูุฎุณุงุฑุฉ ุนูุฏูุง ุชููู $ \theta $ ูู ุงููููุฉ ุงูุชู ุจูู ุงูููุทุชูู ูู ุงููุณุท. ูุซุงู:

```python
points_and_loss(np.array([10, 11, 14, 15]), (9, 16))
```

<p align='center'>
<img src='{{ site.baseurl }}/img/chapter10/mae-median-even.png'>
</p>

ููุง ูุทุจู ุฐูู ุนูุฏูุง ูุณุชุฎุฏู MSE:

```python
points_and_loss(np.array([10, 11, 14, 15]), (9, 16), mse_loss)
```

<p align='center'>
<img src='{{ site.baseurl }}/img/chapter10/mse-loss.png'>
</p>

### ููุงุฑูุฉ MSE ู MAE

ุชุญููููุง ูุงููุดุชูุงุช ูู ุงูุฃุนูู ุชูุธูุฑ ููุง MSE ุฃุณูู ููุงุณุชุฎุฏุงู ูุฅูุฌุงุฏ ุงูุงุดุชูุงู ููููุง ุชุชุฃุซุฑ ุดูู ูุจูุฑ ูู ุงูุจูุงูุงุช ุงูุดุงุฐุฉ ุนูู ุนูุณ MAE. ุจุงููุณุจุฉ ู MSEุ ูุฅู $ \hat{\theta} = \text{mean}(\textbf{y}) $ุ ูู MAE ูุฅู $ \hat{\theta} = \text{median}(\textbf{y}) $. ูุงุญุธ ุฃู ุงููุณูุท ุฃูู ุชุฃุซุฑุงู ุจุงูููู ุงูุดุงุฐุฉ ุนู ุงููุชูุณุท. ุธูุฑ ููุง ุฐูู ุฃุซูุงุก ุชุนุฑูู ูุจูุงุก ุฏุงูุชู ุงูุฎุณุงุฑุฉ MSE ู MAE.

ุฑุฃููุง ุฃูุถุงู ุฃู MSE ูุฏููุง $ \hat{\theta} $ ูุฎุชููุฉุ ูููุง ุงููุชูุณุท ุงูุญุชูู ูููู ุฃู ูููู ุฃูุซุฑ ุงุญุชูุงู ูู $ \hat{\theta} $ ุนูุฏูุง ูููู ุนุฏุฏ ุงูููุงุท ูู ุงูุจูุงูุงุช ุฒูุฌู.

#### ุฏุงูุฉ ุงูุฎุณุงุฑุฉ Huber

ุฏุงูุฉ ุงูุฎุณุงุฑุฉ ุงูุซุงูุซุฉ ูุทูู ุนูููุง ุฏุงูุฉ Huber ูุงูุชู ุชุฌูุน ุจูู MSE ู MAE ูุชููู ููุง ุฏุงูุฉ ุฎุณุงุฑุฉ ูุงุจูู ููุงุดุชูุงู ููุง ุชุชุฃุซุฑ ุจุงูููู ุงูุดุงุฐุฉ. ุชูุนู ุฐูู ุฏุงูุฉ Huber ุนู ุทุฑูู ุงูุนูู ููุฃููุง ุฏุงูุฉ MSE ูููู $ \theta $ ุนูุฏูุง ุชููู ูุฑูุจู ูู ุงูููู ุงูุฏููุง ูุงูุชุบููุฑ ุฅูู MAE ุนูุฏูุง ุชููู ููู $ \theta $ ุจุนูุฏุฉ ุนู ุงูููู ุงูุฏููุง.

ููุง ูู ุงูุบุงูุจุ ููุดุฃ ุฏุงูุฉ ุฎุณุงุฑุฉ ุนู ุทุฑูู ุฃุฎุฐ ุงููุชูุณุท ููู ุฎุณุงุฑุฉ Huber ููู ููุทุฉ ูู ุจูุงูุงุชูุง.

ููุฑู ูุชูุฌุฉ ุฏุงูุฉ ุงูุฎุณุงุฑุฉ Hurber ุนูุฏูุง ุชููู ุจูุงูุงุชูุง ุนุจุงุฑุฉ ุนู $ \textbf{y} = [14] $ ูุน ููู ูุฎุชููุฉ ู $ \theta $:

```python
def huber_loss(est, y_obs, alpha = 1):
    d = np.abs(est - y_obs)
    return np.where(d < alpha, 
                    (est - y_obs)**2 / 2.0,
                    alpha * (d - alpha / 2.0))

thetas = np.linspace(0, 50, 200)
loss = huber_loss(thetas, np.array([14]), alpha=5)
plt.plot(thetas, loss, label="Huber Loss")
plt.vlines(np.array([14]), -20, -5,colors="r", label="Observation")
plt.xlabel(r"Choice for $\theta$")
plt.ylabel(r"Loss")
plt.legend()
plt.savefig('huber_loss.pdf')
```

<p align='center'>
<img src='{{ site.baseurl }}/img/chapter10/huber-loss14.png'>
</p>

ููุงุญุธ ุฃู ุฎุท ุฏุงูุฉ ุงูุฎุณุงุฑุฉ Huber ุณูุณุ ุนูู ุนูุณ MAE. ุฃูุถุง ุชุฒุฏุงุฏ ุฎุณุงุฑุฉ Huber ุจูุนุฏู ุฎุทูุ ุนูู ุนูุณ ุงููุนุฏู ุงูุชุฑุจูุนู ููุชูุณุท ุงูุฎุณุงุฑุฉ ุงูุชุฑุจูุนูุฉ.

ูููู ูุฏู ุฏุงูุฉ ุฎุณุงุฑุฉ Huber ุนูุจ. ูุงุญุธ ุฃููุง ุชุบูุฑุช ูู MSE ุฅูู MAE ุนูุฏูุง ูุงูุช $ \theta $ ุฃุจุนุฏ ุนู ุงูููุงุท. ูููููุง ุงูุชุญูู ุจูุฏู ุงูุจุนุฏ ููุญุตูู ุนูู ููุญููุงุช ุฎุณุงุฑุฉ ุฃุฎุฑู. ูุซูุงูุ ูููููุง ุฃู ูุฌุนููุง ุชุจุฏุฃ ุจุงูุชุบููุฑ ุนูุฏูุง ุชููู $ \theta $ ุฃูุฑุจ ุจููุทุฉ ุนู ุงููููุฉ ุงูุฏููุง:

```python
loss = huber_loss(thetas, np.array([14]), alpha=1)
plt.plot(thetas, loss, label="Huber Loss")
plt.vlines(np.array([14]), -20, -5,colors="r", label="Observation")
plt.xlabel(r"Choice for $\theta$")
plt.ylabel(r"Loss")
plt.legend()
plt.savefig('huber_loss.pdf')
```

<p align='center'>
<img src='{{ site.baseurl }}/img/chapter10/huber-loss14-withparameter1.png'>
</p>

ุฃู ูููููุง ุชุบูุฑ ุฐูู ูุฌุนููุง ุชุชุบูุฑ ุนูุฏูุง ุชููู $ \theta $ ุนูู ุจุนุฏ ุนุดุฑ ููุงุท ูู ุงููููุฉ ุงูุฏููุง:

```python
loss = huber_loss(thetas, np.array([14]), alpha=10)
plt.plot(thetas, loss, label="Huber Loss")
plt.vlines(np.array([14]), -20, -5,colors="r", label="Observation")
plt.xlabel(r"Choice for $\theta$")
plt.ylabel(r"Loss")
plt.legend()
plt.savefig('huber_loss.pdf')
```

<p align='center'>
<img src='{{ site.baseurl }}/img/chapter10/huber-loss14-withparameter10.png'>
</p>

ุงูุฎูุงุฑ ููุง ูููู ููุง ููุญูู ูุฎุชูู ูุฎุท ุงูุฎุณุงุฑุฉ ููุง ููุชุฌ ููุง ุฃูุถุง ููู ูุฎุชููุฉ ู $ \hat \theta $. ุฅุฐุง ุฃุฑุฏูุง ุงุณุชุฎุฏุงู ุฏุงูุฉ ุงูุฎุณุงุฑุฉ Huberุ ูุฏููุง ูููุฉ ุฃุฎุฑู ููู ุชุญุฏูุฏ ููุทุฉ ุงูุชุบููุฑ ูุฌุนููุง ูููู ููุงุณุจุฉ.

ูููููุง ุชุนุฑูู ุฏุงูุฉ Huber ุฑูุงุถูุงู ูุงูุชุงูู:

$$
L_\alpha(\theta, \textbf{y}) = \frac{1}{n} \sum_{i=1}^n \begin{cases}
    \frac{1}{2}(y_i - \theta)^2 &  | y_i - \theta | \le \alpha \\
    \alpha ( |y_i - \theta| - \frac{1}{2}\alpha ) & \text{otherwise}
\end{cases}
$$

ูู ุฃูุซุฑ ุชุนููุฏุงู ูู ุฏูุงู ุงูุฎุณุงุฑุฉ ุงูุณุงุจูุฉ ูุฃููุง ุชุฌูุน ุจูู MSE ู MAE. ุงููุชุบูุฑ ุงูุฅุถุงูู $ \alpha $ ูุญุฏุฏ ููุงู ููุทุฉ ุงูุชุบููุฑ ูู ุฏุงูุฉ Huber ูู MSE ุฅูู MAE.

ูุญุงููุฉ ุฅูุฌุงุฏ ููุดุชูุฉ ุฏุงูุฉ Huber ุนูููุฉ ูููุฉ ููุง ุชูุชุฌ ูุชุงุฆุฌ ูุงุถุญุฉ ููููููู ููุง ูู MSE ู MAE. ุจุฏูุงู ูู ุฐููุ ูููููุง ุงุณุชุฎุฏุงู ุงูุนูููุฉ ุงูุญุณุงุจูุฉ ุงููุณูุงุฉ ุงููุฒูู ุงูุงุดุชูุงูู ูุฅูุฌุงุฏ ุงููููุฉ ุงูุฃูู ู $ \theta $.

### ููุฎุต ุฏุงูุชู ุงูุฎุณุงุฑุฉ Absolute ู Huber

ูู ูุฐุง ุงูุฌุฒุกุ ุชุนุฑููุง ุนูู ุฏุงูุชู ุฎุณุงุฑุฉ: ูุชูุณุท ุงูุฎุทุฃ ุงูุญุชูู ู ุฏุงูุฉ Huber. ููุฌุฏูุง ุฃู ููููุฐุฌ ุซุงุจุช ุจุงุณุชุฎุฏุงู MAE ูุฅู $ \hat{\theta} = \text{median}(\textbf{y}) $.

[PopulationParameterEN]: https://www.youtube.com/watch?v=vikkiwjQqfU
[PopulationParameterAR]: https://www.youtube.com/watch?v=KabwGtDbNUs
[ParabolaEN]: https://www.mathsisfun.com/geometry/parabola.html