---
title: المقايضة بين الإنحياز والتباين
show_title: true
chapter_number: 15
chapter_text: الفصل الخامس عشر
chapter_lessons: [[0, 'مقدمة'], [1, 'تقليل المخاطر والخسائر'], [2, 'إنحياز وتبيان النموذج'], [3, 'التحقق المتقاطع']]
chapter_sublessons: [
    [],
    ['المخاطر', 'الخطر التجريبي', 'ملخص المخاطر'],
    ['تحليل الإنحياز والتباين', 'مشتقة تحليل الإنحياز والتبيان', 'مثال: الإنحدار الخطي وموجات الجيب', 'التطبيق العملي للإنحياز والتباين', 'النقاط الأساسية', 'ملخص إنحياز وتبيان النموذج'],
    [['تقسيم بيانات التدريب والتحقق والإختبار', 'حجم تقسيم بيانات التدريب والتحقق والإختبار'],'خطأ التدريب و خطأ الإختبار', 'التحقق المتقاطع K-Flod', 'مقايضة الإنحياز والتباين', 'مثال: اختيار النموذج لبيانات تقييم الآيس كريم', 'ملخص التحقق المتقاطع']
]
layout: default
---

## مقدمة

في بعض الأحيان، نختار نموذج بسيط جداً ليمثل البيانات. وفي بعض المرات، نختار نموذجاً معقد، بسبب ضبطنا على الضوضاء في البيانات بدلاً من البيانات نفسها.

لفهم سبب قيامنا بذلك، نقوم بتحليل النموذج بإستخدام أدوات الإحتمالات والإحصاء. هذه الأدوات تسمح لنا بالتعميم من أمثله بسيطة محدودة حتى وصف المهام الأساسية في النمذجة. بشكل خاص، سنستخدم **التوقع Expectation** و **التباين Variance**  لعرض وفهم المقايضة بين الإنحياز والتباين.

## تقليل المخاطر والخسائر

للقيام بالتوقع بإستخدام البيانات، نقوم بتعريف نموذج، إختيار دالة خساره لجميع البيانات، وضبط النموذج مع المتغيرات عن طريق تقليل الخساره. مثلاً،  للقيام بالإنحدار الخطي للمربعات الصغرى، نختار النموذج:

$$ \begin{aligned}
f_\hat{\theta} (x) &= \hat{\theta} \cdot x
\end{aligned} $$

ودالة الخساره:

$$ \begin{split}
\begin{aligned}
L(\hat{\theta}, X, y)
&= \frac{1}{n} \sum_{i}(y_i - f_\hat{\theta} (X_i))^2\\
\end{aligned}
\end{split} $$

كما فعلنا مسبقاً، نستخدم $ \hat{\theta} $ كمصفوفة لمتغيرات النموذج، و $ x $ متّجه تحتوي على سطر من مصفوفة البيانات $ X $، و $ y $ هي مصفوفة للبيانات التي تعلم عليها لتساعد على التوقع. $ X_i $ هي السطر $ i $ من المصفوفة $ X $ و $ y_i $ هي النتيجة رقم $ i $ في المصفوفة $ y $.

لاحظ أن الخساره لكامل البيانات هي متوسط نتائج دالة الخساره لكل سطر فيها. إذا قمنا بتعريف دالة الخسارة التربيعيه:

$$ \begin{aligned}
\ell(y_i, f_\hat{\theta} (x))
&= (y_i - f_\hat{\theta} (x))^2
\end{aligned} $$

إذاً، يمكننا إعادة كتابة متوسط الخساره بشكل أبسط:

$$ \begin{aligned}
L(\hat{\theta}, X, y)
&= \frac{1}{n} \sum_{i} \ell(y_i, f_\hat{\theta} (X_i))
\end{aligned} $$

التعريف في الأعلى يختصر فكرة دالة الخساره؛ إياً كانت دالة الخساره التي نستخدمها، خسارتنا لكامل البيانات هي متوسط الخساره.

بالتقليل من متوسط الخساره، نختار متغيرات النموذج التي تضبطه بناءاً على البيانات التي يتعلم منها. حتى الآن، لم نقل شيئاً عن المجتمع الأحصائي الذي انشأ البيانات. في الحقيقه، نحن مهتمين بإجراء توقعات على جميع المجتمع الأحصائي، ليس فقط البيانات التي رأيناها.

### المخاطر

اذا كانت البيانات التي رأيناها $ X $ و $ y $ تم جمعها بشكل عشوائي، فأنها تعتبر بياناتنا تعتبر متغيرات عشوائية. واذا كانت متغيرات عشوائية، فأن متغيرات النموذج ايضاً عشوائيه، في كل مره نجمع فيها المزيد من البيانات ونضبط النموذج عليها، متغيرات النموذج $ f_\hat{\theta} (x) $ ستتغير قليلاً.

لنفترض أننا قمنا بسحب أحد المدخلات والمخرجات $ z, \gamma $ من مجتمعنا الإحصائي بشكل عشوائي. الخسارة التي يكونها النموذج لهذه القيم هي:

$$ \begin{aligned}
\ell(\gamma, f_\hat{\theta} (z))
\end{aligned} $$

لاحظ أن هذه الخساره هي متغير عشوائي؛ تتغير الخساره عندما تستقبل قيم جديده من $ X $ و $ y $ ونقاط اخرى من $ z, \gamma $ من المجتمع الإحصائي.

**المخاطر Risk** لنموذج $ f_\hat{\theta} $ هي النتيجة المتوقعه من الخساره السابقه لجميع بيانات التدريب $ X $ و $ y $ وجميع النقاط $ z, \gamma $ في المجتمع الإحصائي:

$$ \begin{aligned}
R(f_\hat{\theta}(x)) = \mathbb{E}[ \ell(\gamma, f_\hat{\theta} (z)) ]
\end{aligned} $$

لاحظ ان المخاطر هي توقع لمتغير عشوائي وليست عشوائيه بحد ذاتها. القيمة المتوقعه من رمي حجر النرد ذو الست جهات بشكل عادل وعشوائي هي 3.5 على الرغم من أن عمليات الرمي نفسها عشوائية.

المثال السابق يطلق علية أحياناً **المخاطر الحقيقه True Risk** لأنها تخبرنا عن أداء النموذج على كامل المجتمع الإحصائي. إذا تمكنا من إيجاد المخاطر الحقيقه لجميع النماذج، يمكننا ببساطة اختيار النموذج الأقل مخاطر ونكون متأكدين أن النموذج سيكون أداة أفضل من بقية النماذج على المدى البعيد على دالة الخسارة التي إخترناها.

### الخطر التجريبي

الواقع ليس بهذه السهوله والروعه. إذا قمنا بتغير تعريف التوقع إلى معادة المخاطر الحقيقه، سنحصل على التالي:

$$ \begin{split}
\begin{aligned}
R(f_\hat{\theta})
&= \mathbb{E}[ \ell(\gamma, f_\hat{\theta} (z)) ] \\
&= \sum_\gamma \sum_z \ell(\gamma, f_\hat{\theta} (z)) P(\gamma, z) \\
\end{aligned}
\end{split} $$

للتبسيط، نريد أن نعرف ما تعنيه $ P(\gamma, z) $، وهي توزيع الإحتمالية العام لأي من النقاط في المجتمع الإحصائي. للأسف، إيجاد ذلك ليس سهلاً. لنفترض أننا نريد أن نتوقع قيمة الإكراميه بناءًا على عدد العملاء في الطاولة. ما هي إحتمالية أن طاولة بثلاث أشخاص يقومون بإعطاء إكرامية بقيمة $14.50؟ إذا كنا نعرف توزيع النقاط بشكل دقيقه، فلا نحتاج لجمع بيانات وضبط النموذج، سيكون لدينا معرفة بالقيمة المحتملة للإكراميه لأي عدد من العملاء في الطاولة.

على الرغم أننا لا نعرف بشكل دقيقه توزيع المجتمع الإحصائي، يمكننا توقعه بناءًا على ما أطلعنا عليه في البيانات $ X $ و $ y $. إذا قمنا بسحب قيم ل $ X $ و  $ y $ بشكل عشوائي من المجتمع الإحصائي، توزيع النقاط في $ X $ و $ y $ سيكون مشابه لتوزيع المجتمع الإحصائي. لذا، نعامل $ X $ و $ y $ كمجتمعنا الإحصائي. لذا، إحتمالية الظهور لإي من المدخلات والمخرجات $ X_i $ و $ y_i $ هي $ \frac{1}{n} $ بما أن كل كلاهما يظهر مره واحده من بين كل النقاط $ n $.

ذلك يسمح لنا بحساب **الخطر التجريبي Empirical Risk**، قيمة تقريبه للخطر الحقيقي:

$$ \begin{split}
\begin{aligned}
\hat R(f_\hat{\theta})
&= \mathbb{E}[ \ell(y_i, f_\hat{\theta} (X_i)) ] \\
&= \sum_{i=1}^n \ell(y_i, f_\hat{\theta} (X_i)) \frac{1}{n} \\
&= \frac{1}{n} \sum_{i=1}^n \ell(y_i, f_\hat{\theta} (X_i)) 
\end{aligned}
\end{split} $$

اذا كانت البيانات لدينا ذات حجم كبير وتم سحبها بشكل عشوائي من المجتمع الإحصائي، فأن الخطر التجريبي $ \hat R(f_\hat{\theta}) $ سيكون قريب جداً من الخطر الحقيقي $ R(f_\hat{\theta}) $. يسمح لنا ذلك بإختيار النموذج الذي يقلل من الخطر التجريبي.

لاحظ أن هذا المصطلح هو متوسط دالة الخساره في بداية هذا القسم! بالتقليل من متوسط الخساره، فأننا ايضاً نقلل من الخطر التجريبي. يوضح ذلك لماذا نستخدم في العادة متوسط الخساره كنتيجة لدالة الخساره بدلاً مثلاً من أعلى قيمة للخساره.

### ملخص المخاطر

الخطر الحقيقي لتنبؤ النموذح يوضح لنا خسارة النموذج على المدى البعيد التي سيحصل عليها من المجتمع الإحصائي. بما أننا عادةً لا نستطيع حساب الخطر الحقيقي بشكل مباشر، فأننا نقوم بحساب الخطر التجريبي ونستخدمه لإيجاد النموذج المناسب لتوقعنا. لأن الخطر التجريبي هو متوسط الخساره على البيانات التي رأيناها، فأننا عادةً نقلل من متوسط الخساره عند ضبط النماذج.

## إنحياز وتبيان النموذج

### تحليل الإنحياز والتباين

### مشتقة تحليل الإنحياز والتبيان

### مثال: الإنحدار الخطي وموجات الجيب

### التطبيق العملي للإنحياز والتباين

### النقاط الأساسية

### ملخص إنحياز وتبيان النموذج

## التحقق المتقاطع

### تقسيم بيانات التدريب والتحقق والإختبار

#### حجم تقسيم بيانات التدريب والتحقق والإختبار

### خطأ التدريب و خطأ الإختبار

### التحقق المتقاطع K-Flod

### مقايضة الإنحياز والتباين

### مثال: اختيار النموذج لبيانات تقييم الآيس كريم

### ملخص التحقق المتقاطع

<p align="center"> 
<img src='{{ site.baseurl }}/img/chapter15/'>
</p>