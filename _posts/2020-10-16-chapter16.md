---
title: ุงูุถุจุท
show_title: true
chapter_number: 16
chapter_text: ุงููุตู ุงูุณุงุฏุณ ุนุดุฑ
chapter_lessons: [[0, 'ููุฏูุฉ'], [1, 'ููุฑุฉ ุงูุถุจุท'], [2, 'ุงูุถุจุท L2: ุฅูุญุฏุงุฑ Ridge'], [3, 'ุงูุถุจุท L1: ุฅูุญุฏุงุฑ ุงูููู']]
chapter_sublessons: [
    [],
    ['ุจูุงูุงุช ุณุฏ ุงูููุงุฉ', 'ุงูุชุญูู ูู ุงููุนุงููุงุช', 'ูุนููููุงุช ุงููุนุงูุจุฉ'],
    [['ุงูุชุนุฑูู', 'ูุชุบูุฑุงุช ุงูุถุจุท', 'ุฅุณุชุจุนุงุฏ ูุตุทูุญ ุงูุฅูุญูุงุฒ', 'ุชุณููุฉ ุงูุจูุงูุงุช'], 'ุฅุณุชุฎุฏุงู ุฅูุญุฏุงุฑ Ridge', 'ููุฎุต ุฅูุญุฏุงุฑ Ridge'],
    ['ุชุนุฑูู ุงูุถุจุท', 'ุงูููุงุฑูุฉ ุจูู ุฅูุญุฏุงุฑ Ridge ูุงูููู', 'ุงุฎุชูุงุฑ ุงูุฎุตุงุฆุต ูุน ุฅูุญุฏุงุฑ ุงูููู', 'ุงูุฌุจูู ร ุงูููู ุนูููุงู', 'ููุฎุต ุฅูุญุฏุงุฑ ุงูููู' ]

]
layout: default
---

## ููุฏูุฉ

ูููู ูููุฏุณุฉ ุงูุฎุตุงุฆุต ุงู ุชูุฏู ููุง ูุนูููุงุช ูููุฉ ุนู ุฎุทูุงุช ุชูููุฏ ุงูุจูุงูุงุช ูู ุงููููุฐุฌ. ููููุ ุฅุถุงูุฉ ุงูุฎุตุงุฆุต ุฅูู ุงูุจูุงูุงุช ุนุงุฏุฉ ูุง ูุฒูุฏ ูู ุงูุชุจุงูู ูู ูููุฐุฌูุง ููููู ูุฐู ุงู ูุณูุก ูู ุฃุฏุงุกุฉ ุจุดูู ุนุงู. ุจุฏูุงู ูู ุฅูุดุงุก ุงูุฎุตุงุฆุต ุจุดูู ุนุดูุงุฆูุ ูููููุง ุฅุณุชุฎุฏุงู ุทุฑููุฉ ุชุณูู ุจู **ุงูุถุจุท Regularization** ููุชูููู ูู ุงูุชุจุงูู ูู ูููุฐุฌูุง ูุน ุงูุฅุณุชูุฑุงุฑ ุจุชูุฏูู ุฃูุจุฑ ูุฏุฑ ูู ุงููุนูููุงุช ุนู ุงูุจูุงูุงุช.

## ููุฑุฉ ุงูุถุจุท

ููุจุฏุฃ ุงูููุงุด ุนู ุงูุถุจุท ุจุฅุณุชุฎุฏุงู ุงููุซุงู ุงูุชุงูู ูุชูุถูุญ ุฃูููุชู.

### ุจูุงูุงุช ุณุฏ ุงูููุงุฉ

ุงูุจูุงูุงุช ุงูุชุงููู ุชูุถุญ ูููุฉ ุงูููุงุฉ ุจุงููุชุฑ ุงูุชู ุชุชุฏูู ูู ุณุฏ ุงูููุงุฉ ูู ุงูููู ู ูููุฉ ุงูุชุบูุฑ ูู ูุณุชูู ุงูููุงุฉ ูู ููุณ ุงูููู ุจุงููุชุฑ.

> ูุชุญููู ุงูุจูุงูุงุช water_large.csv [ุงุถุบุท ููุง]({{ site.baseurl }}/files/chapter16/water_large.csv).

```python
df = pd.read_csv('water_large.csv')
df
```

**water\_flow**|**water\_level\_change**| 
:-----:|:-----:|:-----:
6.04E+10|-15.936758|0
3.32E+10|-29.152979|1
9.73E+11|36.189549|2
...|...|...
2.36E+11|7.08548|20
1.49E+12|46.282369|21
3.78E+11|14.612289|22

```ruby
23 rows ร 2 columns
```

ุนูุฏ ุฑุณู ุงูุจูุงูุงุช ููุงุญุธ ุงูุฅุชุฌุงู ุงูุชุตุงุนุฏู ูุชุฏูู ุงูููุงู ูููุง ูุงูุช ูุณุชููุงุช ุงูููุงุฉ ุฅูุฌุงุจูุฉ:

```python
df.plot.scatter(0, 1, s=50);
```

<p align='center'>
<img src='{{ site.baseurl }}/img/chapter16/reg_intuition_8_0.png'>
</p>

ูููุฐุฌุฉ ูุฐุง ุงูููุทุ ูููููุง ุฅุณุชุฎุฏุงู ูููุฐุฌ ุงูุฅูุญุฏุงุฑ ุงูุฎุทู ูููุฑุจุนุงุช ุงูุตุบุฑู Least Square Linear Regression. ูุธูุฑ ูู ุงูุฑุณู ุงูุจูุงูู ุงูุชุงูู ุงูุจูุงูุงุช ูุชููุนุงุช ุงููููุฐุฌ:

```python
df.plot.scatter(0, 1, s=50);
plot_curve(curves[0])
```

<p align='center'>
<img src='{{ site.baseurl }}/img/chapter16/reg_intuition_10_0.png'>
</p>

> ูู ุงูููุฏ ุงูุจุฑูุฌู ุงูุณุงุจู ุฅุณุชุฎุฏู ุงููุงุชุจ ุงูุฏุงูุฉ `plot_curve` ูุงููุตูููุฉ `curves` ูููุณุงุนุฏุฉ ูู ุงูุฑุณูุ ูุนุฑููุง ูุงูุชุงูู ูุน ุฏุงูุฉ ูุณุงุนุฏุฉ ุฃุฎุฑู `make_curve`:
>
> ```python
>
> import matplotlib.pyplot as plt
> import numpy as np
> import pandas as pd
> from sklearn.pipeline import Pipeline
> from sklearn.preprocessing import PolynomialFeatures
> from sklearn.linear_model import LinearRegression
> from collections import namedtuple
>
> Curve = namedtuple('Curve', ['xs', 'ys'])
>
> def make_curve(clf, x_start=-50, x_end=50):
>     xs = np.linspace(x_start, x_end, num=100)
>     ys = clf.predict(xs.reshape(-1, 1))
>     return Curve(xs, ys)
>
> def plot_curve(curve, ax=plt, **kwargs):
>     ax.plot(curve.xs, curve.ys, **kwargs)
> 
> X = df.iloc[:, [0]].as_matrix()
> y = df.iloc[:, 1].as_matrix()
> 
> degrees = [1, 2, 8, 12]
> clfs = [Pipeline([('poly', PolynomialFeatures(degree=deg, include_bias=False)),
>                   ('reg', LinearRegression())])
>         .fit(X, y)
>         for deg in degrees]
>
> curves = [make_curve(clf) for clf in clfs]
> ```

ูุธูุฑ ูู ุงูุฑุณู ุงูุจูุงูู ุงูุณุงุจู ุฃู ูุฐุง ุงููููุฐุฌ ูุง ูุบุทู ูุงูู ุงูููุงุท ูู ููุท ูุฐู ุงูุจูุงูุงุชุ ูุงููููุฐุฌ ูุฏูุฉ ุฅูุญูุงุฒ ุนุงูู. ููุง ูุนููุง ูู ุงูุณุงุจูุ ูููููุง ุญู ูุฐู ุงููุดููุฉ ุจุฅุถุงูุฉ ุฎุตุงุฆุต ูุชุนุฏุฏุฉ ุงูุญุฏูุฏ ููุจูุงูุงุช. ูููู ุจุฅุถุงูุฉ ุฎุตุงุฆุต ูู ุงูุฏุฑุฌุฉ 2ุ 8 ู 12ุ ุงูุฑุณูู ุงูุจูุงููุฉ ุงูุชุงููุฉ ุชุธูุฑ ูุชุงุฆุฌ ุชุฏุฑูุจ ุงูุจูุงูุงุช ููู ูููุฐุฌ:

```python
plot_curves(curves)
```

<p align='center'>
<img src='{{ site.baseurl }}/img/chapter16/reg_intuition_12_0.png'>
</p>

> ุฅุณุชุฎุฏู ุงููุงุชุจ ุฏุงูุฉ `plot_curves` ูููุณ ุงููุตูููุฉ ุงููุณุชุฎุฏูุฉ ูู ุงููุซุงู ุงูุณุงุจู `curves` ูููุณุงุนุฏุฉ ูู ุฑุณู ุงูููุงุฐุฌุ ูุนุฑููุง ูุงูุชุงูู ูุน ูุฒูุฏ ูู ุงูุฏูุงู ุงููุณุงุนุฏุฉ:
>
> ```python
> 
> def flatten(seq): return [item for subseq in seq for item in subseq]
>
> def plot_data(df=df, ax=plt, **kwargs):
>     ax.scatter(df.iloc[:, 0], df.iloc[:, 1], s=50, **kwargs)
>
> def plot_curves(curves, cols=2):
>     rows = int(np.ceil(len(curves) / cols))
>     fig, axes = plt.subplots(rows, cols, figsize=(10, 8),
>                              sharex=True, sharey=True)
>     for ax, curve, deg in zip(flatten(axes), curves, degrees):
>         plot_data(ax=ax, label='Training data')
>         plot_curve(curve, ax=ax, label=f'Deg {deg} poly')
>         ax.set_ylim(-5e10, 170e10)
>         ax.legend()
>         
>     # ุฅุถุงูุฉ ุงูุฑุณูู ุงููุจูุฑุฉ ูุฅุฎูุงุก ุงูุฅุทุงุฑุงุช
>     fig.add_subplot(111, frameon=False)
>     # ุฅุฎูุงุก ุงูุญุฏูุฏ ูุงูุนูุงูุงุช ูุงูุนูุงููู ูู ุงูุฑุณู
>     plt.tick_params(labelcolor='none', top='off', bottom='off',
>                     left='off', right='off')
>     plt.grid(False)
>     plt.title('Polynomial Regression')
>     plt.xlabel('Water Level Change (m)')
>     plt.ylabel('Water Flow (Liters)')
>     plt.tight_layout()
> ```

ููุง ูู ูุชููุนุ ูุชุนุฏุฏุฉ ุงูุญุฏูุฏ ูู ุงูุฏุฑุฌุฉ ุงูู 12 ุทุงุจูุช ุจูุงูุงุช ุงูุชุฏุฑูุจ ุจุดูู ููุงุณุจ ูููู ูุจุฏู ุงู ุงููููุฐุฌ ูุถุจูุท ุจููุท ุฒุงุฆู ุนูู ุงูุจูุงูุงุช ุจุณุจุจ ุงูุชุดููุด. ูุธูุฑ ุฐูู ูููุฐุฌ ุขุฎุฑ ููููุงูุถุฉ ุจูู ุงูุฅูุญูุงุฒ ูุงูุชุจุงููุ ุงููููุฐุฌ ุงูุฎุทู ูุฏูุฉ ุฅูุญูุงุฒ ุนุงูู ูุชุจุงูู ูููู ุจูููุง ูุชุนุฏุฏุฉ ุงูุญุฏูุฏ ูู ุงูุฏุฑุฌุฉ 12 ูุฏููุง ุฅูุญูุงุฒ ูููู ูุชุจูุงู ุนุงูู.

### ุงูุชุญูู ูู ุงููุนุงููุงุช

ุนูุฏ ุงูุชุญูู ูู ูุนุงููุงุช ูููุฐุฌ ูุชุนุฏุฏุฉ ุงูุญุฏูุฏ ูู ุงูุฏุฑุฌุฉ ุงูู 12 ูุธูุฑ ููุง ุฃู ุงููููุฐุฌ ูููู ุจุงูุชููุน ุจูุงุกูุง ุนูู ุงููุนุงุฏูุฉ ุงูุชุงููุฉ:

$$ \begin{split}
207097470825 + 1.8x + 482.6x^2 + 601.5x^3 + 872.8x^4 + 150486.6x^5 \\
    + 2156.7x^6 - 307.2x^7 - 4.6x^8 + 0.2x^9 + 0.003x^{10} - 0.00005x^{11} + 0x^{12}
\end{split} $$

ูููุง $ x $ ูู ูููุฉ ุชุบูุฑ ูุณุชูู ุงูููุงุฉ ูู ุฐูู ุงูููู.

ูุนุงููุงุช ุงููููุฐุฌ ูุจูุฑุฉ ุฌุฏุงูุ ุฎุงุตุฉ ููุชุนุฏุฏุงุช ุงูุญุฏูุฏ ุฐุงุช ุงูุฏุฑุฌุงุช ุงูุนุงููุฉ ูุงูุชู ุชุณุงูู ุจุดูู ุนุงูู ูู ุชุจุงูู ุงููููุฐุฌ ( ูุซูุงู $ x^5 $ ู $ x^6 $ ).

### ูุนููููุงุช ุงููุนุงูุจุฉ

ููุชุฐูุฑ ุฃู ุงููููุฐุฌ ุงูุฎุทู ูููู ุจุงูุชููุนุงุช ุจูุงุกุงู ุนูู ุงูุชุงููุ $ \theta $ ูู ูุฒู ุงููููุฐุฌ ู $ x $ ูู ูุชูุฌูุฉ ุงูุฎุตุงุฆุต:

$$ f_\hat{\theta}(x) = \hat{\theta} \cdot x $$

ูุถุจุท ุงููููุฐุฌุ ูููู ุจุชูููู ุฏุงูุฉ ุงูุชูููุฉ ููุชูุณุท ุงูุฎุทุฃ ุงูุชุฑุจูุนูุ ูููุง $ X $ ุชูุซู ูุตูููุฉ ุงูุจูุงูุงุช ู $ y $ ูู ุงููุชุงุฆุฌ ุงูุชู ุฅุทูุนุช ุนูููุง:

$$ \begin{split}
\begin{aligned}
L(\hat{\theta}, X, y)
&= \frac{1}{n} \sum_{i}(y_i - f_\hat{\theta} (X_i))^2\\
\end{aligned}
\end{split} $$

ูุชูููู ุงูุชูููุฉ ูู ุงููุนุงุฏูุฉ ุงูุณุงุจูุฉุ ูููู ุจุถุจุท $ \hat{\theta} $ ุญุชู ูุตู ูุฃูุถู ููู ููุฃูุฒุงู Weights ุฃูุงู ูุงู ุญุฌููุง. ูููุ ูุฌุฏูุง ุฃู ูููุง ูุงู ุงููุฒู ุนุงูู ูุจุฎุตุงุฆุต ุงูุซุฑ ุชุนููุฏุงู ููุชุฌ ููุง ุชุจุงูู ุนุงูู ูููููุฐุฌ. ุนูู ุงูุนูุณุ ุฅุฐุง ูุงู ุจุฃููุงููุง ุงูุชุนุฏูู ูู ุฏุงูุฉ ุงูุชูููุฉ ููุนุงูุจุฉ ุงูุฃูุฒุงู ุงูุนุงููุฉุ ุณูููู ุงููููุฐุฌ ุงููุงุชุฌ ุฐู ุชุจุงูู ูููู. ูุณุชุฎุฏู ุงูุถุจุท ููููุงู ุจุฐูู.

## ุงูุถุจุท L2: ุฅูุญุฏุงุฑ Ridge

ูู ูุฐุง ุงูุฌุฒุก ุณูุชุนุฑู ุนูู ุทุฑููุฉ ุงูุถุจุท $ L_2 $ุ ุทุฑููุฉ ููุนุงูุจุฉ ุงูุฃูุฒุงู ุงููุจูุฑุฉ ูู ุฏูุงู ุงูุชูููุฉ ููุชูููู ูู ุชุจุงูู ุงููููุฐุฌ. ุฑุงุฌุนูุง ุจุดูู ูุจุณุท ุงูุฅูุญุฏุงุฑ ุงูุฎุทูุ ุซู ุชุนุฑููุง ุนูู ุงูุถุจุท ูุฃุฏุงุฉ ููุชุนุฏูู ูู ุฏุงูุฉ ุงูุชูููุฉ.

ูุชุทุจูู ุงูุฅูุญุฏุงุฑ ุงูุฎุทู ูููุฑุจุนุงุช ุงูุตุบุฑูุ ูุณุชุฎุฏู ุงููููุฐุฌ:

$$ f_\hat{\theta}(x) = \hat{\theta} \cdot x $$ 

ูููู ุจุถุจุท ุงููููุฐุฌ ุนู ุทุฑูู ุงูุชูููู ุฏุงูุฉ ุชูููุฉ ูุชูุณุท ุงูุฎุทุฃ ุงูุชุฑุจูุนู:

$$ \begin{split}
\begin{aligned}
L(\hat{\theta}, X, y)
&= \frac{1}{n} \sum_{i}^n(y_i - f_\hat{\theta} (X_i))^2\\
\end{aligned}
\end{split} $$

ูู ุงูุชุนุฑูู ุงูุณุงุจูุ $ X $ ุชูุซู ูุตูููุฉ ุงูุจููุงุงุช $ n \times p $ุ ู $ x $ ุชูุซู ุณุทุฑ ูู ุฃุณุทุฑ $ X $ุ ู $ y $ ุชูุซู ุงููุชุงุฆุฌ ุงูุชู ุฃุทูุน ุนูููุงุ ู $ \hat{\theta} $ ูู ูุฒู ุงููููุฐุฌ.
### ุงูุชุนุฑูู

ูุฅุถุงูุฉ ุงูุถุจุท $ L_2 $ ุฅูู ุงููููุฐุฌุ ูููู ุจุชุนุฏูู ุฏุงูุฉ ุงูุชูููุฉ ุงูุณุงุจูุฉ:

$$ \begin{aligned}
L(\hat{\theta}, X, y)
&= \frac{1}{n} \sum_{i}(y_i - f_\hat{\theta} (X_i))^2
    + \lambda \sum_{j = 1}^{p} \hat{\theta_j}^2
\end{aligned} $$ 

ููุงุญุธ ุฃู ุฏุงูุฉ ุงูุชูููุฉ ูุดุงุจูู ููุณุงุจูุฉ ูุน ุฅุถุงูุฉ ุงูุถุจุท $ L_2 $ ูู ุงููุนุงุฏูุฉ $ \lambda \sum_{j = 1}^{p} \hat{\theta_j}^2 $. ุงููุฌููุน ( $ \sum $ ) ูู ูุฐู ุงููุนุงุฏูุฉ ูููู ุจุฌูุน ุชุฑุจูุน ูู ูุฒู ูู ุงููููุฐุฌ $ \hat{\theta_1}, \hat{\theta_2}, \ldots, \hat{\theta_p} $. ูุธูุฑ ููุง ูู ุงููุนุงุฏูุฉ ุฃูุถุงู ุฑูุฒ ุฌุฏูุฏ ููุชุบูุฑ ุฑููู ูู ุงููููุฐุฌ $ \lambda $ ูุงูุฐู ูุชู ุชุนุฏููู ูุชุญุฏูุฏ ูููุฉ **ุนููุจุฉ ุงูุถุจุท Regularization Penalty**.

ูุนุงุฏูุฉ ุงูุถุจุท ุงูุฐู ุงุถููุงูุง ุชุณุจุจ ุฒูุงุฏุฉ ูู ุงูุชูููุฉ ุฅุฐุง ูุงูุช ุงูููู ูู $ \hat{\theta} $ ุจุนูุฏุฉ ุนู ุตูุฑ. ูุน ุฅุถุงูุฉ ุงูุถุจุทุ ุงููุฒู ูููููุฐุฌ ุงููุซุงูู ูููู ูู ุงูุฎุณุงุฑุฉ ููุนุงูุจุฉ ุงูุถุจุท ุจุฏูุงู ูู ุงูุฎุณุงุฑุฉ ููุท. ุจูุง ุฃู ูุชุงุฆุฌ ุฃูุฒุงู ุงููููุฐุฌ ุนุงุฏุฉ ูุง ุชููู ููููุฉุ ูุณูููู ุงููููุฐุฌ ุฐู ุชุจูุงู ูููู ูุฅูุญูุงุฒ ุนุงูู.

ุฅุณุชุฎุฏุงู ุงูุถุจุท $ L_2 $ ูุน ูููุฐุฌ ุฎุทู ูุฏุงูุฉ ุงูุชูููุฉ ููุชูุณุท ุงูุฎุทุฃ ุงูุชุฑุจูุนู ูุทูู ุนูููุง **ุฅูุญุฏุงุฑ Ridge**. [๐][RidgeRegression]

#### ูุชุบูุฑุงุช ุงูุถุจุท

ูุชุญูู ูุชุบูุฑ ุงูุถุจุท $ \lambda $ ุจุนููุจุฉ ุงูุถุจุท. ุนูุฏูุง ุชููู $ \lambda $ ููููุฉ ููุชุฌ ูููุฉ ุนูุงุจ ููููุ ุฅุฐุง ูุงูุช $ \lambda = 0 $ ุชููู ูููุฉ ูุนุงูุจุฉ ุงูุถุจุท ุงูุถุงู $ 0 $ ูุจุงูุชุงูู ูู ูุชู ุถุจุท ุฏุงูุฉ ุงูุชูููุฉ.

ุนูุฏูุง ุชููู $ \lambda $ ุนุงููุฉ ููุชุฌ ููุง ูููุฉ ุนูุงุจู ุนุงููู ูุจุงูุชุงูู ูููู ุงููููุฐุฌ ุจุณูุท. ุงูุฒูุงุฏุฉ ูู $ \lambda $ ุชููู ูู ุงูุชุจุงูู ูุชุฒูุฏ ูู ุงูุฅูุญูุงุฒ ูู ุงููููุฐุฌ. ูุณุชุฎุฏู ุงูุชุญูู ุงููุชูุงุทุน ูุฅุฎุชูุงุฑ ูููุฉ $ \lambda $ ุงูุชู ุชููู ูู ุฎุทุฃ ุงูุชุญูู.

**ููุงุญุธุฉ ุนู ุงูุถุจุท ูู ููุชุจุฉ `scikit-learn`**:

ุชููุฑ ููุชุจุฉ `scikit-learn` ูููุฐุฌ ุงูุฅูุญุฏุงุฑ ููุถุงู ุฅูููุง ุจุดูู ุชููุงุฆู ุงูุถุจุท. ูุซูุงูุ ูุชุทุจูู ุฅูุญุฏุงุฑ Ridge ููููู ุฅุณุชุฎุฏุงู ุงููููุฐุฌ ุงูุฎุทู [`sklearn.linear_model.Ridge`](http://scikit-learn.org/stable/modules/generated/sklearn.linear_model.Ridge.html). ูุงุญุธ ุฃู ุฌููุน ุงูููุงุฐุฌ ูู ููุชุจุฉ `scikit-learn` ุชุทูู ุนูู ูุชุบูุฑ ุงูุถุจุท `alpha` ุจุฏูุงู ูู $ \lambda $.

ุชููุฑ ููุชุจุฉ `scikit-learn` ุจุดูู ุจุณูุท ูููุงุณุจ ููุงุฐุฌ ูุถุจูุทุฉ ุชููู ุจุชุทุจูู ุงูุชุญูู ุงููุชูุงุทุน ูุฅุฎุชูุงุฑ ูููุฉ ููุงุณุจุฉ ูู $ \lambda $. ูุซูุงูุ [`sklearn.linear_model.RidgeCV`](http://scikit-learn.org/stable/modules/generated/sklearn.linear_model.RidgeCV.html#sklearn.linear_model.RidgeCV) ูุณูุญ ูููุณุชุฎุฏู ุฅุฏุฎุงู ููู ูุชุบูุฑุงุช ุงูุถุจุท ูุจุดูู ุฃูุชููุงุชููู ุชููู ุจุชุทุจูู ุงูุชุญูู ุงููุชูุงุทุน ูุฅุฎุชูุงุฑ ุงูุถู ูููุฉ ูููุชุบูุฑ ูุงูุฐู ูุญุตู ุนูู ุฃูู ุฎุทุฃ ูู ุจูุงูุงุช ุงูุชุญูู.

#### ุฅุณุชุจุนุงุฏ ูุตุทูุญ ุงูุฅูุญูุงุฒ

ูุงุญุธ ุฃู ุฑูุฒ ุงูุฅูุญูุงุฒ $ \theta_0 $ ูู ูุชู ุถูุฉ ูุนูููุฉ ุงูุฌูุน ูู ูุนุงุฏูุฉ ุงูุถุจุท. ูุง ูููู ุจูุนุงูุจุฉ ุงูุฅูุญูุงุฒ ูุฃู ุงูุฒูุงุฏุฉ ูู ุฅูุญูุงุฒ ุงููููุฐุฌ ูุง ุชุฃุฏู ููุฒูุงุฏุฉ ูู ุงูุชุจุงููุ ุจุจุณุงุทุฉ ูููู ุงูุฅูุญูุงุฒ ุจุชุบูุฑ ุฌููุน ุงูุชููุนุงุช ุฅูู ููู ุซุงุจุชู.

#### ุชุณููุฉ ุงูุจูุงูุงุช

ูุงุญุธ ุงู ูุนุงุฏูุฉ ุงูุถุจุท $ \lambda \sum_{j = 1}^{p} \hat{\theta_j}^2 $ ุชุนุงูุจ ูู $ \hat{\theta_j} $ ุจุดูู ูุชูุงูุฆ. ููููุ ุชุฃุซูุฑ ูู ูููุฉ ูู $ \hat{\theta_j} $ ูุฎุชูู ุจูุงุกุงู ุนูู ุงูุจูุงูุงุช ููุณูุง. ููุฃุฎุฐ ูุซูุงู ูุฐู ุงูุฌุฒุก ูู ุจูุงูุงุช ุชุฏูู ุงูููุงุฉ ุจุนุฏ ุฅุถุงูุฉ ูุชุบูุฑุงุช ูุชุนุฏุฏุฉ ุงูุญุฏูุฏ ูู ุงูุฏุฑุฌุฉ ุงูุซุงููู:

```python
pd.DataFrame(clfs[2].named_steps['poly'].transform(X[:5]),
             columns=[f'deg_{n}_feat' for n in range(8)])
```

**deg\_7\_feat**|**deg\_6\_feat**|**...**|**deg\_1\_feat**|**deg\_0\_feat**| 
:-----:|:-----:|:-----:|:-----:|:-----:|:-----:
4161020472|-261095791.1|...|253.98|-15.94|0
5.21751E+11|-17897014962|...|849.9|-29.15|1
2.94215E+12|81298431147|...|1309.68|36.19|2
3.90415E+12|1.04132E+11|...|1405.66|37.49|3
2.84568E+13|-5.92124E+11|...|2309.65|-48.06|4

```ruby
5 rows ร 8 columns
```

ููุงุญุธ ุฃู ูุชุนุฏุฏุฉ ุงูุญุฏูุฏ ูู ุงูุฏุฑุฌุฉ ุงูุณุงุจุนู ุญุตูุช ุนูู ููู ุฃุนูู ุจูุซูุฑ ุนู ูุชุนุฏุฏุฉ ุงูุญุฏูุฏ ูู ุงูุฏุฑุฌุฉ ุงูุฃููู. ูุนูู ุฐูู ุฃู ุงููุฒู ุงูุนุงูู ูู ูููุฐุฌ ูุชุนุฏุฏุฉ ุงูุญุฏูุฏ ูู ุงูุฏุฑุฌุฉ ุงูุณุงุจุนุฉ ุฃุซุฑ ุนูู ุงูุชููุนุงุช ุฃูุซุฑ ูู ุงููุฒู ุนุงูู ููููุฐุฌ ูุชุนุฏุฏุฉ ุงูุญุฏูุฏ ูู ุงูุฏุฑุฌุฉ ุงูุงููู. ุฅุฐุง ูููุง ุจุชุทุจูู ุงูุถุจุท ุนูู ูุฐู ุงูุจูุงูุงุช ูุจุงุดุฑุฉุ ุณุชููู ูุนุงูุจุฉ ุงูุถุจุท ุจุชูููู ุงููุฒู ูููููุฐุฌ ุจุดูู ุบูุฑ ููุงุณุจ ููุฎุตุงุฆุต ูู ุงูุฏุฑุฌุงุช ุงูุตุบุฑู. ุจุดูู ุนูููุ ููุชุฌ ุนู ุฐูู ุชุจุงูู ุนุงูู ูููููุฐุฌ ุญุชู ุจุนุฏ ุชุทุจูู ุงูุถุจุท ูุฃู ุงูุฎุตุงุฆุต ุฐุงุช ุงูุชุฃุซูุฑ ุงูุฃูุจุฑ ุนูู ุงูุชููุนุงุช ูู ุชุชุฃุซุฑ.

ูุญู ุฐููุ ูููู ุจู **ุงูุชุณููุฉ Normalization** ุฌููุน ุงูุฃุนูุฏุฉ ุนู ุทุฑูู ุทุฑุญ ุงููุชูุณุท ูููุง ูุชุบูุฑ ุงูููู ูููุง ุฅูู ุดูู ูุฏุฑุฌ Scale ุจูู -1 ู 1. ูู ููุชุจุฉ `scikit-learn` ุฃุบูุจ ููุงุฐุฌ ุงูุฅูุญุฏุงุฑ ุชุณูุญ ุจุชุทูู ุงูุชุณููุฉ ุจุฅุณุชุฎุฏุงู ุงููุชุบูุฑ `normalize=True` ููููุงู ุจุชุณููุฉ ุงูุจูุงูุงุช ูุจู ุงูุถุจุท. [๐][StandardizationNormalization] [๐][StandardizationNormalization2]

ุทุฑููุฉ ุฃุฎุฑู ูุดุงุจูุฉ ููุชุณููุฉ ูู **ุงูุชูุญูุฏ Standardization** ูุฃุนูุฏุฉ ุงูุจูุงูุงุช ุนู ุทุฑูู ุทุฑุญ ุงููุชูุณุท ูุชูุณููู ุนูู ุงูุงูุญุฑุงู ุงููุนูุงุฑู ููู ุนุงููุฏ.

### ุฅุณุชุฎุฏุงู ุฅูุญุฏุงุฑ Ridge

ุฅุณุชุฎุฏููุง ุณุงุจูุงู ุฎุตุงุฆุต ูุชุนุฏุฏุฉ ุงูุญุฏูุฏ ูุถุจุท ูุชุนุฏุฏุงุช ุงูุญุฏูุฏ ูู ุงูุฏุฑุฌุฉ 2ุ 8 ู 12 ูุจูุงูุงุช ุชุฏูู ุงูููุงุฉ. ุงูุจูุงูุงุช ุงูุฃุณุงุณูุฉ ููุชุงุฆุฌ ุชููุนุงุช ุงููููุฐุฌ ูุงูุชุงูู:

```python
df
```

**water\_flow**|**water\_level\_change**| 
:-----:|:-----:|:-----:
60422330446|-15.94|0
33214896576|-29.15|1
9.72706E+11|36.19|2
...|...|...
2.36352E+11|7.09|20
1.49426E+12|46.28|21
3.78146E+11|14.61|22

```ruby
23 rows ร 2 columns
```

```python
plot_curves(curves)
```

<p align='center'>
<img src='{{ site.baseurl }}/img/chapter16/reg_ridge_15_0.png'>
</p>

ูุชุทุจูู ุฅูุญุฏุงุฑ Ridgeุ ูููู ุงููุงู ุจุฅุณุชุฎุฑุงุฌ ูุตูููุฉ ุงูุจูุงูุงุช ู ูุชูุฌูุฉ ุงููุชุงุฆุฌ ูู ุงูุจูุงูุงุช:

```python
X = df.iloc[:, [0]].as_matrix()
y = df.iloc[:, 1].as_matrix()
print('X: ')
print(X)
print()
print('y: ')
print(y)
```

```ruby
X: 
[[-15.94]
 [-29.15]
 [ 36.19]
 ...
 [  7.09]
 [ 46.28]
 [ 14.61]]

y: 
[6.04e+10 3.32e+10 9.73e+11 ... 2.36e+11 1.49e+12 3.78e+11]
```

ุซู ูููู ุจุชุญููู ุงูููู ูู `X` ุฅูู ูุชุนุฏุฏุฉ ุงูุญุฏูุฏ ูู ุงูุฏุฑุฌุฉ 12:

```python
from sklearn.preprocessing import PolynomialFeatures

# ูุฑูุฏ ุชุญุฏูุฏ include_bias=False
# ูุฃู ูุตููุงุช ููุชุจุฉ sklearns
# ุชููู ุจุดูู ุชููุงุฆู ุจุฅุถุงูุฉ ููู ุงูุฅูุญูุงุฒ

X_poly_8 = PolynomialFeatures(degree=8, include_bias=False).fit_transform(X)
print('First two rows of transformed X:')
print(X_poly_8[0:2])
```

```ruby
First two rows of transformed X:
[[-1.59e+01  2.54e+02 -4.05e+03  6.45e+04 -1.03e+06  1.64e+07 -2.61e+08
   4.16e+09]
 [-2.92e+01  8.50e+02 -2.48e+04  7.22e+05 -2.11e+07  6.14e+08 -1.79e+10
   5.22e+11]]
```

ูููู ุจุชุญุฏูุฏ ููู `alpha` ุงูุชู ุณุชุฎุชุงุฑูุง ููุชุจุฉ `scikit-learn` ุจุฅุณุชุฎุฏุงู ุงูุชุญูู ุงููุชูุงุทุนุ ุซู ูุณุชุฎุฏู ูููุฐุฌ `RidgeCV` ูุถุจุท ุงูุจูุงูุงุช ุจุนุฏ ุงูุชุญููู:

```python
from sklearn.linear_model import RidgeCV

alphas = [0.01, 0.1, 1.0, 10.0]

# ุชุฐูุฑ ุงู ุชุญุฏุฏ normalize=True
# ููุชู ุชุณููุฉ ุงูุจูุงูุงุช
clf = RidgeCV(alphas=alphas, normalize=True).fit(X_poly_8, y)

# ุฅุธูุงุฑ ูููุฉ Alpha
clf.alpha_
```

```ruby
0.1
```

ุฃุฎูุฑุงูุ ูููู ุจุฑุณู ูุชุงุฆุฌ ุงูุชููุนุงุช ููููุฐุฌ ูุชุนุฏุฏุฉ ุงูุญุฏูุฏ ูู ุงูุฏุฑุฌุฉ ุงูุซุงููุฉ ุจุฌุงูุจ ุงููููุฐุฌ ูู ุงูุฏุฑุฌุฉ ุงูุซุงููุฉ ุงูุฐู ุชู ุถุจุทุฉ:

```python
fig = plt.figure(figsize=(10, 5))

plt.subplot(121)
plot_data()
plot_curve(curves[2])
plt.title('Base degree 8 polynomial')

plt.subplot(122)
plot_data()
plot_curve(ridge_curves[2])
plt.title('Regularized degree 8 polynomial')
plt.tight_layout()
```

<p align='center'>
<img src='{{ site.baseurl }}/img/chapter16/reg_ridge_23_0.png'>
</p>


> ุฅุณุชุฎุฏู ุงููุงุชุจ ููุณ ุงูุทุฑููุฉ ุงูุณุงุจูุฉ ูุฑุณู ุฅูุญุฏุงุฑ Ridgeุ ุนู ุทุฑูู ุฅูุดุงุก ูุตูููุฉ ุฃุณูุงูุง `ridge_curves` ูุนุฑููุง ูุงูุชุงูู:
>
> ```python
> from sklearn.linear_model import Ridge
> 
> ridge_clfs = [Pipeline([('poly', PolynomialFeatures(degree=deg, include_bias=False)),
>                         ('reg', Ridge(alpha=0.1, normalize=True))])
>         .fit(X, y)
>         for deg in degrees]
> 
> ridge_curves = [make_curve(clf) for clf in ridge_clfs]
> ```

ููุงุญุธ ุฃู ูุชุนุฏุฏุฉ ุงูุญุฏูุฏ ุงูุชู ุชู ุถุจุทูุง ููุญูุงูุง ุฃูุซุฑ ุณูุงุณุฉ ูุชูุฑ ุนูู ุฃุบูุจ ููุงุท ุงูุจูุงูุงุช.

ุจููุงุฑูุฉ ุงููุนุงูููุงุช ูููููุฐุฌ ุงูุฐู ุชู ุถุจุทุฉ ูุงูุฐู ูู ูุชู ุถุจุทุฉ ููุงุญุธ ุฃู ุฅูุญุฏุงุฑ Ridge ููุถู ูุถุญ ูุฒู ูููููุฐุฌ ุนูู ูุชุนุฏุฏุงุช ุงูุญุฏูุฏ ุฐู ุงูุฏุฑุฌุงุช ุงูุฏููุง:

```python
base = coef_table(clfs[2]).rename(columns={'Coefficient Value': 'Base'})
ridge = coef_table(ridge_clfs[2]).rename(columns={'Coefficient Value': 'Regularized'})

pd.options.display.max_rows = 20
display(base.join(ridge))
pd.options.display.max_rows = 7
```

**Regularized**|**Base**| 
:-----:|:-----:|:-----:
 | |degree
2.21064E+11|2.25782E+11|0
6846139066|13115217771|1
146158038|-144725750|2
1930090.04|-10355082.91|3
38240.62|567935.23|4
564.21|9805.14|5
7.25|-249.64|6
0.18|-2.09|7
0|0.03|8

> ุงุณุชุฎุฏู ุงููุงุชุจ ุฏุงูุชูู `coef_table` ู `coefs` ุชูููุงู ุจุฅูุดุงุก ุงูููุนุงูููุงุช ุนูู ุดูู ุฌุฏูู ูู DataFrameุ ูุชุนุฑูููุง ูุงูุชุงูู:
>
> ```python
>
> def coefs(clf):
>     reg = clf.named_steps['reg']
>     return np.append(reg.intercept_, reg.coef_)
> 
> def coef_table(clf):
>     vals = coefs(clf)
>     return (pd.DataFrame({'Coefficient Value': vals})
>             .rename_axis('degree'))
> ```

ุฅุนุงุฏุฉ ุชุทุจูู ููุณ ุงูุนูููุฉ ุนูู ูุชุนุฏุฏุฉ ุงูุญุฏูุฏ ูู ุงูุฏุฑุฌุฉ 12 ูุธูุฑ ูุชุงุฆุฌ ููุงุซูุฉ:

```python
fig = plt.figure(figsize=(10, 5))

plt.subplot(121)
plot_data()
plot_curve(curves[3])
plt.title('Base degree 12 polynomial')
plt.ylim(-5e10, 170e10)

plt.subplot(122)
plot_data()
plot_curve(ridge_curves[3])
plt.title('Regularized degree 12 polynomial')
plt.ylim(-5e10, 170e10)
plt.tight_layout()
```

<p align='center'>
<img src='{{ site.baseurl }}/img/chapter16/reg_ridge_27_0.png'>
</p>

ูุญุตู ุนูู ูููุฐุฌ ุฃูุซุฑ ุจุณุงุทุฉ ูููุง ูููุง ูู ุงูุฒูุงุฏุฉ ูู ูุชุบูุฑ ุงูุถุจุท. ุงูุฑุณู ุงูุจูุงูู ุงูุชุงูู ููุถุญ ุชุฃุซูุฑ ุงูุฒูุงุฏุฉ ูู ูููุฉ ุงูุถุจุท ูู 0.001 ุญุชู 100.0:

```python
alphas = [0.001, 0.01, 0.1, 1.0, 10.0, 100.0]

alpha_clfs = [Pipeline([
    ('poly', PolynomialFeatures(degree=12, include_bias=False)),
    ('reg', Ridge(alpha=alpha, normalize=True))]
).fit(X, y) for alpha in alphas]

alpha_curves = [make_curve(clf) for clf in alpha_clfs]
labels = [f'$\\lambda = {alpha}$' for alpha in alphas]

plot_curves(alpha_curves, cols=3, labels=labels)
```

<p align='center'>
<img src='{{ site.baseurl }}/img/chapter16/reg_ridge_29_0.png'>
</p>

> ุฅุณุชุฎุฏูุช ุงูุฏุงูุฉ `plot_curves` ูููุณุงุนุฏุฉ ุนูู ุฑุณู ุงูููุญููุงุชุ ูุชุนุฑูููุง ูุงูุชุงูู:
>
> ```python
>
> def plot_curves(curves, cols=2, labels=None):
>    if labels is None:
>        labels = [f'Deg {deg} poly' for deg in degrees]
>    rows = int(np.ceil(len(curves) / cols))
>    fig, axes = plt.subplots(rows, cols, figsize=(10, 8),
>                             sharex=True, sharey=True)
>    for ax, curve, label in zip(flatten(axes), curves, labels):
>        plot_data(ax=ax, label='Training data')
>        plot_curve(curve, ax=ax, label=label)
>        ax.set_ylim(-5e10, 170e10)
>        ax.legend()
>        
>    # ุฅุถุงูุฉ ุงูุฑุณูู ุงููุจูุฑุฉ ูุฅุฎูุงุก ุงูุฅุทุงุฑุงุช
>    fig.add_subplot(111, frameon=False)
>    # ุฅุฎูุงุก ุงูุญุฏูุฏ ูุงูุนูุงูุงุช ูุงูุนูุงููู ูู ุงูุฑุณู
>    plt.tick_params(labelcolor='none', top='off', bottom='off',
>                    left='off', right='off')
>    plt.grid(False)
>    plt.title('Polynomial Regression')
>    plt.xlabel('Water Level Change (m)')
>    plt.ylabel('Water Flow (Liters)')
>    plt.tight_layout()
> ```

ููุง ูุฑูุ ุงูุฒูุงุฏุฉ ูู ูุชุบูุฑ ุงูุถุจุท ุชุฒูุฏ ูู ุฅูุญูุงุฒ ุงููููุฐุฌ. ุฅุฐุง ูุงู ูุชุบูุฑ ุงูุถุจุท ุนุงูู ุฌุฏุงูุ ูุตุจุญ ุงููููุฐุฌ ูููุฐุฌุงู ุซุงุจุชุงู ูุฃู ุฃู ูููุฉ ููุฒู ุงููููุฐุฌ ุบูุฑ ุตูุฑ ููุชุฌู ุนููุง ุนูุงุจ ุนุงูู.
### ููุฎุต ุฅูุญุฏุงุฑ Ridge

ุฅุณุชุฎุฏุงู ุถุจุท $ L_2 $ ูุณูุญ ููุง ุจุถุจุท ุฅูุญูุงุฒ ูุชุจุงูู ุงููููุฐุฌ ุนู ุทุฑูู ุนูุงุจ ุฃูุฒุงู ุงููููุฐุฌ ุงูุนุงููุฉ. ุถุจุท $ L_2 $ ููุฅูุญุฏุงุฑ ุงูุฎุทู ูููุฑุจุนุงุช ุงูุตุบุฑู ูุนุฑู ุฃูุถุงู ุจุฅุณู ุฅูุญุฏุงุฑ Ridge. ุฅุณุชุฎุฏุงู ุงูุถุจุท ูุถูู ูุชุบูุฑ ุฅุถุงูู ูููููุฐุฌ ูุฑูุฒ ูู $ \lambda $ ูุงูุฐู ูููู ุจุถุจุทุฉ ุจุฅุณุชุฎุฏุงู ุงูุชุญูู ุงููุชูุงุทุน.

## ุงูุถุจุท L1: ุฅูุญุฏุงุฑ ุงูููู

### ุชุนุฑูู ุงูุถุจุท

### ุงูููุงุฑูุฉ ุจูู ุฅูุญุฏุงุฑ Ridge ูุงูููู

### ุงุฎุชูุงุฑ ุงูุฎุตุงุฆุต ูุน ุฅูุญุฏุงุฑ ุงูููู

### ุงูุฌุจูู ร ุงูููู ุนูููุงู

### ููุฎุต ุฅูุญุฏุงุฑ ุงูููู




[RidgeRegression]: https://www.youtube.com/watch?v=Q81RR3yKn30
[StandardizationNormalization]: https://www.kdnuggets.com/2020/04/data-transformation-standardization-normalization.html
[StandardizationNormalization2]: https://www.analyticsvidhya.com/blog/2020/04/feature-scaling-machine-learning-normalization-standardization/