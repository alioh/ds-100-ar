---
title: ุชูุธูู ุงูุจูุงูุงุช
show_title: true
chapter_number: 5
chapter_text: ุงููุตู ุงูุฎุงูุณ
chapter_lessons: [[0, 'ููุฏูุฉ'], [1, 'ูุธุฑู ุนูู ุจูุงูุงุช ุดุฑุทุฉ ูุฏููุฉ ุจูุฑููู'],[2, 'ุชูุธูู ุจูุงูุงุช ุงูููุงููุงุช'], [3, 'ุชูุธูู ุจูุงูุงุช ุงูุฅููุงูุงุช'], [4, 'ุดูู ูุชุฌููุน ุงูุจูุงูุงุช'], [5, 'ุชูุณูู ุงูุจูุงูุงุช'], [6, 'ูุฏู ุงูุจูุงูุงุช'], [7, 'ุฒูุงููุฉ ุงูุจูุงูุงุช'], [8 , 'ูุฏู ุซูุชูุง ุจุงูุจูุงูุงุช']]
chapter_sublessons: [
    [],
    [],
    ['ููู ุชูููุฏ ุงูุจูุงูุงุช', 'ุชูุธูู ุงูุจูุงูุงุช', 'ูู ุชูุฌุฏ ุจูุงูุงุช ููููุฏูุ', 'ูู ุชูุฌุฏ ุฃู ุจูุงูุงุช ููููุฏู ุชู ุชุนุจุฆุชูุงุ', 'ุงู ุฌุฒุก ูู ุงูุจูุงูุงุช ุงุฏุฎูุช ุจูุงุณุทุฉ ุงุดุฎุงุต ุญูููููุ', 'ููุณุงุช ุงุฎูุฑู'],
    ['ูู ุชูุฌุฏ ุจูุงูุงุช ููููุฏู ุ', 'ูู ุชูุฌุฏ ุฃู ุจูุงูุงุช ููููุฏู ุชู ุชุนุจุฆุชูุง ุ', 'ุงู ุฌุฒุก ูู ุงูุจูุงูุงุช ุงุฏุฎูุช ุจูุงุณุทุฉ ุงุดุฎุงุต ุญููููู ุ'],
    ['ุดูู ุงูุจูุงูุงุช', 'ุงูุชุฌููุน', 'ูุงุฆูุฉ ุงููุฑุงุฌุนู ูุดูู ุงูุจูุงูุงุช'],
    ['ุชูุณูู ุงูุจูุงูุงุช', 'ูุงุฆูุฉ ุงููุฑุงุฌุนู ูุชูุณูู ุงูุจูุงูุงุช'],
    [],
    [],
    []
]
layout: default
---

## ููุฏูุฉ

ุชุฃุชู ุงูุจูุงูุงุช ุจุนุฏุฉ ุงุดูุงู ูุชุชููุน ูู ุญูุซ ูุงุฆุฏุชูุง ูู ุงูุชุญููู. ุฑุบู ุงููุง ูุณุนู ุงู ุชููู ุฌููุน ุงูุจูุงูุงุช ุนูู ุดูู ุฌุฏูู ููู ูููู ุงุฏุฎู ุจุดูู ูุณุชูุฑ ูุฏูููุ ูู ุงูุญูููู ูุฌุจ ุนูููุง ุงูุชุญูู ุจุดูู ุฏูููู ุนู ุงููุดุงูู ุงูุชู ูุฏ ุชููุฏูุง ููุชุงุฆุฌ ุบูุฑ ุตุญูุญู.

ุงููุตุทูุญ "ุชูุธูู ุงูุจูุงูุงุช" ูุทูู ุนูู ุฎุทูุฉ ุงูุชุญูู ูู ุงูุจูุงูุงุช ูุงุชุฎุงุฐ ูุฑุงุฑุงุช ุนู ููููุฉ ุฅุตูุงุญ ุงูุงุฎุทุงุก ูุงูุจูุงูุงุช ุงูููููุฏู. ุณููุงูุด ุงูุซุฑ ุงููุดุงูู ุงูุดุงุฆุนู ูู ุงูุจูุงูุงุช ููุดุฑุญูุง ุจุดูู ุงูุถุญ.

ุชูุธูู ุงูุจูุงูุงุช ูู ุจุนุถ ุงููููุฏ. ูุซูุงูุ ูุง ููุฌุฏ ุชูุธูู ุจุฃููุงูู ุชุญุณูู ุนููุงุช ุชู ุงุฎุฐูุง ุจุดูู ูุชุญูุฒ. ูุจู ุงูุจุฏุก ุจูุดูุงุฑ ุชูุธูู ุงูุจูุงูุงุช ุงูุฐู ุนุงุฏู ูุง ูููู ุทูููุงูุ ูุฌุจ ุงู ูุชุฃูุฏ ุงู ุจูุงูุงุชูุง ุชู ุฌูุนูุง ุจุดูู ุฏููู ูุจุฏูู ุชุญูุฒ. ูู ุฐูู ุงูุญูู ูููููุง ุจุฏุฃ ุงูุชุญูู ูู ุงูุจูุงูุงุช ูุชูุธูููุง ููุชุฎูุต ูู ุงููุดุงูู ูู ุงููุงุน ุงูุจูุงูุงุช ุงู ุทุฑู ุงูุงุฏุฎุงู.

ุณูููู ุจุดุฑุญ ุทูุฑู ูุชูุธูู ุงูุจูุงูุงุช ูุณูุณุชุฎุฏู ุจูุงูุงุช ุดุฑุทุฉ ูุฏููุฉ ุจูุฑููู.


## ูุธุฑู ุนูู ุจูุงูุงุช ุดุฑุทุฉ ูุฏููุฉ ุจูุฑููู

ุณูุณุชุฎุฏู ุจูุงูุงุช ุดุฑุทุฉ ูุฏููุฉ ุจูุฑููู ุงูููุดูุฑู ููุนุงูู ูุดุฑุญ ุทุฑู ุชูุธูู ุงูุจูุงูุงุช. ูููู ุชุญููู ุจูุงูุงุช ุงูููุงููุงุช ูู [ููุง](https://data.cityofberkeley.info/Public-Safety/Berkeley-PD-Calls-for-Service/k2nh-s5h5)ุ ูุจูุงูุงุช ุงูุฅููุงูุงุช ูู [ููุง](https://data.cityofberkeley.info/Public-Safety/Berkeley-PD-Stop-Data/6e9j-pj9p).

> ุฑูุงุจุท ุงุฎุฑู ูุชุญููู ุงูุจูุงูุงุช:
> - [ุจูุงูุงุช ุงูููุงููุงุช]({{ site.baseurl }}/files/chapter5/Berkeley_PD_-_Calls_for_Service.csv).
> - [ุจูุงูุงุช ุงูุฅููุงูุงุช]({{ site.baseurl }}/files/chapter5/stops.json).

ุณูุณุชุฎุฏู ุงูุงูุฑ `ls` ูุน `-lh` ูุนุฑุถ ูุนูููุงุช ุฃูุซุฑ ุนู ุงููููุงุช:

```python
!ls -lh data/
```

```ruby
total 13936
-rw-r--r--@ 1 sam  staff   979K Aug 29 14:41 Berkeley_PD_-_Calls_for_Service.csv
-rw-r--r--@ 1 sam  staff    81B Aug 29 14:28 cvdow.csv
-rw-r--r--@ 1 sam  staff   5.8M Aug 29 14:41 stops.json
```

ูุธูุฑ ููุง ุงูุฃูุฑ ุงูุณุงุจู ุงููููุงุช ูู ุงููุฌูุฏ ูุงุญุฌุงููุง. ุงูุฃูุฑ ููู ูุฃูู ูุจูู ููุง ุฃู ุงููููุงุช ุตุบูุฑุฉ ุงูุญุฌู ููููู ุชุญููููุง ุนูู ุฐุงูุฑุฉ ุญุงุณุจูุง. ูุงุนุฏู ุนุงููุ ูููู ุชุญููู ุงููููุงุช ุจุดูู ุขูู ุนูุฏูุง ูููู ุญุฌููุง ุญูุงูู ุฑุจุน ุญุฌู ุงูุฐุงูุฑุฉ ูู ุงูุญุงุณุจ. ูุซูุงูุ ุงุฐุง ูุงู ุฌูุงุฒูุง ูุญุชูู ุนูู 4 ุฌ.ุจ. ูู ุงูุฐุงูุฑุฉ ุงูุนุดูุงุฆููุ ูููููุง ุชุญููู ููู CSV ุจุญุฌู 1 ุฌ.ุจ ูู ุจุงูุฏุงุฒ. ููุชุญูู ุญุงุณุจูุง ูููุงุช ุจุญุฌู ุฃูุจุฑ ูุฌุจ ุนูููุง ุงุณุชุฎุฏุงู ุงุฏูุงุช ุฎุงุตู ูุณูุชุญุฏุซ ูุงุญูุงู ุนููุง ูู ูุฐุง ุงููุชุงุจ.

ูุงุญุธ ุงุณุชุฎุฏุงููุง ูุนูุงูุฉ ุงูุชุนุฌุจ ูุจู `ls`. ูุฐุง ูุฎุจุฑ ุฌูุจุชุฑ ุงู ุงูููุฏ ุงูุจุฑูุฌู ุงูุชุงูู ุฎุงุต ุจูุชุฑุฌู ุงูุดููุ ูููุณ ุจุงูุซูู. ูุซุงู ุขุฎุฑ:

```python
# ุงูุงูุฑ `wc` ูุธูุฑ ุนุฏุฏ ุงูุงุณุทุฑ ูู ูู ููู.
# ูููู ุงู ููุงุญุธ ุงู ููู `stops.json` ูุญุชูู ุนูู ุนุฏุฏ (29852) ุณุทุฑ.
!wc -l data/*
```

```ruby
   16497 data/Berkeley_PD_-_Calls_for_Service.csv
       8 data/cvdow.csv
   29852 data/stops.json
   46357 total
```

## ุชูุธูู ุจูุงูุงุช ุงูููุงููุงุช

### ููู ุชูููุฏ ุงูุจูุงูุงุช

ุณูููู ุจุฐูุฑ ุจุนุถ ุงูุฃุณุฆูู ุงูุชู ูุฌุจ ุฃู ุชุชุญูู ูููุง ูู ุฌููุน ุจูุงูุงุชู ูุจู ุงูุจุฏุก ุจุชูุธูููุง ููุนุงูุฌุชูุง. ูุฐู ุงูุฃุณุฆูู ุนู ููู ุชู ุชูููุฏ ูุฅูุดุงุก ูุฐู ุงูุจูุงูุงุชุ ูู ูุฐู ุงูุฎุทูู ุชูุธูู ุงูุจูุงูุงุช **ูู** ูุณุงุนุฏูุง ุนูู ุญู ุงููุดุงูู ุงูุชู ุญุตูุช ุงุซูุงุก ุฅูุดุงุก ุงูุจูุงูุงุช.

**ุนูู ูุงุฐุง ุชุญุชูู ุงูุจูุงูุงุชุ** ุงููููุน ุงูุฐู ุชู ุงุฎุฐ ุจูุงูุงุช ุงูููุงููุงุช ููู ูุฐูุฑ ุงู "ุงูุฌุฑุงุฆู/ุงูุญูุงุฏุซ (ูููุณ ุชูุงุฑูุฑ ุงูุฌุฑุงุฆู) ุงูุชู ุญุฏุซุช ูู ุงู180 ููู ุงูุณุงุจูู". ูุฒูุฏ ูู ุงููุฑุงุกู ูู ุงููููุน ุงูุถุญุช ุงูุชุงูู "ููุณ ุฌููุน ุงูููุงููุงุช ุงูุชู ุทูุจุช ุฎุฏูุงุช ุงูุดุฑุทู ุชู ุงุถุงูุชูุง (ูุซู ุนุถุฉ ุญููุงู)".

ูููุน ุจูุงูุงุช ุงูุฅููุงูุงุช ููุถุญ ุงู ุงูุจูุงูุงุช ุชุญุชูู ุนูู ุฌููุน "ุงูุณูุงุฑุงุช ุงููุญุชุฌุฒู (ุจูุง ูููุง ุงูุฏุฑุงุฌุงุช ุงูููุงุฆูุฉ) ูุฅุนุชูุงูุงุช ุงููุดุงู (ุญุชู ุฎูุณ ุงุดุฎุงุต)" ููุฐ 26 ููุงูุฑ 2015.

**ูู ุงูุจูุงูุงุช ุชุนุฏุงุฏ / ุงุญุตุงุก ููุณูุงูุ** ูุฐุง ูุนุชูุฏ ุนูู ุนุฏุฏ ูุฌุชูุนูุง ุงูุฅุญุตุงุฆู. ูุซูุงูุ ุงุฐุง ููุง ููุชููู ุจููุงููุงุช ุทูุจ ุงูุฎุฏูุงุช ูุขุฎุฑ 180 ููู ููุญูุงุฏุซ ูุงูุฌุฑุงุฆูุ ูุฃู ุจูุงูุงุช ุงูููุงููุงุช ุชุนุชุจุฑ ูุฐูู. ูููู ุงุฐุง ุงุฑุฏูุง ุงูููุงููุงุช ูุทูุจ ุฎุฏูุงุช ุงูุดุฑุทุฉ ููุนุดุฑ ุณููุงุช ุงูุณุงุจูุฉุ ูุฃู ุงูุจูุงูุงุช ููุณุช ุชุนุฏุงุฏ ููุงุณุจ. ูููููุง ููู ููุณ ุงูููุงู ุนูู ุจูุงูุงุช ุงูุฅููุงูุงุช ููุง ุงู ุงูุจูุงูุงุช ุชู ุฌูุนูุง ุฅุจุชุฏุงุกูุง ูู 26 ููุงูุฑ 2015.

**ุงุฐุง ูุงูุช ุงูุจูุงูุงุช ุชูุดูู ุนูููุ ูู ูู ุนููุฉ ุงูุฅุญุชูุงูุงุชุ** ุงูุจูุงูุงุช ูุง ุชูุซู ุนููุฉ ุงูุฅุญุชูุงูุงุช ูุฃููุง ูุง ุชุธูุฑ ุงู ุนุดูุงุฆูู ูู ุทุฑููุฉ ุฌูุน ุงูุจูุงูุงุช. ูุฏููุง ุจูุงูุงุช ูุงููู ููุชุฑู ูุนููู ููุท ูููุณ ููุชุฑุงุช ุฃุฎุฑู.

**ูู ููุงู ูููุฏ ุณุชุฌุจุฑูุง ุนููู ุงูุจูุงูุงุช ูู ูุชุงุฆุฌูุงุ** ุฑุบู ุงููุง ุณูุณุฃู ูุฐุง ุงูุณุคุงู ุจุนุฏ ูู ุฎุทูู ูู ุฎุทูุงุชูุงุ ูููููุง ููุงุญุธุฉ ุงู ุจูุงูุงุชูุง ุชุธูุฑ ููุง ุจุนุถ ุงููููุฏ. ุฃูู ุงููููุฏ ุงูุชู ุชุธูุฑูุง ููุง ูู ุงููุง ูุง ูููููุง ุงูููุงู ุจุฃู ุชูุฏูุฑุงุช ุบูุฑ ูุชุญูุฒู ูููุชุฑุงุช ุงูุชู ูู ูุชู ุชุณุฌูููุง ูู ุงูุจูุงูุงุช.

### ุชูุธูู ุงูุจูุงูุงุช

ููุจุฏุฃ ุงูุขู ุจุชูุธูู ุจูุงูุงุช ุงูููุงููุงุช. ุงูุฃูุฑ `head` ูุธูุฑ ููุง ุฃูู ุฎูุณ ุงุณุทุฑ ูู ุงูููู:

```python
!head data/Berkeley_PD_-_Calls_for_Service.csv
```

```ruby
CASENO,OFFENSE,EVENTDT,EVENTTM,CVLEGEND,CVDOW,InDbDate,Block_Location,BLKADDR,City,State
17091420,BURGLARY AUTO,07/23/2017 12:00:00 AM,06:00,BURGLARY - VEHICLE,0,08/29/2017 08:28:05 AM,"2500 LE CONTE AVE
Berkeley, CA
(37.876965, -122.260544)",2500 LE CONTE AVE,Berkeley,CA
17020462,THEFT FROM PERSON,04/13/2017 12:00:00 AM,08:45,LARCENY,4,08/29/2017 08:28:00 AM,"2200 SHATTUCK AVE
Berkeley, CA
(37.869363, -122.268028)",2200 SHATTUCK AVE,Berkeley,CA
17050275,BURGLARY AUTO,08/24/2017 12:00:00 AM,18:30,BURGLARY - VEHICLE,4,08/29/2017 08:28:06 AM,"200 UNIVERSITY AVE
Berkeley, CA
(37.865491, -122.310065)",200 UNIVERSITY AVE,Berkeley,CA
```

ูุธูุฑ ุฃู ุงูููู ูู ุงูููุน CSVุ ูููู ูู ุงูุตุนุจ ูุนุฑูู ูุง ุงุฐุง ูุงู ุฌููุน ูุญุชูู ุงูููู ููุณู ุจุทุฑููู ุตุญูุญู. ูููููุง ุงุณุชุฎุฏุงู ุงูุฏุงูู `pd.read_csv` ููุฑุงุกุฉ ุงูููู ู DataFrame. ุฅุฐุง ุงุธูุฑ ุงูุฃูุฑ `pd.read_csv` ุงุฎุทุงุกุ ููุฌุจ ุนูููุง ุงูุจุญุซ ุจุดูู ุงุนูู ูุญู ุงููุดููู ูุฏููุงู. ูุญุณู ุงูุญุธุ ูุงูุช ุงูุฏุงูู ุจูุฑุงุกุฉ ุงูููู ุจุดูู ุตุญูุญ ุนูู ุดูู DataFrame:

```python
calls = pd.read_csv('data/Berkeley_PD_-_Calls_for_Service.csv')
calls
```

**State**|**City**|**BLKADDR**|**Block\_Location**|**...**|**EVENTTM**|**EVENTDT**|**OFFENSE**|**CASENO**||
:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:
CA|Berkeley|2500 LE CONTE AVE|2500 LE CONTE AVE\nBerkeley, CA\n(37.876965, -...|...|06:00|07/23/2017 12:00:00 AM|BURGLARY AUTO|17091420|0
CA|Berkeley|2200 SHATTUCK AVE|2200 SHATTUCK AVE\nBerkeley, CA\n(37.869363, -...|...|08:45|04/13/2017 12:00:00 AM|THEFT FROM PERSON|17020462|1
CA|Berkeley|200 UNIVERSITY AVE|200 UNIVERSITY AVE\nBerkeley, CA\n(37.865491, ...|...|18:30|08/24/2017 12:00:00 AM|BURGLARY AUTO|17050275|2
...|...|...|...|...|...|...|...|...|...
CA|Berkeley|1600 FAIRVIEW ST|1600 FAIRVIEW ST\nBerkeley, CA\n(37.850001, -1...|...|12:22|04/01/2017 12:00:00|DISTURBANCE|17018126|5505
CA|Berkeley|2000 DELAWARE ST|2000 DELAWARE ST\nBerkeley, CA\n(37.874489, -1...|...|12:00|04/01/2017 12:00:00|THEFT MISD. (UNDER $950)|17090665|5506
CA|Berkeley|2400 TELEGRAPH AVE|2400 TELEGRAPH AVE\nBerkeley, CA\n(37.866761, ...|...|20:02|08/22/2017 12:00:00 AM|SEXUAL ASSAULT MISD.|17049700|5507

```center-result
5508 rows ร 11 columns
```

ูููููุง ูุชุงุจุฉ ุฏุงูู ุชููู ุจุฅุธูุงุฑ ุงุฌุฒุงุก ูู ุงูุจูุงูุงุช:

```python
def df_interact(df):
    def peek(row=0, col=0):
        return df.iloc[row:row + 5, col:col + 6]
    interact(peek, row=(0, len(df), 5), col=(0, len(df.columns) - 6))
    print('({} rows, {} columns) total'.format(df.shape[0], df.shape[1]))

df_interact(calls)
```

> ุงูููุฏ ุงูุจุฑูุฌู ุงูุณุงุจู ูููุชูุฌ ููุง ุฌุฏูู ุชูุงุนูู ููุง ูู ุงูุตูุฑู ุฃุฏูุงูุ ูุญุชูู ุจุดูู ุชููุงุฆู ุนูู ุงู6 ุงุณุทุฑ ุงูุฃููู ู ุฃูู 6 ุนูุงููุฏ.
> ุนูุฏ ุชุญุฑูู ุงูููู ุจุงูุฃุนูู Row ุณุชุธูุฑ ููุง ุงูุฎูุณ ุงุณุทุฑ ุจุนุฏ ุงููููู ุงูุชู ุงุฎุชุฑูุงูุงุ ูุซูุงู ูู ุงูุตูุฑู ุงุฏูุงู ุงุฎุชุฑุช ุงููููู 815 ูุฃุธูุฑ ููุง ุงูุฃุณุทุฑ ูู 815 ุญุชู 819.
> ุจููุณ ุงูุทุฑููุฉ ููุฎูุงุฑ Colุ ุชุธูุฑ ููุง ุงูุณุช ุนูุงููุฏ ุจุนุฏ ุงูุนุงููุฏ ุงูุฐู ูุฎุชุงุฑูุ ููุง ุงุฎุชุฑุช ุงูุนุงููุฏ 2 ูุฃุธูุฑ ููุง ุงูุนุงููุฏ ุงูุซุงูุซ ุญุชู ุงูุชุงุณุน.
> ุชุฐูุฑ ุฏุงุฆูุงู ุงูู ุงูุญุณุงุจ ูู ุงูุฌุฏุงูู / ุจุงูุซูู ูุจุฏุฃ ูู 0. 


<p align="center"> 
<img src='{{ site.baseurl }}/img/chapter5/df_interact.png'>
</p>

```ruby
(5508 rows, 11 columns) total
```

ุจูุงุกูุง ุนูู ุงููุชุงุฆุฌ ูู ุงูุฃุนููุ ุชุจุฏู ุงูุจูุงูุงุช ูุฑุชุจู ุจุดูู ููุงุณุจ ุจูุง ุงู ุงูุนูุงููุฏ ููุณูุงู ุจุดูู ุตุญูุญ ูุงูุจูุงูุงุช ูู ูู ุนุงููุฏ ูุฏุฎูู ุจุดูู ูุชูุงุณู. ูุงุฐุง ูุญุชูู ูู ุนุงููุฏุ ูููููุง ุงูุชุญูู ูู ุฐูู ุจูููุน ุงูุจูุงูุงุช:

**ุงูููุน**|**ุงููุตู**|**ุงูุนุงููุฏ**
:-----:|:-----:|:-----:
ุฑูู|ุฑูู ุงููุถูู|CASENO
ูุต|ููุน ุงููุฎุงููู|OFFENSE
ุชุงุฑูุฎ + ููุช|ุชุงุฑูุฎ ุงูุญุฏุซ|EVENTDT
ูุต|ููุช ุงูุญุฏุซ|EVENTTM
ูุต|ุชูุงุตูู ุงูุญุฏุซ|CVLEGEND
ุฑูู|ุฃู ููู ุจุงูุงุณุจูุน ุญุฏุซุช ููู ุงููุฎุงููู|CVDOW
ุชุงุฑูุฎ + ููุช|ุชุงุฑูุฎ ูููุช ุชุญุฏูุซ ุงููุฎุงููู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช|InDbDate
Location|ุนููุงู ุงููุฎุงููู|Block\_Location
ูุต| |BLKADDR
ูุต| |City
ูุต| |State

ูุฏ ุชุจุฏู ุงูุจูุงูุงุช ุณููุฉ ุงูุชุญููู. ูููู ูุจู ุงูุจุฏุก ุจุฐููุ ูุฌุจ ุฃู ูุฌูุจ ุนู ุงูุฃุณุฆูู ุงูุชุงููู:
1- **ูู ุชูุฌุฏ ุจูุงูุงุช ููููุฏูุ** ุงูุณุคุงู ููู ูุฃู ุงูุจูุงูุงุช ุงูููููุฏู ูุฏ ุชููู ูุนุฏุฉ ุงุณุจุงุจ. ูุซูุงูุ ุนูุงููู ููููุฏู ูุฏ ูููู ุญุฐููุง ุจุณุจุจ ุญูุงูุฉ ุฎุตูุตูุฉ ุงูุฃุดุฎุงุตุ ุฃู ุฃู ุงุญุฏ ุงููุจุงุดุฑูู ููุฐู ุงููุฎุงููู ุฑูุถ ุงูุฅุฌุงุจู ุนูู ูุฐุง ุงูุณุคุงูุ ุงู ุจุณุจุจ ุญุฏูุซ ูุดุงูู ูู ุฌูุงุฒ ุงูุชุณุฌูู.
2- **ูู ุชูุฌุฏ ุฃู ุจูุงูุงุช ููููุฏู ุชู ุชุนุจุฆุชูุงุ ( ูุซูุงู ูุชุงุจุฉ ุฑูู 999 ูุนูุฑ ูุฌููู ุฃู 12:00 ุตุจุงุญุงู ูุชุงุฑูุฎ ูุฌููู)ุ** ุจุงูุชุฃููุฏ ุณุชุฃุซุฑ ูุฐู ุนูู ุชุญููููุง ุฅุฐุง ุชุฌุงูููุงูุง.
3- **ุงู ุฌุฒุก ูู ุงูุจูุงูุงุช ุงุฏุฎูุช ุจูุงุณุทุฉ ุงุดุฎุงุต ุญูููููุ** ููุง ุณูุฑู ุจุนุฏ ููููุ ุงูุจูุงูุงุช ุงูุชู ูุชู ุงุฏุฎุงููุง ูู ุงูุจุดุฑ ุชุญุชูู ุนูู ุงููุซูุฑ ูู ุงูุชูุงูุถุงุช ูุงูุฃุฎุทุงุก ุงูุฅููุงุฆูู.

ุฑุบู ุงู ููุงู ุงููุซูุฑ ูู ุงููุดุงูู ุงูุชู ูุฌุจ ุงู ูุชุญูู ูููุงุ ูุฐู ุงููุดุงูู ุงูุซูุงุซู ูู ุงูุฃูุซุฑ ุชูุฑุงุฑุงู ูู ุฌููุน ุงูุจูุงูุงุช. ููููู ูุฑุงุฌุนุฉ [Quartz](https://github.com/Quartz/bad-data-guide) ูุฅุณุชุนุฑุงุถ ูุงุฆูุฉ ูู ุงููุดุงูู ุงูุชู ูุญุชุงุฌ ููุชุญูู ูููุง ูู ุงูุจูุงูุงุช ูุจู ุงูุจุฏุก ุจุงูุชุญููู.

### ูู ุชูุฌุฏ ุจูุงูุงุช ููููุฏูุ

ูุฐู ุงูุฎุทูู ุณููู ุงูุชุญูู ูู ุจุงูุฏุงุฒ ุนู ุทุฑูู ุงูููุฏ ุงูุจุฑูุฌู ุงูุชุงูู:

```python
# ุณุชุธูุฑ ููุง ุงูุฃุณุทุฑ ุงูุชู ุชุญุชูู ุนูู ุงูุงูู ุนูู ูููู ูุงุญุฏู ููููุฏู
null_rows = calls.isnull().any(axis=1)
calls[null_rows]
```

**State**|**City**|**BLKADDR**|**Block\_Location**|**...**|**EVENTTM**|**EVENTDT**|**OFFENSE**|**CASENO**| |
:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:
CA|Berkeley|NaN|Berkeley, CA\n(37.869058, -122.270455)|...|22:00|03/16/2017 12:00:00 AM|BURGLARY AUTO|17014831|116
CA|Berkeley|NaN|Berkeley, CA\n(37.869058, -122.270455)|...|16:00|07/20/2017 12:00:00 AM|BURGLARY AUTO|17042511|478
CA|Berkeley|NaN|Berkeley, CA\n(37.869058, -122.270455)|...|21:00|04/22/2017 12:00:00 AM|VEHICLE STOLEN|17022572|486
...|...|...|...|...|...|...|...|...|...
CA|Berkeley|NaN|Berkeley, CA\n(37.869058, -122.270455)|...|08:00|07/01/2017 12:00:00|VANDALISM|17091287|4945
CA|Berkeley|NaN|Berkeley, CA\n(37.869058, -122.270455)|...|15:00|06/30/2017 12:00:00 AM|BURGLARY RESIDENTIAL|17038382|4947
CA|Berkeley|NaN|Berkeley, CA\n(37.869058, -122.270455)|...|23:30|08/15/2017 12:00:00 AM|VANDALISM|17091632|5167

```center-result
27 rows ร 11 columns
```

ูุธูุฑ ููุง 27 ูุง ุชุญุชูู ุนูู ุนูุงููู ูู ุงูุนุงููุฏ `BLKADDR`. ูุณูุก ุงูุญุธุ ูุง ูุธูุฑ ููุง ูู ุดุฑุญ ุงูุจูุงูุงุช ุงู ูุนูููู ุนู ุทุฑููุฉ ุญูุธ ูุนูููุงุช ุงูุนููุงู. ูุนุฑู ุฃู ุฌููุน ุงูุจูุงูุงุช ูุฃุญุฏุงุซ ุชูุช ูู ูุฏููุฉ ุจูุฑูููุ ูุฐุง ูููููุง ุงูุงูุชุฑุงุถ ุงู ุฌููุน ุงูููุงููุงุช ูุงูุช ูุนูุงููู ูู ููุงู ูุง ูู ุจูุฑููู.

### ูู ุชูุฌุฏ ุฃู ุจูุงูุงุช ููููุฏู ุชู ุชุนุจุฆุชูุงุ

ูู ุงููุชูุฌู ุงูุณุงุจูู ููุงุญุธ ุงู ุงูุนุงููุฏ `Block_Location` ูุญุชูู ุนูู ุงููููู `Berkeley, CA` ุงุฐุง ูุงู ุงููููู ูู ุงูุนุงููุฏ `BLKADDR` ููููุฏู.

ุฃูุถุงูุ ุงูุชุญูู ูู ุงูุฌุฏูู ุงุธูุฑ ููุง ุงู ุงูุนุงููุฏ `EVENTDT` ูุญุชูู ุนูู ุงูุชุงุฑูุฎ ุจุดูู ุตุญูุญ ูููู ูู ูู ุงูุฃุณุทุฑ ุชู ุชุณุฌูู ุงูููุช `12am`ุ ุงูููุช ุงูุญูููู ูู ุงูุนุงููุฏ `EVENTTM`. ููุชุญูู ูู ุงูุชุดููุงู:

```python
# ุงุธูุงุฑ ุงูู ุณุจุน ุงุณุทุฑ
calls.head(7)
```

**State**|**City**|**BLKADDR**|**Block\_Location**|**...**|**EVENTTM**|**EVENTDT**|**OFFENSE**|**CASENO**||
:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:
CA|Berkeley|2500 LE CONTE AVE|2500 LE CONTE AVE\nBerkeley, CA\n(37.876965, -...|...|06:00|07/23/2017 12:00:00 AM|BURGLARY AUTO|17091420|0
CA|Berkeley|2200 SHATTUCK AVE|2200 SHATTUCK AVE\nBerkeley, CA\n(37.869363, -...|...|08:45|04/13/2017 12:00:00 AM|THEFT FROM PERSON|17020462|1
CA|Berkeley|200 UNIVERSITY AVE|200 UNIVERSITY AVE\nBerkeley, CA\n(37.865491, ...|...|18:30|08/24/2017 12:00:00 AM|BURGLARY AUTO|17050275|2
CA|Berkeley|1900 SEVENTH ST|1900 SEVENTH ST\nBerkeley, CA\n(37.869318, -12...|...|17:30|04/06/2017 0:00|GUN/WEAPON|17019145|3
CA|Berkeley|100 PARKSIDE DR|100 PARKSIDE DR\nBerkeley, CA\n(37.854247, -12...|...|18:00|08/01/2017 0:00|VEHICLE STOLEN|17044993|4
CA|Berkeley|1500 PRINCE ST|1500 PRINCE ST\nBerkeley, CA\n(37.851503, -122...|...|12:00|06/28/2017 12:00:00 AM|BURGLARY RESIDENTIAL|17037319|5
CA|Berkeley|300 MENLO PL|300 MENLO PL\nBerkeley, CA\n|...|08:45|05/30/2017 12:00:00 AM|BURGLARY RESIDENTIAL|17030791|6

```center-result
7 rows ร 11 columns
```

ูุฎุทูุฉ ุชูุธููุ ูุฑูุฏ ุงู ูุฌูุน ุงูุนุงููุฏูู `EVENTDT` ู `EVENTTM` ููุญุชูู ุนูู ุงูุชุงุฑูุฎ ูุงูููุช ูู ุนุงููุฏ ูุงุญุฏ. ุงุฐุง ูููุง ุจูุชุงุจุฉ ุฏุงูู ุชุณุชูุจู DataFrame ูุชูุดุฃ ุฃุฎุฑูุ ููููููุง ูุงุญููุง ุฅุณุชุฎุฏุงู `pd.pipe` ูุชุทุจูู ุฐูู ุนูู ุฌููุน ุงูููู: [๐][pd_pipe]

```python
def combine_event_datetimes(calls):
    combined = pd.to_datetime(
        # ุฌูุน ุงูุชุงุฑูุฎ ูุงูููุช ุนูู ุดูู ูุต
        calls['EVENTDT'].str[:10] + ' ' + calls['EVENTTM'],
        infer_datetime_format=True,
    )
    return calls.assign(EVENTDTTM=combined)

# ูุนุฑุถ ุงููุชุงุฆุฌ ูุจู ุงูุชุนุฏูู ุนูู ุงู DataFrame
calls.pipe(combine_event_datetimes).head(2)
```

**EVENTDTTM**|**State**|**City**|**BLKADDR**|**...**|**EVENTTM**|**EVENTDT**|**OFFENSE**|**CASENO**| |
:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:
23/07/2017 06:00:00|CA|Berkeley|2500 LE CONTE AVE|...|06:00|07/23/2017 12:00:00 AM|BURGLARY AUTO|17091420|0
2017-04-13 08:45:00|CA|Berkeley|2200 SHATTUCK AVE|...|08:45|04/13/2017 12:00:00 AM|THEFT FROM PERSON|17020462|1

```center-result
2 rows ร 12 columns
```

### ุงู ุฌุฒุก ูู ุงูุจูุงูุงุช ุงุฏุฎูุช ุจูุงุณุทุฉ ุงุดุฎุงุต ุญูููููุ

ูุจุฏู ุฃู ุงููุซูุฑ ูู ุงูุนูุงููุฏ ุชู ุงุฏุฎุงููุง ุจุดูู ุชููุงุฆู ุจูุงุณุทุฉ ุงูุขููุ ุจูุง ูู ุฐูู ุงูุชุงุฑูุฎุ ุงูููุชุ ุงูููู ูู ุงูุฃุณุจูุนุ ูุนููุงู ุงูุญุงุฏุซู.

ุงูุถุงูุ ุงูุนุงููุฏ `OFFENSE` ู `CVLEGEND` ูุจุฏู ุงููุง ุชุญุชูู ุนูู ุจูุงูุงุช ุซุงุจุชู. ูููููุง ุงูุชุญูู ูู ุงูููู ุงููุฏุฎูู ูู ูู ุนุงููุฏ ููุชุญูู ุงู ูุงู ููุงู ุงู ููู ุชุญุชูู ุนูู ุงุฎุทุงุก ุงููุงุฆูู:

```python
calls['OFFENSE'].unique()
```

```ruby
array(['BURGLARY AUTO', 'THEFT FROM PERSON', 'GUN/WEAPON',
       'VEHICLE STOLEN', 'BURGLARY RESIDENTIAL', 'VANDALISM',
       'DISTURBANCE', 'THEFT MISD. (UNDER $950)', 'THEFT FROM AUTO',
       'DOMESTIC VIOLENCE', 'THEFT FELONY (OVER $950)', 'ALCOHOL OFFENSE',
       'MISSING JUVENILE', 'ROBBERY', 'IDENTITY THEFT',
       'ASSAULT/BATTERY MISD.', '2ND RESPONSE', 'BRANDISHING',
       'MISSING ADULT', 'NARCOTICS', 'FRAUD/FORGERY',
       'ASSAULT/BATTERY FEL.', 'BURGLARY COMMERCIAL', 'MUNICIPAL CODE',
       'ARSON', 'SEXUAL ASSAULT FEL.', 'VEHICLE RECOVERED',
       'SEXUAL ASSAULT MISD.', 'KIDNAPPING', 'VICE', 'HOMICIDE'], dtype=object)
```

```python
calls['CVLEGEND'].unique()
```

```ruby
array(['BURGLARY - VEHICLE', 'LARCENY', 'WEAPONS OFFENSE',
       'MOTOR VEHICLE THEFT', 'BURGLARY - RESIDENTIAL', 'VANDALISM',
       'DISORDERLY CONDUCT', 'LARCENY - FROM VEHICLE', 'FAMILY OFFENSE',
       'LIQUOR LAW VIOLATION', 'MISSING PERSON', 'ROBBERY', 'FRAUD',
       'ASSAULT', 'NOISE VIOLATION', 'DRUG VIOLATION',
       'BURGLARY - COMMERCIAL', 'ALL OTHER OFFENSES', 'ARSON', 'SEX CRIME',
       'RECOVERED VEHICLE', 'KIDNAPPING', 'HOMICIDE'], dtype=object)
```

ุจูุง ุงู ูู ูููู ูุจุฏู ุงููุง ุงุฏุฎูุช ุจุดูู ุตุญูุญุ ูู ูุญุชุงุฌ ููููุงู ุจุฃู ุชุนุฏููุงุช ุนูู ุงูุนุงููุฏุงู.

ุชุญูููุง ุงูุถุงู ูู ุงูุนุงููุฏ `BLKADDR` ุงู ูุงู ูุญุชูู ุนูู ุงู ุชูุงูุถุงุช ููุฌุฏูุง ุงู ุงูุนูุงููู ุงุฏุฎูุช ูู ุจุนุถ ุงููุฑุงุช ุนูู ุงูุดูู ุงูุชุงูู `2500 LE CONTE AVE` ูุนููุงู ูุงูู ููู ุจุนุถ ูุฑุงุช ุงุฎุฑู ุณุฌู ุงูุนููุงู ูุชูุงุทุน ุดุงุฑุนูู ูุซู `ALLSTON WAY & FIFTH ST`. ูุดูุฑ ุฐูู ุงู ุงูุจูุงูุงุช ุงุฏุฎูุช ูุฏููุงู ุจูุงุณุทุฉ ุงุดุฎุงุต ุญููููู ูููุณ ุจุดูู ุขููุ ูุฐุง ุงูุนุงููุฏ ุณูููู ุตุนุจ ุชุญูููู. ูุญุณู ุงูุธูุฑ ูููููุง ุงุณุชุฎุฏุงู ุจูุงูุงุช ุฎุทูุท ุงูุทูู ูุงูุนุฑุถ `Latitude` ู `Longitude` ุจุฏูุงู ูู ุงูุนููุงู.


```python
calls['BLKADDR'][[0, 5001]]
```

```ruby
0            2500 LE CONTE AVE
5001    ALLSTON WAY & FIFTH ST
Name: BLKADDR, dtype: object
```

### ููุณุงุช ุงุฎูุฑู

ุชุจุฏู ุงูุจูุงูุงุช ุฌุงูุฒู ููุชุญููู ุงูุขู. ุงูุนุงููุฏ `Block_Location` ูุญุชูู ุนูู ูุต ุจุงูุนููุงูุ ุฎุท ุงูุทูู ูุงูุนุฑุถ. ูุญุชุงุฌ ููุตู ูููุฉ ุฎุท ุงูุทูู ูุงูุนุฑุถ ููุณูู ุงุณุชุฎุฏุงููุง: 

```python
def split_lat_lon(calls):
    return calls.join(
        calls['Block_Location']
        # ุงูุญุตูู ุนูู ุงูุฅุญุฏุงุซุงุช ูู ุงููุต ( ุจูุงูุงุช ุฎุท ุงูุทูู ูุงูุนุฑุถ)
        .str.split('\n').str[2]
        # ุญุฐู ุงูุฃููุงุณ ูู ุงููุต
        .str[1:-1]
        # ูุตู ููู ุฎุท ุงูุทูู ูุงูุนุฑุถ ุฅูู ุนุงููุฏุงู
        .str.split(', ', expand=True)
        .rename(columns={0: 'Latitude', 1: 'Longitude'})
    )

calls.pipe(split_lat_lon).head(2)
```

**Longitude**|**Latitude**|**State**|**City**|**...**|**EVENTTM**|**EVENTDT**|**OFFENSE**|**CASENO**| 
:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:
-122.260544|37.876965|CA|Berkeley|...|6:00|07/23/2017 12:00:00 AM|BURGLARY AUTO|17091420|0
-122.268028|37.869363|CA|Berkeley|...|8:45|04/13/2017 12:00:00 AM|THEFT FROM PERSON|17020462|1

```center-result
2 rows ร 13 columns
```

ุซู ูุฑุจุท ูู ุฑูู ูู ุงูุนุงููุฏ `CVDOW` ูุน ูุต ุงููููุ ุณูุณุชุฎุฏู ุงูููู `cvdow.csv` ุงูุฐู ุชู ุชุฌููุฒู ูุณุจูุงูุ ูุญุชูู ุงูููู ุนูู ุฑูู ุงูููู ูุงูููู ููุต ููุชูุจ:

> ูุชุญููู ุงูููู: [cvdow.csv]({{ site.baseurl }}/files/chapter5/cvdow.csv)

```python
day_of_week = pd.read_csv('data/cvdow.csv')
day_of_week
```

**Day**|**CVDOW**||
:-----:|:-----:|:-----:
Sunday|0|0
Monday|1|1
Tuesday|2|2
Wednesday|3|3
Thursday|4|4
Friday|5|5
Saturday|6|6

ูููู ุจุชุฑุฌูุฉ ุงูุนุงููุฏ `CVDOW` ุฅูู ูุต:

```python
def match_weekday(calls):
    return calls.merge(day_of_week, on='CVDOW')

calls.pipe(match_weekday).head(2)
```

**Day**|**State**|**City**|**BLKADDR**|**...**|**EVENTTM**|**EVENTDT**|**OFFENSE**|**CASENO**| 
:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:
Sunday|CA|Berkeley|2500 LE CONTE AVE|...|6:00|07/23/2017 12:00:00 AM|BURGLARY AUTO|17091420|0
Sunday|CA|Berkeley|BOWDITCH STREET & CHANNING WAY|...|22:00|07/02/2017 0:00|BURGLARY AUTO|17038302|1

```center-result
2 rows ร 12 columns
```

ุณูุญุฐู ุงูุนูุงููุฏ ุงูุชู ูุง ูุญุชุงุฌูุง:

```python
def drop_unneeded_cols(calls):
    return calls.drop(columns=['CVDOW', 'InDbDate', 'Block_Location', 'City',
                               'State', 'EVENTDT', 'EVENTTM'])
```

ุงูุขู ูููู ุจุชุทุจูู ุฌููุน ุงูุฏูุงู ุงูุชู ุนุฑููุงูุง ุณุงุจูุงู ุนูู ุงูุจูุงูุงุช:

```python
calls_final = (calls.pipe(combine_event_datetimes)
               .pipe(split_lat_lon)
               .pipe(match_weekday)
               .pipe(drop_unneeded_cols))
df_interact(calls_final)
```

> ุจููุณ ุงูุทุฑููุฉ ุงูุณุงุจูุฉ ุณูุธูุฑ ููุง ุฌุฏูู ุชูุงุนูู.

<p align="center"> 
<img src='{{ site.baseurl }}/img/chapter5/df_interact_final.png'>
</p>

```center-result
(5508 rows, 8 columns) total
```

ุงูุขูุ ุจูุงูุงุช ุงูููุงููุงุช ุฌุงูุฒุฉ ููุชุญููู. ูู ุงูุฌุฒุก ุงูุชุงููุ ุณูููู ุจุชูุธูู ุจูุงูุงุช ุงูุฅููุงูุงุช.











[pd_pipe]: https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.pipe.html