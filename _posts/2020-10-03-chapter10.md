---
title: ุงูููุงุฐุฌ ูุงูุชููุนุงุช
show_title: true
chapter_number: 10
chapter_text: ุงููุตู ุงูุนุงุดุฑ
chapter_lessons: [[0, 'ููุฏูุฉ'], [1, 'ุงูููุงุฐุฌ'], [2, 'ุฏุงูุฉ ุงูุฎุณุงุฑู'], [3, 'ุฏุงูุชู ุงูุฎุณุงุฑู Absolute ู Huber']]
chapter_sublessons: [
    [],
    ['ุงููููุฐุฌ ุงูุจุณูุท', 'ูุงุฆุฏุฉ ุฏุงูุฉ ุงูุฎุณุงุฑู'],
    ['ุฏุงูุฉ ุงูุฎุณุงุฑู ุงูุฃููู ููุง: ุงูุฎุทุฃ ุงูุชุฑุจูุนู ุงููุชูุณุท', ['ุชุจุณูุท ุงูุฏุงูู','ุชูููู ุงูุฎุณุงุฑู'], 'ุชูููู ุงูุฎุทุฃ ุงูุชุฑุจูุนู ุงููุชูุณุท', 'ุงูุนูุฏู ููุจูุงูุงุช ุงูุฃุตููู', 'ููุฎุต ุฏุงูุฉ ุงูุฎุณุงุฑู'],
    [['ูุชูุณุท ุงูุฎุทุฃ ุงูุญุชูู', 'ููุงุฑูู ุจูู MSE ู MAE'], 'ุงูููู ุงูุดุงุฐู', 'ุชูููู ูุชูุณุท ุงูุฎุทุฃ ุงูุญุชูู', ['ููุงุฑูุฉ MSE ู MAE', 'ุฏุงูุฉ ุงูุฎุณุงุฑู Huber'], 'ููุฎุต ุฏุงูุชู ุงูุฎุณุงุฑู Absolute ู Huber']
]
layout: default
---

## ููุฏูุฉ

> ุจุดูู ุนุงูุ ุฌููุน ุงูููุงุฐุฌ ุฎุงุทุฆูุ ูููู ุจุนุถูุง ูููุฏ.
>
> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;โ [ุฌูุฑุฌ ุจููุณุ ุฅุญุตุงุฆู](https://www.wikiwand.com/en/George_E._P._Box)

ุชุญุฏุซูุง ุนู ุชูููู ุงูุณุคุงูุ ุชูุธูู ุงูุจูุงูุงุช ูุงูุชุญููู ุงูุงุณุชูุดุงูู ููุจูุงูุงุชุ ุงูุฎุทูุงุช ุงูุซูุงุซ ุงูุฃููู ูู ุฏูุฑุฉ ุญูุงุฉ ุนูู ุงูุจูุงูุงุช. ูุฑุฃููุง ุงู ุงูุชุญููู ุงูุฅุณุชูุดุงูู ูุธูุฑ ุนูุงูุงุช ุจูู ุงูููู ูู ุงูุจูุงูุงุช. ููู ูููููุง ุงูุชุญูู ุงุฐุง ูุงูุช ูุฐู ุงูุนูุงูู ุญูููู ุงู ูุงุ ููู ูููููุง ุงุณุชุฎุฏุงู ูุฐู ุงูุนูุงูุงุช ููุญุตูู ุนูู ุชููุนุงุช ุนู ุงููุณุชูุจูุ ููุฅุฌุงุจู ุนูู ูุฐู ุงูุฃุณุฆูู ุณูุญุชุงุฌ ูุฃุฏุงุฉ ุฑูุงุถูู ูุจูุงุก ุงูููุงุฐุฌ ูุงูุชููุนุงุช.

ุงููููุฐุฌ ูู ุนุจุงุฑู ุนู ุฃูุถู ุชูุซูู ููุธุงููุง. ูุซูุงูุ ุงุฐุง ูููุง ุจุฑูู ูุฑู ูู ุงููููุงุฐ ูู ููู ุจุฑุฌ ุจูุฒุง ุงููุงุฆูุ ูููุฐุฌ ุจุณูุท ููุฌุงุฐุจูู ุณูุชููุน ุงู ุงููุฑู ุณุชุฑุชุทู ุจุงูุฃุฑุถ ุจุณุฑุนู 9.8 ู/ุซยฒ. ูุฐุง ุงููููุฐุฌ ุณูุญ ููุง ุจุชููุน ูู ุณูุฃุฎุฐ ุงููุฑู ูู ููุช ูููุตูู ุฅูู ุงูุฃุฑุถ ุจุฅุณุชุฎุฏุงู ููุงููู ุงูุญุฑูู.

ูุฐุง ุงููููุฐุฌ ููุฌุงุฐุจูู ููุถุญ ุณููู ูุงุฏุงุก ูุธุงููุง ูููู ููุท ูู ุงูุชููุนุ ูุง ูููู ุจุญุณุงุจ ุชุฃุซูุฑ ุญุฑูุฉ ุงูููุงุกุ ูุงูุทูู ูู ุงูููุงุก ูุงูุชุฃุซูุฑุงุช ุงูุฃุฎุฑู ุนูู ุฌุงุฐุจูุฉ ุงูุฃุฌุณุงู ุงุซูุงุก ุงูุณููุท. ุจุณุจุจ ูุฐู ุงูุนูุงูู ุบูุฑ ุงููุฏุฑูุณูุ ูููุฐุฌูุง ุณููุชุฌ ุฏุงุฆูุงู ุชููุนุงุช ุฎุงุทุฆุฉ! ููููุ ุงููููุฐุฌ ุงูุจุณูุท ููุฌุงุฐุจูู ูุนุชุจุฑ ุฏููู ุจุดูู ูุงูู ูู ูุซูุฑ ูู ุงูุฃุญูุงู ููุง ูุฌุนูู ูุณุชุฎุฏู ูููุนููู ุงูููู.

ูุจููุณ ุงูุทุฑูููุ ูู ูููุฐุฌ ูููู ุจุชุนุฑููู ุจุฅุณุชุฎุฏุงู ุจูุงูุงุช ูุนุชุจุฑ ุชูุฏูุฑ ููุง ูู ุจุงููุงูุน. ุนูุฏูุง ูุง ูููู ุงูุชูุฏูุฑ ุฏููู ุฌุฏุงูุ ูููุฐุฌูุง ูููู ุงุณุชุฎุฏุงูู ูููุฏ ูุนููู. ูุจุทุจูุนู ุงูุญุงูุ ุณุชุธูุฑ ููุง ุงุณุฆูุฉ ุงุณุงุณูู ูุซูุ ููู ูุฎุชุงุฑ ุงููููุฐุฌุ ููู ูุนุฑู ูุง ุงุฐุง ููุง ูุญุชุงุฌ ูููุฐุฌ ุงูุซุฑ ุชุนููุฏุงูุ

ูู ุงููุตูู ุงููุงุฏูู ูู ูุฐุง ุงููุชุงุจุ ุณูููู ุจุชุทููุฑ ุงุฏูุงุช ุญุณุงุจูู ูุชุตููู ููุฏุฑุจ ุงููููุฐุฌ ุนูู ุงูุจูุงูุงุช. ุณูููู ุงูุถุงู ุจุงูุชุนุฑู ุนูู ุงุฏูุงุช ุงุณุชูุชุงุฌูู ุชููููุง ูู ูุนุฑูู ูุง ุงุฐุง ุจุฃููุงููุง ุชุนููู ููุงุฐุฌูุง.

## ุงูููุงุฐุฌ

ูู ุงูููุงูุงุช ุงููุชุญุฏูุ ุงููุซูุฑ ูู ุฒูุงุฑ ุงููุทุงุนู ูุชุฑููู ุจุนุถ ูู ุงููุงู (ุงูุฑุงููู) ูููุถูููู ุงุซูุงุก ุฏูุนูู ูุซูู ูุฌุจุชูู. ุฑุบู ุงูู ูู ุงููุนุฑูู ูู ุงูููุงูุงุช ุงููุชุญุฏู ุงู 15% ูู ูุฌููุน ุงููุงุชูุฑู ูููู ูุฃูุฑุงูููุ ุฑุจูุง ุจุนุถ ุงููุทุงุนู ูุฏููุง ุฒุจุงุฆู ูุฎูุตูู ุงูุซุฑ ูู ุบูุฑูุง.

ุงุญุฏ ุงููุถูููู ุงูููุชููู ุงุฑุงุฏ ูุนุฑูู ูุง ูุฏ ูุญุตู ุนููู ูุฃูุฑุงููู ููุงู ุจุฌูุน ูุนูููุงุช ุนู ูู ุงูุทุงููุงุช ุงูุชู ุฎุฏููุง ูู ุบุถูู ุดูุฑ:

```python
tips = sns.load_dataset('tips')
tips
```

**size**|**time**|**day**|**smoker**|**sex**|**tip**|**total\_bill**| 
:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:
2|Dinner|Sun|No|Female|1.01|16.99|0
3|Dinner|Sun|No|Male|1.66|10.34|1
3|Dinner|Sun|No|Male|3.5|21.01|2
...|...|...|...|...|...|...|...
2|Dinner|Sat|Yes|Male|2|22.67|241
2|Dinner|Sat|No|Male|1.75|17.82|242
2|Dinner|Thur|No|Female|3|18.78|243

```center-result
244 rows ร 7 columns
```

```python
sns.distplot(tips['tip'], bins=np.arange(0, 10.1, 0.25), rug=True)
plt.xlabel('Tip Amount in Dollars')
plt.ylabel('Proportion per Dollar');
```

ูููููุง ุฑุณู ูุฏุฑุฌ ุชูุฑุงุฑู ููุฌููุน ุงูุฅูุฑุงููุงุช:

<p align='center'>
<img src='{{ site.baseurl }}/img/chapter10/hist-totaltips.png'>
</p>

ูููููุง ููุงุญุธุฉ ุจุนุถ ุงูุฃููุงุท ูู ุงูุจูุงูุงุช. ูุซูุงูุ ููุงู ุชูุฑุงุฑ ูุจูุฑ ูููููุฉ 2<span>$</span> ูุบุงูุจ ุงูุฅูุฑุงููุงุช ูู ูุถุงุนูุงุช 0.50<span>$</span>.

ุญุงููุงูุ ูุญู ููุชููู ุจูุณุจุฉ ุงูุฅูุฑุงููู: ูููุฉ ุงูุฅูุฑุงููู ูุณูุฉ ูุฌููุน ุงููุงุชูุฑู. ูููููุง ุฅูุดุงุก ุนุงููุฏ ุฌุฏูุฏ ูู ุงู DataFrame ูุญูุธ ูุฐู ุงููููู ููุนุฑุถ ุชูุฒูุน ุงููุชุงุฆุฌ:

```python
tips['pcttip'] = tips['tip'] / tips['total_bill'] * 100
sns.distplot(tips['pcttip'], rug=True)
plt.xlabel('Percent Tip Amount')
plt.ylabel('Proportion per Percent');
```

<p align='center'>
<img src='{{ site.baseurl }}/img/chapter10/hist-tipspercent.png'>
</p>

ูุจุฏู ุฃู ุฃุญุฏ ุงูุฒุจุงุฆู ุชุฑู ูููุถูู ุฅูุฑุงููู ูููุชูุง 70%! ูููู ุฃุบูุจ ุงูุฅูุฑุงููุงุช ูุงู ุฃูู ูู 30%. ูููุฑุจ ุงูุฑุณู ุงูุจูุงูู ุฅูู ุฐูู ุงูุฌุฒุก ููู ุงูุฑุณูู:

```python
sns.distplot(tips['pcttip'], bins=np.arange(30), rug=True)
plt.xlim(0, 30)
plt.xlabel('Percent Tip Amount')
plt.ylabel('Proportion per Percent');
```

<p align='center'>
<img src='{{ site.baseurl }}/img/chapter10/hist-tipslessthan30percent.png'>
</p>

ููุงุญุธ ุฃู ุชูุฒูุน ุงูุจูุงูุงุช ูู ุงูุบุงูุจ ุญูู 15% ูุน ูุฌููุน ุชูุฑุงุฑ ุงุนูู ุญูู 20%. ูููุชุฑุถ ุฃู ูุถูููุง ูุฑูุฏ ูุนุฑูู ูู ุงููุณุจู ุงูุชู ุณูุญุตู ุนูููุง ูู ุงูุฒุจุงุฆู. ููุฅุฌุงุจู ุนูู ุงูุณุคุงูุ ูููููุง ุจูุงุก ูููุฐุฌ ูุชููุน ูู ูุจูุบ ุงูุฅูุฑุงููู ุงูุฐู ุณูุญุตู ุนูููุง ุงููุถูู. 

### ุงููููุฐุฌ ุงูุจุณูุท

ุงุญุฏ ุงูุซูู ุนูู ุงููููุฐุฌ ุงูุณูุท ูู ุชุฌุงูู ูู ุงูุจูุงูุงุช ูุฐูุฑ ุงูู ูู ุงููุนุฑูู ูู ุงูููุงูุงุช ุงููุชุญุฏู ุงุนุทุงุก ุฅูุฑุงููู ุจููุฏุงุฑ 15% ูู ูุจูุบ ุงููุงุชูุฑูุ ุจุฐูู ูุญุตู ุงููุถูู ุฏุงุฆูุงู ุนูู 15% ูู ูู ุฒุจูู. ุนูู ุงูุฑุบู ูู ุจุณุงุทุชูุ ุณูุณุชุฎุฏู ูุฐู ุงููููุฐุฌ ููุชุนุฑูู ุจุจุนุถ ุงููุชุบูุฑุงุช ูุงุญูุงู.

ูุฐุง ุงููููุฐุฌ ููุชุฑุถ ุฃู ููุงู ูุณุจู ูุญูุฏู ุตุญูุญู ููู ุงูุฅูุฑุงููุงุช ุงูุชู ุณูุญุตู ุนูููุง ุงููุถูู ูู ูู ุฒุจุงุฆูู. ูุฐู ูู *ูุนุงูู ุงููุฌุชูุน Population Parameter* ููุณุจุฉ ุงูุฅูุฑุงูููุ ูุงูุชู ุณูุฑูุฒ ููุง ุจุงูุฑูุฒ $ \theta^* $. [๐][PopulationParameterEN] [๐][PopulationParameterAR]

ุจุนุฏ ูุฑุถูุชูุง ุงูุณุงุจููุ ูููุฐุฌูุง ุณูููู ุงู ุชููุนู ููููุฉ $ \theta^* $ ูู 15%. ุณูุณุชุฎุฏู ุงูุฑูุฒ $ \theta $ ููุตู ุงูุชููุน (ุงูุชูุจุค).

ุจุฑููุฒ ุฑูุงุถููุ ูุฃู ูููุฐุฌูุง ููุฑุถ ุงูุชุงูู:

$$ \theta = 15 $$

ูู ุงููุงุถุญ ุงู ูุฐุง ุงููููุฐุฌ ูุญุชูู ุนูู ูุดุงููุ ุงุฐุง ูุงู ุงููููุฐุฌ ุตุญูุญุ ูุฃู ุฌููุน ุงูุฒุจุงุฆู ูู ุจูุงูุงุชูุง ูุฏ ุฃุนุทู ุฅูุฑุงููู ุจูููุฉ 15%. ููููุ ูุฐุง ุงููููุฐุฌ ุณูุนุทู ุชุฎูููุงู ูุนูููุงู ูู ูุซูุฑ ูู ุงูุฃุญูุงู. ุจุงูุฃุตุญุ ูุฐุง ุงููููุฐุฌ ูุนุชุจุฑ ุงูุฃูุซุฑ ูุงุฆุฏู ุจุงููุณุจู ููุง ุงุฐุง ูู ููู ูุฏููุง ุฃู ูุนูููุงุช ุนู ุงููุถูู ูุงูุฒุจุงุฆู ุณูุง ุงููู ูู ุงูููุงูุงุช ุงููุชุญุฏู.

ุจูุง ุงู ุงููุถูู ูุฏููุง ูุงู ุจุฌูุน ุจูุงูุงุชุ ูููููุง ุงุณุชุฎุฏุงู ุงููุนูููุงุช ุงูุชุงุฑูุฎู ููุฅูุฑุงููุงุช ุงูุชู ุญุตู ุนูููุง ูุจูุงุก ูููุฐุฌ ูุนุทู ุชูุจุค ุจุฏูู ุนู 15% ุงููุนุฑููู ุจูู ูุทุงุนู ุงูููุงูุงุช ุงููุชุญุฏู.

### ูุงุฆุฏุฉ ุฏุงูุฉ ุงูุฎุณุงุฑู

ุนุฑุถูุง ุณุงุจูุงู ุชูุฒูุน ูุณุจุฉ ุงูุฅูุฑุงููุงุช ูู ุงูุจูุงูุงุช:

<p align='center'>
<img src='{{ site.baseurl }}/img/chapter10/hist-tipslessthan30percent.png'>
</p>

ูููุชุฑุถ ุงููุง ูุฑูุฏ ููุงุฑูุฉ ุฎูุงุฑูู ู $ \theta $: $ 10% $ ู $ 15% $. ูููููุง ุฅุธูุงุฑ ูุฐูู ุงูุฎูุงุฑูู ูู ุฑุณููุง ุงูุจูุงูู:

<p align='center'>
<img src='{{ site.baseurl }}/img/chapter10/hist-tips10and15percent.png'>
</p>

ุจุดูู ูุงุถุญุ ูุธูุฑ ุฃู ุงุฎุชูุงุฑ $ \theta = 15 $ ูุจุฏู ุงูุถู ูู $ \theta = 10 $ ุจูุงุกูุง ุนูู ุงูุจูุงูุงุช. ููุงุฐุงุ ุนูุฏูุง ููุงุญุธ ููุงุท ุงูุจูุงูุงุชุ ูุฑู ุฃู ุงูุซุฑ ุงูุจูุงูุงุช ูุงูุช ุงูุฑุจ ู 15 ูู 10.

ุนูู ุงูุฑุบู ุงู $ \theta = 15 $ ุชุจุฏู ุฎูุงุฑูุง ุงูุถูุ ูุง ูุนุฑู ูุง ุงุฐุง ูุงูุช ูู ุงูุถู ูู $ \theta = 16 $. ููููู ุจุงุฎุชูุงุฑ ุฏููู ุจูู ูุฎุชูู ุงุญุชูุงูุงุช $ \theta $ุ ูุฑูุฏ ุงู ูุนูู ููู $ \theta $ ุฑูู ูุชุบูุฑ ูููุณ ูุง ุงุฐุง ูุงู ููุงุณุจ ูุจูุงูุงุชูุง. ูุนูู ุฐููุ ูุญุชุงุฌ ูุฏุงูู ุชุฃุฎุฐ ูููู ู $ \theta $ ูููู ูู ุจูุงูุงุชูุงุ ูุชูุชุฌ ููุง ุฑููุงู ูููููุง ุงุณุชุฎุฏุงูู ูุฅุฎุชูุงุฑ ุงูุถู ุงูููู ู $ \theta $.

ุชุณูู ูุฐู ุงูุฏุงูู ุจ **ุฏุงูุฉ ุงูุฎุณุงุฑู**.

## ุฏุงูุฉ ุงูุฎุณุงุฑู

ููุฐูุฑ ูุฑุถูุชูุง ุงูุณุงุจูู: ุงูุชุฑุถูุง ุงู ููุงู ูุณุจู ูุงุญุฏู ููุฅูุฑุงููู ุจูู ุฌููุน ุงููุฌุชูุน $ \theta^* $. ูููุฐุฌูุง ูุชููุน ูุฐุง ุงูุฑููุ ุณูุณุชุฎุฏู $ \theta $ ูุชุฑููุฒ ุชููุนูุง. ูุฑูุฏ ุงุณุชุฎุฏุงู ุงูุจูุงูุงุช ุงูุชู ุฌูุนูุงูุง ุนู ุงูุฅูุฑุงููุงุช ูุญุณุงุจ ูููุฉ $ \theta $.

ูุชุญุฏูุฏ ุงู ูููู ูู $ \theta $ ูู ุงูุตุญูุญูุ ุนุฑููุง **ุฏุงูุฉ ุงูุฎุณุงุฑู**. ุฏุงูุฉ ุงูุฎุณุงุฑู ูู ุฏุงูู ุฑูุงุถูู ุชุฃุฎุฐ ุชููุน ู $ \theta $ ูููุทู ูู ุจูุงูุงุชูุง $ y_1, y_2, \ldots, y_n $ุ ูุชุฃุชู ุจูุชูุฌู ุนุจุงุฑู ุนู ุฑููุ **ุงูุฎุณุงุฑู**ุ ูููุณ ูุฏู ุฏูุฉ $ \theta $ ูุจูุงูุงุชูุง. ุจุฑููุฒ ุฑูุงุถููุ ูุฑูุฏ ูุชุงุจุฉ ุงูุฏุงูู:

$$ L(\theta, y_1, y_2, \ldots, y_n) =\ \ldots $$

ุจุดูู ุนุงูุ ุงููุชูุฌู ูู ุฏุงูุฉ ุงูุฎุณุงุฑู ุนูุฏูุง ุชููู ุฑููุงู ุตุบูุฑ ูุฃู ูููุฉ $ \theta $ ููุงุณุจู ูุงุฐุง ูุงูุช ุงููุชูุฌู ูู ุงูุฏุงูู ุฑูู ูุจูุฑ ูุฃู ูููุฉ $ \theta $ ููุณุช ููุงุณุจู. ููุฏุฑุจ ุงููููุฐุฌุ ูุฎุชุงุฑ ููู ู $ \theta $ ุงูุชู ุชูุชุฌ ููุง ุงุฑูุงู ุตุบูุฑู ูู ุฏุงูุฉ ุงูุฎุณุงุฑูุ ุงูููู $ \theta $ ุงูุชู **ุชููู ูู ุงูุฎุณุงุฑู**. ูุณุชุฎุฏู ุงูุฑูุฒ $ \hat{\theta} $ ููุฅุดุงุฑู ูููู $ \theta $ ุงูุชู ุชููู ูู ุฏุงูุฉ ุงูุฎุณุงุฑู.

ูููุชุฑุถ ูุฑู ุงุฎุฑู ุงูููู ุงูุชุงููู ู $ \theta $: $ \theta = 10 $ ู $ \theta = 15 $:

```python
sns.distplot(tips['pcttip'], bins=np.arange(30), rug=True)

plt.axvline(x=10, c='darkblue', linestyle='--', label=r'$ \theta = 10$')
plt.axvline(x=15, c='darkgreen', linestyle='--', label=r'$ \theta = 15$')
plt.legend()

plt.xlim(0, 30)
plt.xlabel('Percent Tip Amount')
plt.ylabel('Proportion per Percent');
```

<p align='center'>
<img src='{{ site.baseurl }}/img/chapter10/hist-tips10and15percent.png'>
</p>

ุจูุง ุงู $ \theta = 15 $ ุงูุฑุจ ูููุซูุฑ ูู ุงูููุงุทุ ูุฃู ุฏุงูุฉ ุงูุฎุณุงุฑู ูู ุงูููุชุฑุถ ุงูุช ุชุฃุชู ุฑูู ุงูู ู $ \theta = 15 $ ูุฑูู ุงุนูู ู $ \theta = 10 $.

ููุณุชุฎุฏู ูุฐู ุงููุนูููู ูุฅูุดุงุก ุฏุงูู ููุฎุณุงุฑู.

### ุฏุงูุฉ ุงูุฎุณุงุฑู ุงูุฃููู ููุง: ุงูุฎุทุฃ ุงูุชุฑุจูุนู ุงููุชูุณุท

ูุฑูุฏ ุงู ุชููู ูููุฉ $ \theta $ ูุฑูุจู ูู ุงููุซูุฑ ูู ุงูููุงุท ูู ุจูุงูุงุชูุง. ูุฐุงุ ูููู ุจุชุนุฑูู ุฏุงูู ุฎุณุงุฑู ูุจุทููุง ุนูู ุจูุงูุชูุง ูุชุฃุชู ุจูุชุงุฆุฌ ุนุงููู ู $ \theta $ ุงุฐุง ูุงูุช ุจุนูุฏู ุนู ุงููุซูุฑ ูู ุงูุจูุงูุงุช. ูุจุฏุฃ ุจุฏุงูุฉ ุฎุณุงุฑู ุจุณูุทู ูุทูุน ุนูููุง *ุงูุฎุทุฃ ุงูุชุฑุจูุนู ุงููุชูุณุท Mean Squared Error*ุ ููุง ููุฑุชูุง:

- ูุฎุชุงุฑ ูููู ู $ \theta $.
- ููู ูููู ูู ุจูุงูุชูุงุ ูุฃุฎุฐ ุงููุฑู ุงูุชุฑุจูุนู ุจูู ุชูู ุงููููู ู $ \theta $: $ (y_i - \theta)^2 $. ุทุฑููุฉ ุงูุชุฑุจูุน ูู ูุณููู ุณููู ูุชุญููู ุงูููู ุงูุณูุจูู ุฅูู ููู ุฅูุฌุงุจูู. ูุฑูุฏ ุงูููุงู ุจุฐูู ูุฃู ุงุฐุง ูุงูุช $ ( y_i = 14 $ ูุฃู ููุง ุงููููุชูู $ \theta = 10 $ ู $ \theta = 18 $ ูุนุชุจุฑุงู ุจูุนูุฏูู ุนู ุจุงูู ุงูููุงุท ููุนุชุจุฑูู ููู ุบูุฑ ููุงุณุจู.
- ููููุงู ุจุนูููุฉ ุงูุญุณุงุจ ูุฏุงูุฉ ุงูุฎุณุงุฑูุ ูุฃุฎุฐ ูุชูุณุท ูู ูููู ูููุฑู ุงูุชุฑุจูุนู.

$$ \begin{aligned}
L(\theta, y_1, y_2, \ldots, y_n)
&= \text{average}\left\{ (y_1 - \theta)^2, (y_2 - \theta)^2, \ldots, (y_n - \theta)^2 \right\} \\
&= \frac{1}{n} \left((y_1 - \theta)^2 + (y_2 - \theta)^2 + \ldots + (y_n - \theta)^2 \right) \\
&= \frac{1}{n} \sum_{i = 1}^{n}(y_i - \theta)^2\\
\end{aligned} $$

ูุชุงุจุฉ ุฏุงูู ูู ุจุงูุซูู ููููุงู ุจุนูููุฉ ุญุณุงุจ ุฏุงูุฉ ุงูุฎุณุงุฑู ูุฐู ุณูู ุฌุฏุงู:

```python
def mse_loss(theta, y_vals):
    return np.mean((y_vals - theta) ** 2)
```

ููุฑู ููููุฉ ุงุฏุงุก ูุฐู ุงูุฏุงูู. ูููุฑุถ ุงู ูุฏููุง ุจูุงูุงุช ุชุญุชูู ุนูู ูููุฉ ูุงุญุฏ ููุทุ $ y_1 = 14 $. ูููููุง ุชุฌุฑุจุฉ ุงูุซุฑ ูู ูููู ู $ \theta $ ููุฑู ูุชูุฌุฉ ุฏุงูุฉ ุงูุฎุณุงุฑู ููู ูููู:

```python
# ูุง ููู ูุนุฑูุฉ ูุง ูุฌุฑู ูู ุงูููุฏ ุงูุจุฑูุฌู ุงูุชุงููุ ูุชูุฌุฉ ุงูููุฏ ูู ุงูุตูุฑุฉ ูู ุงูุฃุณูู
def try_thetas(thetas, y_vals, xlims, loss_fn=mse_loss, figsize=(10, 7), cols=3):
    if not isinstance(y_vals, np.ndarray):
        y_vals = np.array(y_vals)
    rows = int(np.ceil(len(thetas) / cols))
    plt.figure(figsize=figsize)
    for i, theta in enumerate(thetas):
        ax = plt.subplot(rows, cols, i + 1)
        sns.rugplot(y_vals, height=0.1, ax=ax)
        plt.axvline(theta, linestyle='--',
                    label=rf'$ \theta = {theta} $')
        plt.title(f'Loss = {loss_fn(theta, y_vals):.2f}')
        plt.xlim(*xlims)
        plt.yticks([])
        plt.legend()
    plt.tight_layout()

try_thetas(thetas=[11, 12, 13, 14, 15, 16],
           y_vals=[14], xlims=(10, 17))
```

<p align='center'>
<img src='{{ site.baseurl }}/img/chapter10/hists-lossfunctions14.png'>
</p>

ููุง ุชููุนูุงุ ูููุฉ ุฏุงูุฉ ุงูุฎุณุงุฑู ูููุง ูุงูุช $ \theta $ ุงุจุนุฏ ูู ูุฌูุน ุงูุจูุงูุงุช ููุชูุฌุฉ ุงูุฏุงูู ุงูู ูููุง ูุงูุช ุงูุฑุจ ุงู ูู ููุณ ุงูููุทู. ููุฑู ููู ูุชุตุฑู ุงูุฎุทุฃ ุงูุชุฑุจูุนู ุงููุชูุณุท ุงุฐุง ูุงูุช ูุฏููุง ุงูุซุฑ ูู ูููู. ูุชูู ุจูุงูุงุชูุง ูู ุงูููู ุงูุชุงููู: $ [11,12,15,17,18] $

```python
try_thetas(thetas=[12, 13, 14, 15, 16, 17],
           y_vals=[11, 12, 15, 17, 18],
           xlims=(10.5, 18.5))
```

<p align='center'>
<img src='{{ site.baseurl }}/img/chapter10/hists-lossfunctions5datapoints.png'>
</p>

ูู ููู $ \theta $ ุงูุณุงุจูู ูุฑู ุงู $ \theta = 15 $ ูุฏููุง ุงูู ูุชูุฌู ูุฏุงูุฉ ุงูุฎุณุงุฑู. ูููุ ุฑูู ุจูู 14 ู 15 ูุฏ ูุญุตู ุนูู ูุชูุฌู ุงูู ูุฏุงูุฉ ุงูุฎุณุงุฑู. ููุฑู ุงู ูุงู ุจุฅููุงููุง ุงูุญุตูู ุนูู ูููู ุงูุถู ู $ \theta $

```python
def try_thetas_interact(theta, y_vals, xlims, loss_fn=mse_loss):
    if not isinstance(y_vals, np.ndarray):
        y_vals = np.array(y_vals)
    plt.figure(figsize=(4, 3))
    sns.rugplot(y_vals, height=0.1)
    plt.axvline(theta, linestyle='--')
    plt.xlim(*xlims)
    plt.yticks([])
    print(f'Loss for theta = {theta}: {loss_fn(theta, y_vals):.2f}')

def mse_interact(theta, y_vals, xlims):
    plot = interactive(try_thetas_interact, theta=theta,
                       y_vals=fixed(y_vals), xlims=fixed(xlims),
                       loss_fn=fixed(mse_loss))
    plot.children[-1].layout.height = '240px'
    return plot
    
mse_interact(theta=(12, 17, 0.2),
             y_vals=[11, 12, 15, 17, 18],
             xlims=(10.5, 18.5))
```

> ุงูููุฏ ุงูุณุงุจู ููุชุฌ ุฑุณู ุจูุงูู ุชูุงุนููุ ูููููุง ููู ุงูุชุญูู ุจูููุฉ $ \theta $ ุฅูู ุงู ูุญุตู ุนูู ูุชูุฌู ููุงุณุจู ูุฏุงูุฉ ุงูุฎุณุงุฑู. ูุฐุง ุงูุทุฑููู ุงูุชูุงุนููู ุชุนูู ููุท ูู Jupyter Notebook ูุฐุง ุงุฐุง ุงุฑุฏ ุชุฌุฑุจุชูุง ูู ุจุชุดุบูู ูุงูู ุงูููุฏ ุงูุจุฑูุฌู ูุน ุงุถุงูุฉ ุงูููุชุจุงุช ุงูุชู ูุญุชุงุฌูุง ูุงููุงู ูู Jupyter Notebook.

<p align='center'>
<img src='{{ site.baseurl }}/img/chapter10/hists-lossfunction146.gif'>
</p>

ููุงุญุธ ุงู ุฏุงูุฉ ุงูุฎุทุฃ ุงูุชุฑุจูุนู ุงููุชูุณุท ุชุคุฏู ุนูููุง ุจุดูู ูุชูู ูุฐูู ุจููุงููุง ุจูุนุงูุจุฉ ููู $ \theta $ ุงูุชู ุชููู ุจุนูุฏู ุนู ูุฌููุน ุงูุจูุงูุงุช. ููุฑู ุงูุขู ูููุฉ ุฏุงูุฉ ุงูุฎุณุงุฑู ูุจูุงูุงุช ุงููุณุจู ุงููุฆููุฉ ููุฅูุฑุงูููุ ูุฑุณู ุงูุชูุฒูุน ุงููุงู:

<p align='center'>
<img src='{{ site.baseurl }}/img/chapter10/hist-tipslessthan30percent.png'>
</p>

ููุฌุฑุจ ุงูุขู ููู ูุฎุชููู ู $ \theta $:

```python
try_thetas(thetas=np.arange(14.5, 17.1, 0.5),
           y_vals=tips['pcttip'],
           xlims=(0, 30))
```

<p align='center'>
<img src='{{ site.baseurl }}/img/chapter10/hists-lossfunctionstips.png'>
</p>

ุจููุณ ุงูุทุฑููุฉ ุงูุณุงุจููุ ูููู ุงูููุงู ุจุฑุณู ุจูุงูู ุชูุงุนูู ูููุงุญุธุฉ ุงูุชุบูุฑ ูุน ุชุบููุฑ ูููุฉ $ \theta $:

```python
mse_interact(theta=(13, 17, 0.25),
             y_vals=tips['pcttip'],
             xlims=(0, 30))
```

<p align='center'>
<img src='{{ site.baseurl }}/img/chapter10/hists-lossfunctioninteracttip.gif'>
</p>

ููุงุญุธ ุงู ุงูุถู ูููุฉ ู $ \theta $ ูู 16.00ุ ุงุนูู ุจูููู ูู ุชููุนูุง ุงูุฃูู 15% ููู ุฅูุฑุงููู.

### ุชุจุณูุท ุงูุฏุงูู

ูููุง ุจุชุนุฑูู ุฃูู ุฏุงูุฉ ุฎุณุงุฑู ููุงุ ุงูุฎุทุฃ ุงูุชุฑุจูุนู ุงููุชูุณุท (MSE). ููุชุฌ ููุง ุฑูู ุนุงูู ูููู $ \theta $ ุงูุจุนูุฏู ุนู ูุฌููุน ุงูุจูุงูุงุช. ุฑูุงุถูุงูุ ูููููุง ุชุนุฑูู ุงูุฏุงูู ูุงูุชุงูู:

$$ \begin{aligned}
L(\theta, y_1, y_2, \ldots, y_n)
&= \frac{1}{n} \sum_{i = 1}^{n}(y_i - \theta)^2\\
\end{aligned} $$

ุณุชููู ุงูุฏุงูู ุจุฅูุชุงุฌ ุงุฑูุงู ูุฎุชููู ููุฎุณุงุฑู ุนูุฏูุง ูููู ุจุฃู ุชุบูุฑ ุณูุงุก ู $ \theta $ ุงู $ y_1, y_2, \ldots, y_n $. ูุงุญุธูุง ุฐูู ุนูุฏ ุชุฌุฑุจุชูุง ููู ูุฎุชููู ู $ \theta $ ู ุนูุฏ ุงุถุงูุชูุง ููู ุงุถุงููู ููุจูุงูุงุช.

ูุฃุฎุชุตุงุฑุ ูููููุง ุชุนุฑูู ุงููุตูููู: $ \textbf{y} = [ y_1, y_2, \ldots, y_n ] $. ุซู ููุชุจ ุฏุงูุฉ ุงูุฎุทุฃ ุงูุชุฑุจูุนู ุงููุชูุณุท ูุงูุชุงูู:

$$ \begin{aligned}
L(\theta, \textbf{y})
&= \frac{1}{n} \sum_{i = 1}^{n}(y_i - \theta)^2\\
\end{aligned} $$

#### ุชูููู ุงูุฎุณุงุฑู

ุญุชู ุงูุขูุ ูุฌุฏูุง ุงูุถู ูููู ู $ \theta $ ุจุชุฌุฑุจุฉ ุงูุซุฑ ูู ูููู ูุงุฎุชูุงุฑ ุงูู ูููู ุจุนุฏ ุชุทุจูู ุฏุงูุฉ ุงูุฎุณุงุฑู. ุนูู ุงูุฑุบู ูู ูุงุนููุฉ ูุฐู ุงูุทุฑูููุ ูููููุง ุฅูุฌุงุฏ ุทุฑู ุงูุถู ุจุฅุณุชุฎุฏุงู ุฎุตุงุฆุต ุฏุงูุฉ ุงูุฎุณุงุฑู.

ูููุซุงู ุงูุชุงููุ ุงุณุชุฎุฏููุง ุจูุงูุงุช ุชุญุชูู ุนูู ุงูููู ุงูุชุงููู: $ \textbf{y} = [ 11, 12, 15, 16, 17 ] $.

```python
try_thetas(thetas=[12, 13, 14, 15, 16, 17],
           y_vals=[11, 12, 15, 17, 18],
           xlims=(10.5, 18.5))
```

<p align='center'>
<img src='{{ site.baseurl }}/img/chapter10/hists-lossfunctions5datapoints.png'>
</p>

ูู ุงููุซุงู ุงุณุชุฎุฏููุง ูููุฉ ู $ \theta $ ุจูู 12 ู 17ุ ุนูุฏ ุชุบูุฑ ูููุฉ $ \theta $ุ ุชุจุฏุฃ ูุชูุฌุฉ ุงูุฏุงูู ูุฑุชูุนู (10.92) ูุชูู ุญุชู ูุตู ุฅูู $ \theta = 15 $ุ ุซู ุชุฒูุฏ ุจุนุฏูุง. ูููููุง ููุงุญุธุฉ ุชุบูุฑ ูุชูุฌุฉ ุฏุงูุฉ ุงูุฎุณุงุฑู ูููุง ุบูุฑูุง ูููุฉ $ \theta $ุ ูููุงุฑู ุงูุชุบูุฑ ูู ูู ูุฑู ูููู ูููุง ุจุชุบูุฑ ูููุฉ $ \theta $:

```python
thetas = np.array([12, 13, 14, 15, 16, 17])
y_vals = np.array([11, 12, 15, 17, 18])
losses = [mse_loss(theta, y_vals) for theta in thetas]

plt.scatter(thetas, losses)
plt.title(r'Loss vs. $ \theta $ when $\bf{y}$$ = [11, 12, 15, 17, 18] $')
plt.xlabel(r'$ \theta $ Values')
plt.ylabel('Loss');
```

<p align='center'>
<img src='{{ site.baseurl }}/img/chapter10/losstotheta.png'>
</p>

ูุฎุทุท ุงูุชุดูุชููุช ุงูุณุงุจู ูุธูุฑ ุชูุฌู ููุฃุณููุ ุซู ููุฃุนูู ููุง ูุงุญุธูุง ูุณุจูุงู. ูููููุง ุงุณุชุฎุฏุงู ุงููุฒูุฏ ูู ููู $ \theta $ ููุดุงูุฏุฉ ูุงูู ุงูููุญูู ุนูุฏูุง ุชุชุบูุฑ ุงูุฎุณุงุฑู ูููุง ุบูุฑูุง ูููุฉ $ \theta $.

```python
thetas = np.arange(12, 17.1, 0.05)
y_vals = np.array([11, 12, 15, 17, 18])
losses = [mse_loss(theta, y_vals) for theta in thetas]

plt.plot(thetas, losses)
plt.title(r'Loss vs. $ \theta $ when $\bf{y}$$ = [11, 12, 15, 17, 18] $')
plt.xlabel(r'$ \theta $ Values')
plt.ylabel('Loss');
```

ุงูุฑุณู ุงูุจูุงูู ุงูุณุงุจู ูุคูุฏ ููุง ุงู $ \theta = 15 $ ูู ุชูู ุงูุฎูุงุฑ ุงูุฃูุถูุ ุฑูู ู $ \theta $ ุจูู 14 ู 15 ูุงู ูููุฉ ุงูุฎุณุงุฑู ููู ุงูู. ูููููุง ุงุณุชุฎุฏุงู ุงูุชูุงุถู ูุงูุชูุงูู ูุญุณุงุจ ูููุฉ ุฐูู ุงูุฑูู ุจุงูุถุจุท. ุจูููุฉ ุฎุณุงุฑุฉ ุฃููุ ูุดุชูุฉ ุฏุงูุฉ ุงูุฎุณุงุฑู ูููููู $ \theta $ ุชููู 0.

ูุจุฏุฃ ุฃููุงู ุจุฏุงูุฉ ุงูุฎุณุงุฑู ุงูุชู ุนุฑููุงูุง:

$$ \begin{aligned}
L(\theta, \textbf{y})
&= \frac{1}{n} \sum_{i = 1}^{n}(y_i - \theta)^2\\
\end{aligned} $$

ุซู ูููู ุจุฅุฏุฎุงู ููุงุทูุง $ \textbf{y} = [11, 12, 15, 17, 18] $ ูููุนุงุฏูู:

$$ \begin{aligned}
L(\theta, \textbf{y})
&= \frac{1}{5} \big((11 - \theta)^2 + (12 - \theta)^2 + (15 - \theta)^2 + (17 - \theta)^2 + (18 - \theta)^2 \big)\\
\end{aligned} $$

ูุญุณุงุจ ูููุฉ $ \theta $ ุงูุชู ุชููู ูู ุฏุงูุฉ ุงูุฎุณุงุฑูุ ูููู ุจุญุณุงุจ ุงููุดุชูู ู $ \theta $:

$$ \begin{aligned}
\frac{\partial}{\partial \theta} L(\theta, \textbf{y})
&= \frac{1}{5} \big(-2(11 - \theta) - 2(12 - \theta) - 2(15 - \theta) - 2(17 - \theta) -2(18 - \theta) \big)\\
&= \frac{1}{5} \big(10 \cdot \theta - 146 \big)\\
\end{aligned} $$

ุซู ูููู ุจุงูุจุญุซ ุนู ูููุฉ $ \theta $ ุงูุชู ูุดุชูุชูุง ุชุณุงูู ุตูุฑ:

$$ \begin{aligned}
\frac{1}{5} \big(10 \cdot \theta - 146 \big) &= 0 \\
10 \cdot \theta - 146 &= 0 \\
\theta &= 14.6
\end{aligned} $$

ูุฌุฏูุง ูููุฉ $ \theta $ ุงูุฃููุ ูููุง ูู ูุชููุนุ ูุงูุช ุจูู 14 ู 15. ูุฑูุฒ ููููุฉ $ \theta $ ุฐุงุช ุงูุฃูู ุฎุณุงุฑู ุจุงูุฑูุฒ $ \hat{\theta} $. ุงูุขูุ ููุจูุงูุงุช ุงูุชุงููู $ \textbf{y} = [11, 12, 15, 17, 18] $ ู ุฏุงูุฉ ุงูุฎุณุงุฑู MSE:

$$ \hat{\theta} = 14.6 $$

ุงุฐุง ุญุณุจูุง ูุชูุณุท ุงูุจูุงูุงุช ูุฏููุงุ ููุงุญุธ ุงูุชุงูู:

$$ \text{mean} (\textbf{y}) = \hat{\theta} = 14.6 $$

### ุชูููู ุงูุฎุทุฃ ุงูุชุฑุจูุนู ุงููุชูุณุท

ููุง ูู ูุงุถุญุ ุงููุชูุฌู ุงูุณุงุจูู (ุชุณุงูู ูููุฉ ุงููุชูุณุท ูุน $ \hat{\theta} $ ) ููุณุช ูุฌุฑุฏ ุตุฏููุ ุงููุชูุณุท ูููู ุงูุจูุงูุงุช *ุฏุงุฆูุงู* ูุง ูุณุงูู $ \hat{\theta} $ุ ููููุฉ $ \theta $ ุงูุชู ุชููู ูู ุงูุฎุณุงุฑู ุจุฏุงูุฉ MSE.

ูุนุฑุถ ุฐููุ ูุฃุฎุฐ ูุดุชูุฉ ุฏุงูุฉ ุงูุฎุณุงุฑู ูุฑู ุฃุฎุฑู. ูููู ุจุฏูุงู ูู ุงุถุงูุฉ ุงูุจูุงูุงุช ุฅูููุงุ ูุจูู ุงูุฑูุฒ $ y_i $ ููุนูููุง ุนูู ุฌููุน ุงูุจูุงูุงุช.

$$ \begin{aligned}
L(\theta, \textbf{y})
&= \frac{1}{n} \sum_{i = 1}^{n}(y_i - \theta)^2\\
\frac{\partial}{\partial \theta} L(\theta, \textbf{y})
&= \frac{1}{n} \sum_{i = 1}^{n} -2(y_i - \theta) \\
&= -\frac{2}{n} \sum_{i = 1}^{n} (y_i - \theta) \\
\end{aligned} $$

ุจูุง ุงููุง ูู ูุนูุถ ุงู ูููุฉ ูููุชุบูุฑ $ y_i $ุ ูููู ุงู ูุณุชุฎุฏู ุงููุนุงุฏูู ุนูู ุงู ุจูุงูุงุช ุจุฃู ุญุฌู.

ุงูุขูุ ูุนูุถ ูููุฉ ุงููุดุชูู ุจุตูุฑ ููุญุงูู ุงูุฌุงุฏ $ \theta $ ูุฅูุฌุงุฏ ุงูู ูููุฉ ูุฏุงูุฉ ุงูุฎุณุงุฑู ููุง ูุนููุง ุณุงุจูุงู:

$$ \begin{aligned}
-\frac{2}{n} \sum_{i = 1}^{n} (y_i - \theta) &= 0 \\
\sum_{i = 1}^{n} (y_i - \theta) &= 0 \\
\sum_{i = 1}^{n} y_i - \sum_{i = 1}^{n} \theta &= 0 \\
\sum_{i = 1}^{n} \theta &= \sum_{i = 1}^{n} y_i \\
n \cdot \theta &= y_1 + \ldots + y_n \\
\theta &= \frac{y_1 + \ldots + y_n}{n} \\
\hat \theta = \theta &= \text{mean} (\textbf{y})
\end{aligned} $$

ููุงุญุธ ููุง ูู ูุงุถุญุ ุงู ููุงู ูููู ูุงุญุฏู ู $ \theta $ ุงูุชู ุชุนุทู ุงูู ูููู ู MSE ุงูุงู ูุงูุช ุงูููู ุฏุงุฎู ุงูุจูุงูุงุช. ููุฎุทุฃ ุงูุชุฑุจูุนู ุงููุชูุณุทุ ูุนูู ุงู $ \hat{\theta} $ ูู ุฏุงุฆูุงู ุชุณุงูู ุงููุชูุณุท ููุจูุงูุงุช.

### ุงูุนูุฏู ููุจูุงูุงุช ุงูุฃุตููู

ููุณ ุนูููุง ุงุฎุชุจุงุฑ ุงู ููู ุงุนูู ู $ \theta $ ููุง ูุนููุง ูุณุจูุงู. ูููููุง ุฅูุฌุงุฏ ูุชูุณุท ุงูุฅูุฑุงููุงุช ููููู:

```python
np.mean(tips['pcttip'])
```

```ruby
16.08025817225047
```

ููุฑุณูู:

```python
sns.distplot(tips['pcttip'], bins=np.arange(30), rug=True)

plt.axvline(x=16.08, c='darkblue', linestyle='--', label=r'$ \hat \theta = 16.08$')
plt.legend()

plt.xlim(0, 30)
plt.title('Distribution of tip percent')
plt.xlabel('Percent Tip Amount')
plt.ylabel('Proportion per Percent');
```

<p align='center'>
<img src='{{ site.baseurl }}/img/chapter10/hist-tipsdistribution.png'>
</p>

### ููุฎุต ุฏุงูุฉ ุงูุฎุณุงุฑู

ูููุง ุจุงูุชุนุฑู ุนูู **ูููุฐุฌ ุซุงุจุช**ุ ูููุฐุฌ ุฏุฆูุงู ูุง ููุชุฌ ููุง ููุณ ุงูุฑูู ููู ุจูุงูุงุชูุง.

ู ุชุนุฑููุง ุนูู **ุฏุงูุฉ ุงูุฎุณุงุฑู** $ L(\theta, \textbf{y}) $ ุงูุชู ุชููุณ ูุฏู ููุงุกุฉ ูููู ูุนููู ู $ \theta $ ููุจูุงูุงุช. ูู ูุฐุง ุงูุฌุฒุก ุชุนุฑููุง ุงูุถุงู ุนูู ุฏุงูุฉ ุฎุณุงุฑุฉ ุงูุฎุทุฃ ุงูุชุฑุจูุนู ุงููุชูุณุท ูุงุธูุฑูุง ุงู $ \hat{\theta} = \text{mean}(\textbf{y}) $ ูููููุฐุฌ ุงูุซุงุจุช.

ุงูุทุฑููุฉ ุงูุชู ุงุณุชุฎุฏููุงูุง ูู ูุฐุง ุงูุฌุฒุก ูุงูุชู ุชุทุจู ุนูู ุงู ููุน ูู ุงูููุงุฐุฌ:
- ุงุฎุชูุงุฑ ุงููููุฐุฌ.
- ุงุฎุชูุงุฑ ุฏุงูุฉ ุงูุฎุณุงุฑู.
- ุชุฏุฑูุจ ุงููููุฐุฌ ุนู ุทุฑูู ุชูููู ูููุฉ ุงูุฎุณุงุฑู.

ูู ูุฐุง ุงููุชุงุจุ ุฌููุน ุทุฑู ุงูุดุงุก ุงูููุงุฐุฌ ุชุจุฏุฃ ูุชุชูุณุน ูู ุงู ูู ูุฐู ุงูููุงุท.

## ุฏุงูุชู ุงูุฎุณุงุฑู Absolute ู Huber

ูุชุฏุฑูุจ ูููุฐุฌุ ูุฎุชุงุฑ ุฏุงูุฉ ุฎุณุงุฑู ููุชุบูุฑุงุช ุงููููุฐุฌ ุงูุชู ุชููู ูู ุงูุฎุณุงุฑู. ูู ุงูุฌุฒุก ุงูุณุงุจูุ ุชุนุฑููุง ุนูู ุฏุงูุฉ ุงูุฎุณุงุฑู MSE:

$$ \begin{aligned}
L(\theta, \textbf{y})
&= \frac{1}{n} \sum_{i = 1}^{n}(y_i - \theta)^2\\
\end{aligned} $$

ุงุณุชุฎุฏููุง ูููุฐุฌ ุซุงุจุช ูุชููุน ููุณ ุงูุฑูู $ \theta $ ูุฌููุน ุงูุจูุงูุงุช. ุนูุฏูุง ุฏุฑุจูุง ุงููููุฐุฌ ุจุฅุณุชุฎุฏุงู ุฏุงูุฉ ุงูุฎุณุงุฑู MSEุ ูุฌุฏูุง ุงู $ \hat{\theta} = \text{mean} (\textbf{y}) $. ูู ุจูุงูุงุช ุงูุฅูุฑุงููุงุชุ ูุฌุฏูุง ุงู ุงููููุฐุฌ ูุชููุน 16.8% ููููุง ูู ูุชูุณุท ูุณุจ ุงูุฅูุฑุงููุงุช.

ูู ูุฐุง ุงูุฌุฒุกุ ุณูุชุนุฑู ุนูู ุฏุงูุชูู ุฎุณุงุฑู ููุง **ูุชูุณุท ุงูุฎุทุฃ ุงูุญุชูู Mean Absolute Error (MAE)** ู **ููุจุฑ Huber**.

### ูุชูุณุท ุงูุฎุทุฃ ุงูุญุชูู

ุงูุขูุ ุณูุจูู ุงููููุฐุฌ ููุง ูู ููู ุณูุบูุฑ ุฏุงูุฉ ุงูุฎุณุงุฑู. ุจุฏูุงู ูู ุงุฎุฐ ุงููุฑู ุงูุชุฑุจูุนู ุจูู ูู ููุทู ูุชููุนูุงุ ูุฐู ุงูุฏุงูู ุชุฃุฎุฐ ุงููุฑู ุงูุญุชูู:

$$ \begin{aligned}
L(\theta, \textbf{y})
&= \frac{1}{n} \sum_{i = 1}^{n} |y_i - \theta| \\
\end{aligned} $$

#### ููุงุฑูู ุจูู MSE ู MAE

> ูุนุฑู ุงููุงุชุจ ุงููุงู ุฏูุงู ุณูุณุชุฎุฏููุง ููููุงุฑูู ุจูู MSE ู MAE. ูุนุฑูุฉ ูุนูู ุงูููุฏ ุงูุจุฑูุฌู ููุง ูุง ููู.

```python
tips = sns.load_dataset('tips')
tips['pcttip'] = tips['tip'] / tips['total_bill'] * 100

def mse_loss(theta, y_vals):
    return np.mean((y_vals - theta) ** 2)

def abs_loss(theta, y_vals):
    return np.mean(np.abs(y_vals - theta))

def compare_mse_abs(thetas, y_vals, xlims, figsize=(10, 7), cols=3):
    if not isinstance(y_vals, np.ndarray):
        y_vals = np.array(y_vals)
    rows = int(np.ceil(len(thetas) / cols))
    plt.figure(figsize=figsize)
    for i, theta in enumerate(thetas):
        ax = plt.subplot(rows, cols, i + 1)
        sns.rugplot(y_vals, height=0.1, ax=ax)
        plt.axvline(theta, linestyle='--',
                    label=rf'$ \theta = {theta} $')
        plt.title(f'MSE = {mse_loss(theta, y_vals):.2f}\n'
                  f'MAE = {abs_loss(theta, y_vals):.2f}')
        plt.xlim(*xlims)
        plt.yticks([])
        plt.legend()
    plt.tight_layout()
```

```python
compare_mse_abs(thetas=[11, 12, 13, 14, 15, 16],
                y_vals=[14], xlims=(10, 17))
```

<p align='center'>
<img src='{{ site.baseurl }}/img/chapter10/compare-msemae.png'>
</p>

ููุงุญุธ ุงู MSE ุนุงุฏุฉ ูุง ุชููู ุฃุนูู ูู MAE ููู ุฏุงูุฉ ุงูุฎุณุงุฑู ูููุง ุชุฑุจูุนูู. ููุฑู ูุง ูุญุฏุซ ุนูุฏูุง ูููู ูุฏููุง ุงูุฎูุณ ููุงุท ุงูุชุงููู: $ \textbf{y} = [ 12.1, 12.8, 14.9, 16.3, 17.2 ] $

<p align='center'>
<img src='{{ site.baseurl }}/img/chapter10/compare-msemae5points.png'>
</p>

ุชุฐูุฑ ุงู ูุชูุฌุฉ ุฏุงูุฉ ุงูุฎุณุงุฑู ูุง ุชูููุง ูุซูุฑุงูุ ููู ุชูููุง ููุท ุจููุงุฑูุฉ ุงููููู ุงููุฎุชููู ู $ \theta $. ุนูุฏูุง ูุฎุชุงุฑ ุฏุงูุฉ ุฎุณุงุฑูุ ุณูุจุญุซ ุนู $ \hat{\theta} $ุ ูููุฉ $ \theta $ ุงูุชู ูุฏููุง ุงูู ูููู ููุฎุณุงุฑู. ูุฐุงุ ูุญู ููุชู ูุง ุฐุง ูุงูุช ุฏุงูุฉ ุงูุฎุณุงุฑู ุชูุชุฌ ูุชุงุฆุฌ ูุฎุชููู ู $ \hat{\theta} $.

ุญุชู ุงูุขูุ ููุง ุฏุงูุชู ุงูุฎุณุงุฑู ูุชููุชุงู ุนูู $ \hat{\theta} $. ูู ูุงุญุธูุงุ ุณูุฑู ุจุนุถ ุงูุฅุฎุชูุงูุงุช. ููุฑุณู ูุชุงุฆุฌ ุงูุฎุณุงุฑู ูุน $ \theta $ ููู ูููู ูุฏููุง:

```python
thetas = np.array([12, 13, 14, 15, 16, 17])
y_vals = np.array([12.1, 12.8, 14.9, 16.3, 17.2])
mse_losses = [mse_loss(theta, y_vals) for theta in thetas]
abs_losses = [abs_loss(theta, y_vals) for theta in thetas]

plt.scatter(thetas, mse_losses, label='MSE')
plt.scatter(thetas, abs_losses, label='MAE')
plt.title(r'Loss vs. $ \theta $ when $ \bf{y}$$= [ 12.1, 12.8, 14.9, 16.3, 17.2 ] $')
plt.xlabel(r'$ \theta $ Values')
plt.ylabel('Loss')
plt.legend();
```

<p align='center'>
<img src='{{ site.baseurl }}/img/chapter10/compare-msemaetheta.png'>
</p>

ุซูุ ูุณุชุฎุฏู ููู ุงูุซุฑ ู $ \theta $ ููููู ุงูููุญูู ุงูุซุฑ ุณูุงุณู:

```python
thetas = np.arange(12, 17.1, 0.05)
y_vals = np.array([12.1, 12.8, 14.9, 16.3, 17.2])
mse_losses = [mse_loss(theta, y_vals) for theta in thetas]
abs_losses = [abs_loss(theta, y_vals) for theta in thetas]

plt.plot(thetas, mse_losses, label='MSE')
plt.plot(thetas, abs_losses, label='MAE')
plt.title(r'Loss vs. $ \theta $ when $ \bf{y}$$ = [ 12.1, 12.8, 14.9, 16.3, 17.2 ] $')
plt.xlabel(r'$ \theta $ Values')
plt.ylabel('Loss')
plt.legend();
```

<p align='center'>
<img src='{{ site.baseurl }}/img/chapter10/compare-msemaethetasmooth.png'>
</p>

ุซูุ ููุฑุจ ุงูุฑุณู ุงูุจูุงูู ุฅูู ุงูููู ุจูู 1.5 ู 5 ุนูู ุงููุญูุฑ y ููุฑู ุงููุฑู ุนูู ุงูููู ุงูุฏููุง ุจุดูู ุงูุถุญ. ุญุฏููุง ุงูููู ุงูุฏููุง ุจุฎุทูุท ููููุทู:

```python
thetas = np.arange(12, 17.1, 0.05)
y_vals = np.array([12.1, 12.8, 14.9, 16.3, 17.2])
mse_losses = [mse_loss(theta, y_vals) for theta in thetas]
abs_losses = [abs_loss(theta, y_vals) for theta in thetas]

plt.figure(figsize=(7, 5))
plt.plot(thetas, mse_losses, label='MSE')
plt.plot(thetas, abs_losses, label='MAE')
plt.axvline(np.mean(y_vals), c=sns.color_palette()[0], linestyle='--',
            alpha=0.7, label='Minimum MSE')
plt.axvline(np.median(y_vals), c=sns.color_palette()[1], linestyle='--',
            alpha=0.7, label='Minimum MAE')


plt.title(r'Loss vs. $ \theta $ when $ \bf{y}$$ = [ 12.1, 12.8, 14.9, 16.3, 17.2 ] $')
plt.xlabel(r'$ \theta $ Values')
plt.ylabel('Loss')
plt.ylim(1.5, 5)
plt.legend()
plt.tight_layout();
```

<p align='center'>
<img src='{{ site.baseurl }}/img/chapter10/compare-msemaethetaminima.png'>
</p>

ูุฌุฏูุง ุจุนุฏ ุชุฌุฑุจุชูุง ุงู MSE ู MAE ูุฏ ููุชุฌ ุนูููุง ููู ูุฎุชููู ู $ \hat{\theta} $ ูููุณ ุงูุจูุงูุงุช. ุชุญููู ุงูุซุฑ ุฏูู ุงูุถุญ ููุง ูุชู ูููู ุงูุฃุฎุชูุงูุ ูุณุจุจู.

### ุงูููู ุงูุดุงุฐู

ุงุญุฏ ุงูุงุฎุชูุงูุงุช ุงูุชู ููุงุญุธูุง ูู ุงูุฑุณู ุงูุจูุงูู ุงูุณุงุจู ููููุฉ ุงูุฎุณุงุฑู ู $ \theta $ ูู ุดูู ููุญูู ุงูุฎุณุงุฑู. ุฑุณู MSE ุงูุชุฌ ููุง ููุญูู ูุทุนู ูููุงูุฆ. [๐][ParabolaEN]

ุจูููุง ุฑุณู MAE ุงูุชุฌ ููุง ููุง ูุจุฏู ููุฃููุง ุฎุทูุท ูุชุตูู ุจุจุนุถูุง. ูุฐุง ูุจุฏู ูููููุงู ุงุฐุง ูุง ุงุฎุฐูุง ุจุงูุฅุนุชุจุงุฑ ุงู ุฏุงูุฉ ุงููููู ุงูุญุชููู ูู ุฎุทููุ ูุฐุง ุงุฎุฐ ุงููุชูุณุท ูููุซูุฑ ูู ุงูุฏูุงู ุงูุญุชููู ุณูุธูุฑ ููุง ููุงุชุฌ ุดุจู ุฎุทูู.

ุจูุง ุงู MSE ุชุนุชูุฏ ุนูู ุงูุฎุทุฃ ุงูุชุฑุจูุนูุ ุณุชุชุฃุซุฑ ุงูุซุฑ ุจุงูููู ุงูุดุงุฐู. ุงุฐุง ูุงูุช $ \theta = 10 $ ูุงุญุฏ ุงูููุงุท ูุงูุช 110ุ ูููุฉ ุงูุฎุทุฃ ูู MSE ููุฐู ุงููููู ุณุชููู 
$ (10 - 110)^2 = 10000 $ ุจูููุง ูู MAEุ ุณุชููู $ |10 - 110| = 100 $. ูููููุง ุฑุณู ุฐูู ุนู ุทุฑูู ุงุฎุฐ ูุตูููู ูู ุซูุงุซ ููุงุท $ \textbf{y} = [ 12, 13, 14 ] $ ูุงูููุงุฑูู ุจูู ููุญููุง ุงูุฎุณุงุฑู ู $ \theta $ ู MSE ู MAE.

```python
# ุฏุงูู ุชู ูุชุงุจุชูุง ูุชุณุงุนุฏ ุนูู ุงูุฌุงุฏ ุงููุชุงุฆุฌ ูุฑุณู ุงูููุงุฑูู
# ูุง ุชุญุชุงุฌ ููุดุฑุญ
def compare_mse_abs_curves(y3=14):
    thetas = np.arange(11.5, 26.5, 0.1)
    y_vals = np.array([12, 13, y3])
    
    mse_losses = [mse_loss(theta, y_vals) for theta in thetas]
    abs_losses = [abs_loss(theta, y_vals) for theta in thetas]
    mse_abs_diff = min(mse_losses) - min(abs_losses)
    mse_losses = [loss - mse_abs_diff for loss in mse_losses]
    
    plt.figure(figsize=(9, 2))
    
    ax = plt.subplot(121)
    sns.rugplot(y_vals, height=0.3, ax=ax)
    plt.xlim(11.5, 26.5)
    plt.xlabel('Points')
    
    ax = plt.subplot(122)
    plt.plot(thetas, mse_losses, label='MSE')
    plt.plot(thetas, abs_losses, label='MAE')
    plt.xlim(11.5, 26.5)
    plt.ylim(min(abs_losses) - 1, min(abs_losses) + 10)
    plt.xlabel(r'$ \theta $')
    plt.ylabel('Loss')
    plt.legend()


interact(compare_mse_abs_curves, y3=(14, 25));
```

> ููุง ุดุฑุญุช ุณุงุจูุงู ุนูู ุงูุฏูุงู ุงูุชูุงุนููู ุงูุชู ูุงู ุจุชุนุฑูููุง ุงููุงุชุจุ ูุฐู ูุซุงู ุขุฎุฑ ููุง ุญูุซ ูุชุญูู ุงูุฑุณู ุงูุชูุงุนูู ุจูููุฉ ุงููุชุบูุฑ ุงูุฃุฎูุฑ $ y_3 $ ููุงุญุธ ุชุบูุฑ ุงูุฑุณู ูููุง ูุจุฑุช ูููุฉ ุงููุชุบูุฑ ูู 14 ุฅูู 25.

<p align='center'>
<img src='{{ site.baseurl }}/img/chapter10/compare-outlier.gif'>
</p>

ููุงุญุธ ุงูุชุบููุฑ ูู ุงูููุญูู ุนูุฏูุง ุชููู $ y_3 = 14 $ ู $ y_3 = 25 $

<p align='center'>
<img src='{{ site.baseurl }}/img/chapter10/compare-y3-14.png'>
</p>

<p align='center'>
<img src='{{ site.baseurl }}/img/chapter10/compare-y3-25.png'>
</p>

ูููุง ุงุจุนุฏูุง ุงูููุทู $ y_3 $ ุนู ุจููุฉ ุงูุจูุงูุงุชุ ูุชุญุฑู ููุญูู MSE ูุนู. ุนูุฏูุง ุชููู $ y_3 = 14 $ ูุฃู $ \hat{\theta} = 13 $ ูู MSE ู MAE. ูููู ุนูุฏูุง ุชููู $ y_3 = 25 $ ูุฃู ุฎุณุงุฑุฉ MSE ุชููู $ \hat{\theta} = 16.7 $ ู MAE $ \hat{\theta} = 13 $ุ ุจุฏูู ุชุบููุฑ ููุง ูุงูุช ููุณุจูุงู.

### ุชูููู ูุชูุณุท ุงูุฎุทุฃ ุงูุญุชูู

ุงูุขู ุจุนุฏ ุงู ุชุนุฑููุง ุนูู ุงููููู ูู ุงููุฑููุงุช ุจูู MSE ู MAEุ ูููููุง ุชูููู ุฎุณุงุฑุฉ MAE ููุฌุนู ุงููุฑู ุจููููุง ุงูุซุฑ ูุถูุญุงู. ููุง ูุนููุง ูุณุจูุงูุ ุณูุฃุฎุฐ ูุดุชูุฉ ุฏุงูุฉ ุงูุฎุณุงุฑู ู $ \theta $ ููุฌุนููุง ุชุณุงูู ุตูุฑ.

ููููุ ูุฐู ุงููุฑูุ ูุฌุจ ุงู ูุชุนุงูู ูุน ุงุญุชูุงููุฉ ุงู ุงูุฏุงูู ุงูุญุชููู ููุณุช ุฏุงุฆูุงู ูุงุจูู ููุฅุดุชูุงู. ุนูุฏูุง ุชููู $ x > 0 $ ูุฃู $ \frac{\partial}{\partial x} \|x\| = 1 $. ุนูุฏูุง ุชููู $ x < 0 $ ูุฃู $ \frac{\partial}{\partial x} \|x\| = -1 $. ุนูู ุงูุฑุบู ุงู $ \|x\| $ ููุณุช ูุงุจูู ููุฅุดุชูุงู ุนูุฏูุง ุชููู $ x = 0 $ุ ุณูุฌุนู $ \frac{\partial}{\partial x} \|x\| = 0 $ ูุชููู ุงููุนุงุฏูู ุณููู ููุชุนุงูู.

ููุชุฐูุฑ ุงู ูุนุงุฏูุฉ MAE ูู:

$$ \begin{aligned}
L(\theta, \textbf{y})
&= \frac{1}{n} \sum_{i = 1}^{n}|y_i - \theta|\\
&= \frac{1}{n} \left( \sum_{y_i < \theta}|y_i - \theta| + \sum_{y_i = \theta}|y_i - \theta| + \sum_{y_i > \theta}|y_i - \theta| \right)\\
\end{aligned} $$

ูู ุงูุฌุฒุก ุงูุฃุฎูุฑ ูุตููุง ุงูุฌูุน ุฅูู ุซูุงุซุฉ ุงุดูุงู: ูุงุญุฏ ุนูุฏูุง ุชููู $ y_i < \theta $ ู ุงุฎุฑู ุนูุฏ $ y_i = \theta $ ูุงุฎูุฑู ุนูุฏูุง ูููู ูุฏููุง $ y_i > \theta $. ููุงุฐุง ูุฌุนู ุนูููุฉ ุงูุฌูุน ูุนูุฏู ุจูุฐุง ุงูุดููุ ุงุฐุง ุนูููุง ุงู $ y_i < \theta $ ูุฃููุง ูุนูู ุงู $ \|y_i - \theta\| < 0 $ ููุฐูู ูุฃู $ \frac{\partial}{\partial \theta} \|y_i - \theta\| = -1 $ ููุง ูู ุงูุณุงุจู. ูููุทุจู ููุณ ุงูููุทู ุนูู ุฌููุน ุงููุตุทูุญุงุช ุงูุณุงุจู ุฐูุฑูุง ููููู ุฃุฎุฐ ุงููุดุชูุงุช ุงูุซุฑ ุณูููู.

ุงูุขูุ ูุฃุฎุฐ ุงููุดุชูู ุจุงููุณุจุฉ ู $ \theta $ ููุฌุนููุง ุชุณุงูู ุตูุฑ:

$$
\begin{aligned}
\frac{1}{n} \left( \sum_{y_i < \theta}(-1) + \sum_{y_i = \theta}(0) + \sum_{y_i > \theta}(1) \right) &= 0 \\
\sum_{y_i < \theta}(-1) + \sum_{y_i > \theta}(1) &= 0 \\
-\sum_{y_i < \theta}(1) + \sum_{y_i > \theta}(1) &= 0 \\
\sum_{y_i < \theta}(1) &= \sum_{y_i > \theta}(1) \\
\end{aligned}
$$

ูุงุฐุง ุชุนูู ุงููุชูุฌู ูู ุงูุฃุนููุ ุนูู ุงููุณุงุฑุ ูุฏููุง ูููู ูุงุญุฏู ููู ููุทู ุงูู ูู $ \theta $. ูุนูู ุงูููููุ ูุฏููุง ูููู ูุงุญุฏู ุงูุถุงู ููู ููุทู ุงุนูู ูู $ \theta $. ุงูุขูุ ูู ุงุฌู ุงู ุชููู ุงููุนุงุฏูู ุตุญูุญูุ ูุญุชุงุฌ ุงู ูุฎุชุงุฑ ูููู ู $ \theta $ ูุฏููุง ููุณ ุงูุฑูู ูููุทู ุงูู ูุงุนูู. ูุฐุง ูู ุชุนุฑูู *ุงููุณูุท Median* ููุฌููุนู ูู ุงูุฃุฑูุงู. ูุฐุงุ ุงููููู ุงูุฃูู ู $ \theta $ ูู MAE ูู $ \hat \theta = \text{median} (\textbf{y}) $.

ุนูุฏูุง ูููู ูุฏููุง ุนุฏุฏ ูุฑุฏู ูู ุงูููุงุทุ ุงููุณูุท ูู ุจุจุณุงุทู ุงูููุทู ูู ุงููุณุท ุจุนุฏ ุชุฑุชูุจ ุงูููุงุท. ูููู ุงู ูุฑู ูุซุงู ุนูู ุฐุงู  ูู ุฎูุณ ููุงุทุ ูุชู ุชูููู ุงูุฎุณุงุฑู ุนูุฏูุง ุชููู $ \theta $ ูู ุงููุณูุท:

```python
# ูุฑู ุงุฎุฑูุ ุงููุงุชุจ ุนุฑู ุฏุงูุฉ ุชุณุงุนุฏู ุนูู ุงูุญุณุงุจ ูุงูุฑุณู
# ูุง ุชุญุชุงุฌ ููุนุฑูู ูุนูู ุงูููุฏ ุงูุจุฑูุฌู
def points_and_loss(y_vals, xlim, loss_fn=abs_loss):
    thetas = np.arange(xlim[0], xlim[1] + 0.01, 0.05)
    abs_losses = [loss_fn(theta, y_vals) for theta in thetas]
    
    plt.figure(figsize=(9, 2))
    
    ax = plt.subplot(121)
    sns.rugplot(y_vals, height=0.3, ax=ax)
    plt.xlim(*xlim)
    plt.xlabel('Points')
    
    ax = plt.subplot(122)
    plt.plot(thetas, abs_losses)
    plt.xlim(*xlim)
    plt.xlabel(r'$ \theta $')
    plt.ylabel('Loss')

points_and_loss(np.array([10, 11, 12, 14, 15]), (9, 16))
```

<p align='center'>
<img src='{{ site.baseurl }}/img/chapter10/mae-median-odd.png'>
</p>

ููููุ ุนูุฏูุง ูููู ูุฏููุง ุนุฏุฏ ุฒูุฌู ูู ุงูุฃุฑูุงูุ ุชูููู ุงูุฎุณุงุฑู ุนูุฏูุง ุชููู $ \theta $ ูู ุงููููู ุงูุชู ุจูู ุงูููุทุชูู ูู ุงููุณุท. ูุซุงู:

```python
points_and_loss(np.array([10, 11, 14, 15]), (9, 16))
```

<p align='center'>
<img src='{{ site.baseurl }}/img/chapter10/mae-median-even.png'>
</p>

ููุง ูุทุจู ุฐูู ุนูุฏูุง ูุณุชุฎุฏู MSE:

```python
points_and_loss(np.array([10, 11, 14, 15]), (9, 16), mse_loss)
```

<p align='center'>
<img src='{{ site.baseurl }}/img/chapter10/mse-loss.png'>
</p>

### ููุงุฑูุฉ MSE ู MAE

ุชุญููููุง ูุงููุดุชูุงุช ูู ุงูุฃุนูู ุชูุธูุฑ ููุง MSE ุงุณูู ููุฅุณุชุฎุฏุงู ูุฅูุฌุงุฏ ุงูุฅุดุชูุงู ููููุง ุชุชุฃุซุฑ ุดูู ูุจูุฑ ูู ุงูุจูุงูุงุช ุงูุดุงุฐู ุนูู ุนูุณ MAE. ุจุงููุณุจู ู MSEุ ูุฃู $ \hat{\theta} = \text{mean}(\textbf{y}) $ุ ูู MAE ูุฃู $ \hat{\theta} = \text{median}(\textbf{y}) $. ูุงุญุธ ุงู ุงููุณูุท ุงูู ุชุฃุซุฑุงู ุจุงูููู ุงูุดุงุฐู ุนู ุงููุชูุณุท. ุธูุฑ ููุง ุฐูู ุงุซูุงุก ุชุนุฑูู ูุจูุงุก ุฏุงูุชู ุงูุฎุณุงุฑู MSE ู MAE.

ุฑุฃููุง ุฃูุถุงู ุงู MSE ูุฏููุง $ \hat{\theta} $ ูุฎุชูููุ ูููุง ุงููุชูุณุท ุงูุญุชูู ูููู ุงู ูููู ุงูุซุฑ ุงุญุชูุงู ูู $ \hat{\theta} $ ุนูุฏูุง ูููู ุนุฏุฏ ุงูููุงุท ูู ุงูุจูุงูุงุช ุฒูุฌู.

#### ุฏุงูุฉ ุงูุฎุณุงุฑู Huber

ุฏุงูุฉ ุงูุฎุณุงุฑู ุงูุซุงูุซู ูุทูู ุนูููุง ุฏุงูุฉ Huber ูุงูุชู ุชุฌูุน ุจูู MSE ู MAE ูุชููู ููุง ุฏุงูุฉ ุฎุณุงุฑู ูุงุจูู ููุฅุดุชูุงู ููุง ุชุชุฃุซุฑ ุจุงูููู ุงูุดุงุฐู. ุชูุนู ุฐูู ุฏุงูุฉ Huber ุนู ุทุฑูู ุงูุนูู ููุฃููุง ุฏุงูุฉ MSE ูููู $ \theta $ ุนูุฏูุง ุชููู ูุฑูุจู ูู ุงูููู ุงูุฏููุง ูุงูุชุบููุฑ ุฅูู MAE ุนูุฏูุง ุชููู ููู $ \theta $ ุจุนูุฏู ุนู ุงูููู ุงูุฏููุง.

ููุง ูู ุงูุบุงูุจุ ููุดุฃ ุฏุงูุฉ ุฎุณุงุฑู ุนู ุทุฑูู ุงุฎุฐ ุงููุชูุณุท ููู ุฎุณุงุฑู Huber ููู ููุทู ูู ุจูุงูุงุชูุง.

ููุฑู ูุชูุฌุฉ ุฏุงูุฉ ุงูุฎุณุงุฑู Hurber ุนูุฏูุง ุชููู ุจูุงูุงุชูุง ุนุจุงุฑู ุนู $ \textbf{y} = [14] $ ูุน ููู ูุฎุชููู ู $ \theta $:

```python
def huber_loss(est, y_obs, alpha = 1):
    d = np.abs(est - y_obs)
    return np.where(d < alpha, 
                    (est - y_obs)**2 / 2.0,
                    alpha * (d - alpha / 2.0))

thetas = np.linspace(0, 50, 200)
loss = huber_loss(thetas, np.array([14]), alpha=5)
plt.plot(thetas, loss, label="Huber Loss")
plt.vlines(np.array([14]), -20, -5,colors="r", label="Observation")
plt.xlabel(r"Choice for $\theta$")
plt.ylabel(r"Loss")
plt.legend()
plt.savefig('huber_loss.pdf')
```

<p align='center'>
<img src='{{ site.baseurl }}/img/chapter10/huber-loss14.png'>
</p>

ููุงุญุธ ุงู ุฎุท ุฏุงูุฉ ุงูุฎุณุงุฑู Huber ุณูุณุ ุนูู ุนูุณ MAE. ุงูุถุงู ุชุฒุฏุงุฏ ุฎุณุงุฑุฉ Huber ุจูุนุฏู ุฎุทูุ ุนูู ุนูุณ ุงููุนุฏู ุงูุชุฑุจูุนู ููุชูุณุท ุงูุฎุณุงุฑู ุงูุชุฑุจูุนูู.

ูููู ูุฏู ุฏุงูุฉ ุฎุณุงุฑุฉ Huber ุนูุจ. ูุงุญุธ ุงููุง ุชุบูุฑุช ูู MSE ุฅูู MAE ุนูุฏูุง ูุงูุช $ \theta $ ุงุจุนุฏ ุนู ุงูููุงุท. ูููููุง ุงูุชุญูู ุจูุฏู ุงูุจุนุฏ ููุญุตูู ุนูู ููุญููุงุช ุฎุณุงุฑู ุงุฎุฑู. ูุซูุงูุ ูููููุง ุงู ูุฌุนููุง ุชุจุฏุฃ ุจุงูุชุบููุฑ ุนูุฏูุง ุชููู $ \theta $ ุงูุฑุจ ุจููุทู ุนู ุงููููู ุงูุฏููุง:

```python
loss = huber_loss(thetas, np.array([14]), alpha=1)
plt.plot(thetas, loss, label="Huber Loss")
plt.vlines(np.array([14]), -20, -5,colors="r", label="Observation")
plt.xlabel(r"Choice for $\theta$")
plt.ylabel(r"Loss")
plt.legend()
plt.savefig('huber_loss.pdf')
```

<p align='center'>
<img src='{{ site.baseurl }}/img/chapter10/huber-loss14-withparameter1.png'>
</p>

ุงู ูููููุง ุชุบูุฑ ุฐูู ูุฌุนููุง ุชุชุบูุฑ ุนูุฏูุง ุชููู $ \theta $ ุนูู ุจุนุฏ ุนุดุฑ ููุงุท ูู ุงููููู ุงูุฏููุง:

```python
loss = huber_loss(thetas, np.array([14]), alpha=10)
plt.plot(thetas, loss, label="Huber Loss")
plt.vlines(np.array([14]), -20, -5,colors="r", label="Observation")
plt.xlabel(r"Choice for $\theta$")
plt.ylabel(r"Loss")
plt.legend()
plt.savefig('huber_loss.pdf')
```

<p align='center'>
<img src='{{ site.baseurl }}/img/chapter10/huber-loss14-withparameter10.png'>
</p>

ุงูุฎูุงุฑ ููุง ูููู ููุง ููุญูู ูุฎุชูู ูุฎุท ุงูุฎุณุงุฑู ููุง ููุชุฌ ููุง ุงูุถุงู ููู ูุฎุชููู ู $ \hat \theta $. ุงุฐุง ุงุฑุฏูุง ุงุณุชุฎุฏุงู ุฏุงูุฉ ุงูุฎุณุงุฑู Huberุ ูุฏููุง ูููู ุงุฎุฑู ููู ุชุญุฏูุฏ ููุทุฉ ุงูุชุบููุฑ ูุฌุนููุง ูููู ููุงุณุจู.

ูููููุง ุชุนุฑูู ุฏุงูุฉ Huber ุฑูุงุถูุงู ูุงูุชุงูู:

$$
L_\alpha(\theta, \textbf{y}) = \frac{1}{n} \sum_{i=1}^n \begin{cases}
    \frac{1}{2}(y_i - \theta)^2 &  | y_i - \theta | \le \alpha \\
    \alpha ( |y_i - \theta| - \frac{1}{2}\alpha ) & \text{otherwise}
\end{cases}
$$

ูู ุงูุซุฑ ุชุนููุฏุงู ูู ุฏูุงู ุงูุฎุณุงุฑู ุงูุณุงุจูู ูุฃููุง ุชุฌูุน ุจูู MSE ู MAE. ุงููุชุบูุฑ ุงูุฅุถุงูู $ \alpha $ ูุญุฏุฏ ููุงู ููุทู ุงูุชุบููุฑ ูู ุฏุงูุฉ Huber ูู MSE ุฅูู MAE.

ูุญุงููุฉ ุฅูุฌุงุฏ ููุดุชูุฉ ุฏุงูุฉ Huber ุนูููู ูููู ููุง ุชูุชุฌุฏ ูุชุงุฆุฌ ูุงุถุญู ููููููู ููุง ูู MSE ู MAE. ุจุฏูุงู ูู ุฐููุ ูููููุง ุงุณุชุฎุฏุงู ุงูุนููููุฉ ุงูุญุณุงุจูู ุงููุณูุงู ุงููุฒูู ุงูุฅุดุชูุงูู ูุฅูุฌุงุฏ ุงููููู ุงูุฃูู ู $ \theta $.

### ููุฎุต ุฏุงูุชู ุงูุฎุณุงุฑู Absolute ู Huber

ูู ูุฐุง ุงูุฌุฒุกุ ุชุนุฑููุง ุนูู ุฏุงูุชู ุฎุณุงุฑู: ูุชูุณุท ุงูุฎุทุฃ ุงูุญุชูู ู ุฏุงูุฉ Huber. ููุฌุฏูุง ุฃู ููููุฐุฌ ุซุงุจุช ุจุฅุณุชุฎุฏุงู MAE ูุฃู $ \hat{\theta} = \text{median}(\textbf{y}) $.

[PopulationParameterEN]: https://www.youtube.com/watch?v=vikkiwjQqfU
[PopulationParameterAR]: https://www.youtube.com/watch?v=KabwGtDbNUs
[ParabolaEN]: https://www.mathsisfun.com/geometry/parabola.html