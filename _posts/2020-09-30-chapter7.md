---
title: تقنيات الويب
show_title: true
chapter_number: 7
chapter_text: الفصل السابع
chapter_lessons: [[0, 'مقدمة'], [1, 'HTTP']]
chapter_sublessons: [
    [],
    [['الطلب والرد', 'بايثون', 'الطلب', 'الرد'], ['انواع الطلبات', 'طلب GET', 'طلب POST'], 'انواع رموز الحالة للردود', 'ملخص']
]
layout: default
---

## مقدمة

قبل ظهور الانترنت، كان علماء البيانات يقومون بنقل الأقراص الصلبه بينهم يدوياً لمشاركة البيانات. الآن، يمكننا بسهوله البحث وإستيراد البيانات من اجهزة الكمبيوتر حول العالم.

على الرغم من اننا نستخدم الانترنت لتحميل ومشاركة ملفات البيانات، مواقع الانترنت ايضاً تحتوي على عدد كبير من المعلومات محفوظة كنصوص، صور أو فيديو. بتعلم تقنيات الويب، يمكننا ان نستخدمها كمصدر للبيانات. في هذا الفصل، سنتعرف على HTTP، الطريقة الأساسية للتواصل في الويب، و XML/HTML، التنسيقات الأساسية للملفات في مواقع الانترنت.

## HTTP

ال HTTP (أو **H**yper**T**ext **T**ransfer **P**rotocol) هي وسيلة وبروتوكول للطلب والرد وتسمح لجهاز كمبيوتر بالتواصل مع جهاز اخر عبر الانترنت.

### الطلب والرد

يسمح الانترنت لأجهزة الكمبيوتر بإرسال النصوص بينها، ولكن بدون اي قيود عن نوع النصوص. تقوم HTTP بإنشاء هيكل للنصوص اثناء التواصل بين الجهاز الأول (العميل) والجهاز الثاني (الخادم). في هذا البروتوكول، العميل يقدم طلب *Request* إلى الخادم، مصمم بشكل نصي محدد. يقوم الخادم بالرد *Response* بنص إلى العميل.

اداة سطر الأوامر `curl` تقدم لنا وسيلة سهله لإرسال طلبات HTTP. في النتيجة التاليه، السطر الذي يبدأ ب `<` يعني ان النص ارسل في الطلب؛ الأسطر الباقيه هي رد الخادم:

```python
$ curl -v https://httpbin.org/html
```

```ruby
> GET /html HTTP/1.1
> Host: httpbin.org
> User-Agent: curl/7.55.1
> Accept: */*
> 
< HTTP/1.1 200 OK
< Connection: keep-alive
< Server: meinheld/0.6.1
< Date: Wed, 11 Apr 2018 18:15:03 GMT
< 
<html>
  <body>
    <h1>Herman Melville - Moby-Dick</h1>
    <p>
      Availing himself of the mild...
    </p>
  </body>
</html>
```

تشغيل الأمر `curl` يجعل جهاز العميل يكتب رسالة تبدو بهذا الشكل:

```ruby
GET /html HTTP/1.1
Host: httpbin.org
User-Agent: curl/7.55.1
Accept: */*
{blank_line}
```

تتبع هذه الرساله شكلاً معيناً: تبدأ ب `GET /html HTTP/1.1` والتي تعني ان الرسالة من نوع طلب HTTP `GET` إلى صفحة `/html`. الأسطر الثلاثه التي تلي سطر رأس HTTP، هي معلومات اختياريه ترسلها `curl` إلى الخادم. رؤوس HTTP Headers شكلها كالتالي `{name}: {value}`. اخيراً، السطر الفارغ في نهاية الرساله يخبر الخادم ان الرسالة انتهت بعد ثلاث رسائل. لاحظ اننا اشرنا للسطر الفارغ ب `{blank_line}` في المثال؛ ولكن في رسالة حقيقيه تستبدل `{blan_line}` بسطر فارغ بدون اي نص.

إذا، جهاز العميل يستخدم الانترنت لإرسال رسالة إلى خادم الويب `https://httpbin.org`. الخادم يعالج الطلب، ثم يقوم بإرسال الرد التالي:

```ruby
HTTP/1.1 200 OK
Connection: keep-alive
Server: meinheld/0.6.1
Date: Wed, 11 Apr 2018 18:15:03 GMT
{blank_line}
```

السطر الأول من الرد يشير على ان الطلب تم بنجاح. الأسطر الثلاثه التي تلي سطر HTTP، هي معلومات اختياريه يرسلها الخادم إلى العميل. اخيراً السطر الفارغ يخبر جهاز العميل ان الخادم انهى رسالته الأوليه ثم سيقوم بإرسال المحتوى Body:

```ruby
<html>
  <body>
    <h1>Herman Melville - Moby-Dick</h1>
    <p>
      Availing himself of the mild...
    </p>
  </body>
</html>
```

بروتوكول HTTP يستخدم بواسطة اغلب التطبيقات التي تتعامل مع الانترنت. مثلاً، زيارة الموقع [https://httpbin.org/html](https://httpbin.org/html) عبر متصفحك يرسل طلب HTTP مشابه لطلب `curl`. بدلاً من اظهار الرد كنص فقط كما شاهدنا مسبقاً، يتعرف المتصفح ان النص عباره عن ملف HTML فيظهره بالشكل المطلوب.

عملياً، لن نكتب طلب HTTP كامل كنص. بدلاً من ذلك، سنستخدم ادوات مثل `curl` او مكتبات في بايثون لبناء الطلب عنا.

#### بايثون

مكتبة **Requests** في بايثون تسمح لنا بإنشاء طلب HTTP. الكود البرمجي التالي ينشأ طلب HTTP مشابه للطلب `curl -v https://httpbin.org/html`:

```python
import requests

url = "https://httpbin.org/html"
response = requests.get(url)
response
```

```ruby
<Response [200]>
```

#### الطلب

لنلقي نظره اقرب على الطلب السابق. يمكننا تصفح الطلب الرئيسي بإستخدام كائن `response`؛ سنظهر رأس طلب HTTP:

```python
request = response.request
for key in request.headers: # رأس HTTP في الرد محفوظ في مصفوفه
    print(f'{key}: {request.headers[key]}')
```

```ruby
User-Agent: python-requests/2.12.4
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
```

كل طلب عبر HTTP لديه نوع. في الحاله السابقه، استخدمنا طلب `GET` والذي يجلب بيانات من الخادم.

```python
request.method
```

```ruby
`GET`
```

#### الرد

لنتحقق من الرد الذي حصلنا عليه من الخادم. اولاً، سنطبع رأس HTTP للرد:

```python
for key in response.headers:
    print(f'{key}: {response.headers[key]}')
```

```ruby
Connection: keep-alive
Server: gunicorn/19.7.1
Date: Wed, 25 Apr 2018 18:32:51 GMT
Content-Type: text/html; charset=utf-8
Content-Length: 3741
Access-Control-Allow-Origin: *
Access-Control-Allow-Credentials: true
X-Powered-By: Flask
X-Processed-Time: 0
Via: 1.1 vegur
```

يحتوي رد HTTP على رمز للحاله، رقم خاص يبين اذا نجح او فشل الطلب. الرمز `200` يعني ان الطلب تم بنجاح:

```python
response.status_code
```

```ruby
200
```

اخيراً، سنظهر اول 100 حرف من محتوى الرد (الرد الكامل محتواه كبير ولا يظهر بشكل جيد هنا):

```python
response.text[:100]
```

```ruby
'<!DOCTYPE html>\n<html>\n  <head>\n  </head>\n  <body>\n      <h1>Herman Melville - Moby-Dick</h1>\n\n     '
```

### انواع الطلبات

الطلب السابق كان طلب `GET`. هناك عدة انواع من طلبات HTTP؛ اكثر الطلبات اهميه هي `GET` و `POST`.

#### طلب GET

طلب `GET` يستخدم لإستيراد معلومات من الخادم. بما ان المتصفح ييقوم بطلب `GET` كل مره تدخل فيها رابط لموقع، يعتبر لذلك طلب `GET` من اكثر الطلبات استخداماً من طلبات HTTP.

تستخدم `curl` طلب `GET` دائماً، الامر `curl https://www.google.com/` يقوم بإنشاء طلب `GET` ل `https://www.google.com/`.

#### طلب POST

الطلب `POST` يستخدم لإرسال معلومات من العميل إلى الخادم. مثلاً، بعض المواقع تحتوي على حقول نحتاج ان نملئها، مثل حقول تسجيل الدخول. عند الضغط على زر "ادخال"، اكثر المتصفحات ستقوم بإنشاء طلب `POST` لإرسال البيانات الحقول إلى الخادم ليجري العمليات عليها.

لنرى مثلاً على طلب `POST` يرسل الكلمة `sam` كالمتغير `name`. يمكن فعل ذلك كالتالي `curl -d 'name=sam' https://httpbin.org/post` في سطر الأوامر.

لاحظ ان طلبنا لديه محتوى الآن (عندما عبئنا المتغير في طلب POST)، ومحتوى الرد سيكون مختلف عن محتوى رد `GET` السابق.

كما في رؤوس HTTP، تستخدم طلبات `POST` نفس الشكل مفتاح-قيمه key-value. في بايثون، نستخدم `requests.post` مع تمرير المتغيرات كمصفوفات لإنشاء طلبات `POST`:

```python
post_response = requests.post("https://httpbin.org/post",
                              data={'name': 'sam'})
post_response
```

```ruby
<Response [200]>
```

الخادم سيرد برمز للحاله لينوه إذا ما كانت عملية طلب `POST` تمت بنجاح. ايضاً، يرسل الخادم عادة محتوى ليعرض للعميل:

```python
post_response.status_code
```

```ruby
200
```

```python
post_response.text
```

```ruby
'{\n  "args": {}, \n  "data": "", \n  "files": {}, \n  "form": {\n    "name": "sam"\n  }, \n  "headers": {\n    "Accept": "*/*", \n    "Accept-Encoding": "gzip, deflate", \n    "Connection": "close", \n    "Content-Length": "8", \n    "Content-Type": "application/x-www-form-urlencoded", \n    "Host": "httpbin.org", \n    "User-Agent": "python-requests/2.12.4"\n  }, \n  "json": null, \n  "origin": "136.152.143.72", \n  "url": "https://httpbin.org/post"\n}\n'
```

### انواع رموز الحالة للردود

ردود HTTP السابقه تحتوي على رمز `200` لحالة الرد. هذا الرمز يخبرنا ان الطلب تم بنجاح. هناك الكثير من الرموز الأخرى لحالات الرد ل HTTP. لحسن حظنا انها مجموعة كمجموعات لتكون اسهل لنا للحفظ: [📝][HTTPStatusCodes]

- ردود 100: معلوماتيه: رد على انه مطلوب معلومات اكثر من الخادم او العميل. (مثلاً 100 استمرار، 102 جاري العمل).
- ردود 200: نجاح: طلب العميل تم بنجاح. (مثلاً 200 نجاح، 202 مقبول).
- ردود 300: إعادة توجيه: الرابط URL المطلوب موجود بمكان آخر؛ ربما يحتاج لقرار اضافي من المستخدم. (مثلاً 300 اختيارات، 301 منقول بشكل كامل).
- ردود 400: خطأ من العميل: خطأ من جهة العميل (مثلاً 400 طلب خاطئ, 403 محظور, 404 غير موجود).
- ردود 500: خطأ من الخادم: خطأ من جهة الخادم او ان الخادم لا يمكنه من اجراء الطلب (مثلاً 500 خطأ داخلي في الخادم، 503 الخدمة غير موجودة)

يمكننا عرض بعض الأمثله على الأخطاء:

```python
# هذه الصفحه غير موجوده، سنحصل على رمز الخطأ بعدم وجود الصفحه 404
url = "https://www.youtube.com/404errorwow"
errorResponse = requests.get(url)
print(errorResponse)
```

```ruby
<Response [404]>
```

```python
# رد الرد لهذه الصفحه 500 خطأ في الخادم
url = "https://httpstat.us/500"
serverResponse = requests.get(url)
print(serverResponse)
```

```ruby
<Response [500]>
```

### ملخص

تعرفنا على بروتوكولات HTTP، الطرق البسيطه للتواصل بين البرامج التي تستخدم الويب. على الرغم ان البروتوكول يحدد شكل معين للنصوص، ننتقل عادةً لأدوات اخرى لكتابة طلبات HTTP لنا، مثل اداة سطر الأوامر `curl` او مكتبة `requests` في بايثون.



[HTTPStatusCodes]: https://www.restapitutorial.com/httpstatuscodes.html