---
title: النماذج الخطية
show_title: true
chapter_number: 13
chapter_text: الفصل الثالث عشر
chapter_lessons: [[0, 'مقدمة'], [1, 'التنبؤ بالإكراميات'], [2, 'ضبط النموذج الخطي بإستخدام النزول الإشتقاقي'], [3, 'الإنحدار الخطي المتعدد'], [4, 'المربعات الصغرى - منظور هندسي'], [5, 'تطبيق عملي للإنحدار الخطي']]
chapter_sublessons: [
    [],
    [['تعريف نموذج خطي بسيط', 'توقع النموذج الخطي']],
    ['مشتقة الخسارة التربيعية المتوسطة MSE', 'تطبيق النزول الإشتقاقي'],
    ['الخسارة التربيعية المتوسطة وإنحدارها', 'ضبط النموذج مع النزول الإشتقاقي', 'الرسم البياني لتنبؤاتنا', 'استخدام كامل البيانات', 'ملخص الإنحدار الخطي المتعدد'],
    ['المربعات الصغرى: النموذج الثابت', 'المربعات الصغرى: نموذج خطي بسيط', 'الفكره الهندسيه', 'الجبر الخطي', 'انهاء الدراسه', 'عندما تعتمد المتغيرات خطياً', 'طريقتين للتفكير'],
    ['نظره عامه على البيانات', 'تنظيف البيانات', 'فصل بيانات التدريب والإختبار', 'استكشاف البيانات وتصويرها', 'النماذج الخطيه البسيطه', 'تحويل المتغيرات', 'نموذج الإنحدار الخطي المتعدد', 'تقييم نموذجنا'],
]
layout: default
---

## مقدمة

الآن، بعد ان تعلمنا بشكل عام ادوات لضبط النماذج مع دوال التكلفه، نتحول لطرق تحسين النموذج. للتبسيط، في السابق حددنا عملنا على النموذج الثابت: نموذجنا فقط يتوقع رقم واحد.

ولكن، إعطاء نموذج كهذا للمضيف لن يرضيه. يود المضيف ان يوضح انه حصل على معلومات اكثر نسبة الإكراميه من الطاولات التي خدمها. لماذا لا نستخدم بياناته الأخرى، مثلاً حجم العملاء في الطاوله ومجموع الفاتوره، لغرض جعل النموذج اكثر فائدة.

في هذا الفصل سنتعرف على النماذج الخطية والذي يسمح لنا بإستخدام جميع البيانات التي لدينا لإجراء توقعات. النماذج الخطية لا تستخدم بنطاقٍ واسع فقط، بل ايضاً لديها اسس نظريه غنية بالمعلومات التي تجعلنا نفهم ادوات مستقبليه للنماذج. سنتعرف على نموذج الإنحدار الخطي البسيط الذي يستخدم متغير واحد، سنتعلم كيف يستخدم النزول الإشتقاقي لضبط النموذج، واخيراً التوسع في النموذج وإضافة المزيد من المتغيرات له.

## التنبؤ بالإكراميات

سابقاً، تعاملنا مع بيانات تحتوي على سطر واحد لكل طاولة قام المضيف بخدمتها لمدة اسبوع. المضيف قام بجمع البيانات للقيام بالتوقع بقيمة الإكرامية التي سيحصل عليها في المستقبل:

```python
tips = sns.load_dataset('tips')
tips.head()
```

|**size**|**time**|**day**|**smoker**|**sex**|**tip**|**total\_bill**| 
|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:
|2|Dinner|Sun|No|Female|1.01|16.99|0
|3|Dinner|Sun|No|Male|1.66|10.34|1
|3|Dinner|Sun|No|Male|3.5|21.01|2
|2|Dinner|Sun|No|Male|3.31|23.68|3
|4|Dinner|Sun|No|Female|3.61|24.59|4

<br>
```python
sns.distplot(tips['tip'], bins=25);
```

<p align="center"> 
<img src='{{ site.baseurl }}/img/chapter13/linear_tips_3_0.png'>
</p>

كما تحدثنا سابقاً، اذا اخترنا النموذج الثابت ودالة الخطأ التربيعي المتوسط، فأن نموذجنا سيتوقع متوسط الإكراميات:

```python
np.mean(tips['tip'])
```

```ruby
2.9982786885245902
```

يعني ذلك ان عندما يأتي مجموعة من الزبائن للمضيف ثم يسألنا المضيف عن مجموعه الإكرامية التي سيحصل عليها، فسنجيب عليه "حوالي $ \\$3 $"، اياً كان عدد الزبائن ومجموع الفاتوره.

ولكن، عند التحقق من باقي المتغيرات في البيانات، يمكننا ان نقوم بتوقعات دقيقه إذا اضفنا تلك المتغيرات للنموذج. مثلاً، الرسم البياني التالي يوضح مجموع الإكراميه مقارنة بمبلغ الفاتورة ويظهر العلاقة الإيجابية بينهما:

```python
sns.lmplot(x='total_bill', y='tip', data=tips, fit_reg=False)
plt.title('Tip amount vs. Total Bill')
plt.xlabel('Total Bill')
plt.ylabel('Tip Amount');
```

<p align="center"> 
<img src='{{ site.baseurl }}/img/chapter13/linear_tips_7_0.png'>
</p>

على الرغم ان متوسط الإكراميه هو $ \\$3 $، اذا كانت الطاولة طلبت ما مجموعه $ \\$40 $ من الوجبات فأننا متأكدين ان المضيف سيحصل على اكثر من $ \\$3 $ كأكرامية. لذا، نريد التعديل في نموذجنا ليتمكن من التوقع بناءًا على متغيرات في بياناتنا بدلاً من توقع متوسط الإكرامية. للقيام بذلك، سنستخدم النموذج الخطي بدلاً من الثابت.

لنراجع أولاً الأدوات التي لدينا لبناء النموذج والتوقع وتعريف بعض الرموز الجديده لنتمكن بشكل افضل من تمثيل العمليات الرياضيه الإضافيه في النموذج الخطي.

### تعريف نموذج خطي بسيط

نحن مهتمون بتوقع قيمة الإكراميه بناءًا على مجموع الفاتوره. لنجعل $ y $ تمثل مجموع الإكراميه، المتغير الذي نريد ان يتوقعه النموذج. و $ x $ تمثل مجموع الفاتوره، المتغير الذي نريد استخدامه للتوقع.

نقوم بتعريف النموذج الخطي $ f_\boldsymbol\theta^* $ الذي يعتمد على $ x $:

$$ f_\boldsymbol\theta^* (x) = \theta_1^* x + \theta_0^* $$

نتعامل مع $ f_\boldsymbol\theta^* (x) $ على انها الدالة التي أنشأت البيانات.

تفترض $ f_\boldsymbol\theta^* (x) $ ان $ y $ لديها علاقه خطيه كامله مع $ x $. ولكن، في بياناتنا لا يظهر لنا خط مستقيم بسبب وجود بعض البيانات العشوائية المزعجه $ \epsilon $. رياضياً، نأخذ بعين الإعتبار هذه المشكله بإضافة المصطلح:

$$ y = f_\boldsymbol\theta^* (x) + \epsilon $$

أذا كانت الإفتراضيه ان $ y $ لديها علاقخ خطية كامله مع $ x $، وتمكنا بطريقة ما من توقع القيمة الصحيحه ل $ \theta_1^* $ و $ \theta_0^* $، وبشكل غير اعتيادي لم يكنا لدينا أي عشوائية في البيانات، سنتمكن من التوقع بشكل دقيق قيمة الإكرامية التي سيحصل عليها المضيف من جميع الزبائن، وبشكل دائم. بالطبع، لا يمكننا تلبية جميع المعايير في الحياه الواقعية. بدلاً من ذلك، نتوقع $ \theta_1^* $ و $ \theta_0^* $ بإستخدام البيانات لجعل توقعاتنا اقرب دقه للواقع.

#### توقع النموذج الخطي

بما أننا لا نستطيع إيجاد قيمة $ \theta_1^* $ و $ \theta_0^* $ بشكل دقيق، سنفترض ان بياناتنا تتوقع قيمة هذه المتغيرات. نشير للتوقعات ب $ \theta_1 $ و $ \theta_0 $، وتوقعنا الذي يتم ضبطه بالنموذج ب $ \hat{\theta_1} $ و $ \hat{\theta_0} $، و النموذج:

$$ f_\boldsymbol\theta (x) = \theta_1 x + \theta_0 $$

أحياناً سترى $ h(x) $ بدلاً من $ f_\hat{\boldsymbol\theta} (x) $؛ ال $ h $ تعني الفرضية *Hypothesis*، كون $ f_\hat{\boldsymbol\theta} (x) $ هي فرضيتنا ل $ f_{\boldsymbol\theta^*} (x) $.

من أجل تحديد قيمة $ \hat{\theta_1} $ و $ \hat{\theta_0} $، نقوم بإختيار دالة تكلفة وتقليلها بإستخدام النزول الإشتقاقي.


## ضبط النموذج الخطي بإستخدام النزول الإشتقاقي

### مشتقة الخسارة التربيعية المتوسطة MSE

### تطبيق النزول الإشتقاقي

## الإنحدار الخطي المتعدد

### الخسارة التربيعية المتوسطة وإنحدارها

### ضبط النموذج مع النزول الإشتقاقي

### الرسم البياني لتنبؤاتنا

### استخدام كامل البيانات

### ملخص الإنحدار الخطي المتعدد

## المربعات الصغرى - منظور هندسي

### المربعات الصغرى: النموذج الثابت

### المربعات الصغرى: نموذج خطي بسيط

### الفكره الهندسيه

### الجبر الخطي

### انهاء الدراسه

### عندما تعتمد المتغيرات خطياً

### طريقتين للتفكير

## تطبيق عملي للإنحدار الخطي

### نظره عامه على البيانات

### تنظيف البيانات

### فصل بيانات التدريب والإختبار

### استكشاف البيانات وتصويرها

### النماذج الخطيه البسيطه

### تحويل المتغيرات

### نموذج الإنحدار الخطي المتعدد

### تقييم نموذجنا


[📝][link1]

[link1]: https://ar.wikipedia.org/wiki/%D9%85%D8%AC%D8%A7%D9%84_%D8%AB%D9%82%D8%A9
