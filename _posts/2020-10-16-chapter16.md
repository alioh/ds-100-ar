---
title: ุงูุถุจุท
show_title: true
chapter_number: 16
chapter_text: ุงููุตู ุงูุณุงุฏุณ ุนุดุฑ
chapter_lessons: [[0, 'ููุฏูุฉ'], [1, 'ููุฑุฉ ุงูุถุจุท'], [2, 'ุงูุถุจุท: ุงูุฅูุญุฏุงุฑ ุงูุฌุจูู'], [3, 'ุงูุถุจุท: ุฅูุญุฏุงุฑ ุงูููู']]
chapter_sublessons: [
    [],
    ['ุจูุงูุงุช ุณุฏ ุงูููุงุฉ', 'ุงูุชุญูู ูู ุงููุนุงููุงุช', 'ูุนุงูุจุฉ ุงููุนููููุงุช'],
    ['ุงูุชุนุฑูู', 'ุฅุณุชุฎุฏุงู ุงูุฅูุญุฏุงุฑ ุงูุฌุจูู', 'ููุฎุต ุงูุฅูุญุฏุงุฑ ุงูุฌุจูู'],
    ['ุชุนุฑูู ุงูุถุจุท', 'ุงูููุงุฑูุฉ ุจูู ุงูุฅูุญุฏุงุฑ ุงูุฌุจูู ูุงูููู', 'ุงุฎุชูุงุฑ ุงูุฎุตุงุฆุต ูุน ุฅูุญุฏุงุฑ ุงูููู', 'ุงูุฌุจูู ร ุงูููู ุนูููุงู', 'ููุฎุต ุฅูุญุฏุงุฑ ุงูููู' ]

]
layout: default
---

## ููุฏูุฉ

ูููู ูููุฏุณุฉ ุงูุฎุตุงุฆุต ุงู ุชูุฏู ููุง ูุนูููุงุช ูููุฉ ุนู ุฎุทูุงุช ุชูููุฏ ุงูุจูุงูุงุช ูู ุงููููุฐุฌ. ููููุ ุฅุถุงูุฉ ุงูุฎุตุงุฆุต ุฅูู ุงูุจูุงูุงุช ุนุงุฏุฉ ูุง ูุฒูุฏ ูู ุงูุชุจุงูู ูู ูููุฐุฌูุง ููููู ูุฐู ุงู ูุณูุก ูู ุฃุฏุงุกุฉ ุจุดูู ุนุงู. ุจุฏูุงู ูู ุฅูุดุงุก ุงูุฎุตุงุฆุต ุจุดูู ุนุดูุงุฆูุ ูููููุง ุฅุณุชุฎุฏุงู ุทุฑููุฉ ุชุณูู ุจู **ุงูุถุจุท Regularization** ููุชูููู ูู ุงูุชุจุงูู ูู ูููุฐุฌูุง ูุน ุงูุฅุณุชูุฑุงุฑ ุจุชูุฏูู ุฃูุจุฑ ูุฏุฑ ูู ุงููุนูููุงุช ุนู ุงูุจูุงูุงุช.

## ููุฑุฉ ุงูุถุจุท

ููุจุฏุฃ ุงูููุงุด ุนู ุงูุถุจุท ุจุฅุณุชุฎุฏุงู ุงููุซุงู ุงูุชุงูู ูุชูุถูุญ ุฃูููุชู.

### ุจูุงูุงุช ุณุฏ ุงูููุงุฉ

ุงูุจูุงูุงุช ุงูุชุงููู ุชูุถุญ ูููุฉ ุงูููุงุฉ ุจุงููุชุฑ ุงูุชู ุชุชุฏูู ูู ุณุฏ ุงูููุงุฉ ูู ุงูููู ู ูููุฉ ุงูุชุบูุฑ ูู ูุณุชูู ุงูููุงุฉ ูู ููุณ ุงูููู ุจุงููุชุฑ.

> ูุชุญููู ุงูุจูุงูุงุช water_large.csv [ุงุถุบุท ููุง]({{ site.baseurl }}/files/chapter16/water_large.csv).

```python
df = pd.read_csv('water_large.csv')
df
```

**water\_flow**|**water\_level\_change**| 
:-----:|:-----:|:-----:
6.04E+10|-15.936758|0
3.32E+10|-29.152979|1
9.73E+11|36.189549|2
...|...|...
2.36E+11|7.08548|20
1.49E+12|46.282369|21
3.78E+11|14.612289|22

```ruby
23 rows ร 2 columns
```

ุนูุฏ ุฑุณู ุงูุจูุงูุงุช ููุงุญุธ ุงูุฅุชุฌุงู ุงูุชุตุงุนุฏู ูุชุฏูู ุงูููุงู ูููุง ูุงูุช ูุณุชููุงุช ุงูููุงุฉ ุฅูุฌุงุจูุฉ:

```python
df.plot.scatter(0, 1, s=50);
```

<p align='center'>
<img src='{{ site.baseurl }}/img/chapter16/reg_intuition_8_0.png'>
</p>

ูููุฐุฌุฉ ูุฐุง ุงูููุทุ ูููููุง ุฅุณุชุฎุฏุงู ูููุฐุฌ ุงูุฅูุญุฏุงุฑ ุงูุฎุทู ูููุฑุจุนุงุช ุงูุตุบุฑู Least Square Linear Regression. ูุธูุฑ ูู ุงูุฑุณู ุงูุจูุงูู ุงูุชุงูู ุงูุจูุงูุงุช ูุชููุนุงุช ุงููููุฐุฌ:

```python
df.plot.scatter(0, 1, s=50);
plot_curve(curves[0])
```

<p align='center'>
<img src='{{ site.baseurl }}/img/chapter16/reg_intuition_10_0.png'>
</p>

> ูู ุงูููุฏ ุงูุจุฑูุฌู ุงูุณุงุจู ุฅุณุชุฎุฏู ุงููุงุชุจ ุงูุฏุงูุฉ `plot_curve` ูุงููุตูููุฉ `curves` ูููุณุงุนุฏุฉ ูู ุงูุฑุณูุ ูุนุฑููุง ูุงูุชุงูู ูุน ุฏุงูุฉ ูุณุงุนุฏุฉ ุฃุฎุฑู `make_curve`:
>
> ```python
>
> import matplotlib.pyplot as plt
> import numpy as np
> import pandas as pd
> from sklearn.pipeline import Pipeline
> from sklearn.preprocessing import PolynomialFeatures
> from sklearn.linear_model import LinearRegression
> from collections import namedtuple
>
> Curve = namedtuple('Curve', ['xs', 'ys'])
>
> def make_curve(clf, x_start=-50, x_end=50):
>     xs = np.linspace(x_start, x_end, num=100)
>     ys = clf.predict(xs.reshape(-1, 1))
>     return Curve(xs, ys)
>
> def plot_curve(curve, ax=plt, **kwargs):
>     ax.plot(curve.xs, curve.ys, **kwargs)
> 
> X = df.iloc[:, [0]].as_matrix()
> y = df.iloc[:, 1].as_matrix()
> 
> degrees = [1, 2, 8, 12]
> clfs = [Pipeline([('poly', PolynomialFeatures(degree=deg, include_bias=False)),
>                   ('reg', LinearRegression())])
>         .fit(X, y)
>         for deg in degrees]
>
> curves = [make_curve(clf) for clf in clfs]
> ```

ูุธูุฑ ูู ุงูุฑุณู ุงูุจูุงูู ุงูุณุงุจู ุฃู ูุฐุง ุงููููุฐุฌ ูุง ูุบุทู ูุงูู ุงูููุงุท ูู ููุท ูุฐู ุงูุจูุงูุงุชุ ูุงููููุฐุฌ ูุฏูุฉ ุฅูุญูุงุฒ ุนุงูู. ููุง ูุนููุง ูู ุงูุณุงุจูุ ูููููุง ุญู ูุฐู ุงููุดููุฉ ุจุฅุถุงูุฉ ุฎุตุงุฆุต ูุชุนุฏุฏุฉ ุงูุญุฏูุฏ ููุจูุงูุงุช. ูููู ุจุฅุถุงูุฉ ุฎุตุงุฆุต ูู ุงูุฏุฑุฌุฉ 2ุ 8 ู 12ุ ุงูุฑุณูู ุงูุจูุงููุฉ ุงูุชุงููุฉ ุชุธูุฑ ูุชุงุฆุฌ ุชุฏุฑูุจ ุงูุจูุงูุงุช ููู ูููุฐุฌ:

```python
plot_curves(curves)
```

<p align='center'>
<img src='{{ site.baseurl }}/img/chapter16/reg_intuition_12_0.png'>
</p>

> ุฅุณุชุฎุฏู ุงููุงุชุจ ุฏุงูุฉ `plot_curves` ูููุณ ุงููุตูููุฉ ุงููุณุชุฎุฏูุฉ ูู ุงููุซุงู ุงูุณุงุจู `curves` ูููุณุงุนุฏุฉ ูู ุฑุณู ุงูููุงุฐุฌุ ูุนุฑููุง ูุงูุชุงูู ูุน ูุฒูุฏ ูู ุงูุฏูุงู ุงููุณุงุนุฏุฉ:
>
> ```python
> 
> def flatten(seq): return [item for subseq in seq for item in subseq]
>
> def plot_data(df=df, ax=plt, **kwargs):
>     ax.scatter(df.iloc[:, 0], df.iloc[:, 1], s=50, **kwargs)
>
> def plot_curves(curves, cols=2):
>     rows = int(np.ceil(len(curves) / cols))
>     fig, axes = plt.subplots(rows, cols, figsize=(10, 8),
>                              sharex=True, sharey=True)
>     for ax, curve, deg in zip(flatten(axes), curves, degrees):
>         plot_data(ax=ax, label='Training data')
>         plot_curve(curve, ax=ax, label=f'Deg {deg} poly')
>         ax.set_ylim(-5e10, 170e10)
>         ax.legend()
>         
>     # ุฅุถุงูุฉ ุงูุฑุณูู ุงููุจูุฑุฉ ูุฅุฎูุงุก ุงูุฅุทุงุฑุงุช
>     fig.add_subplot(111, frameon=False)
>     # ุฅุฎูุงุก ุงูุญุฏูุฏ ูุงูุนูุงูุงุช ูุงูุนูุงููู ูู ุงูุฑุณู
>     plt.tick_params(labelcolor='none', top='off', bottom='off',
>                     left='off', right='off')
>     plt.grid(False)
>     plt.title('Polynomial Regression')
>     plt.xlabel('Water Level Change (m)')
>     plt.ylabel('Water Flow (Liters)')
>     plt.tight_layout()
> ```

ููุง ูู ูุชููุนุ ูุชุนุฏุฏุฉ ุงูุญุฏูุฏ ูู ุงูุฏุฑุฌุฉ ุงูู 12 ุทุงุจูุช ุจูุงูุงุช ุงูุชุฏุฑูุจ ุจุดูู ููุงุณุจ ูููู ูุจุฏู ุงู ุงููููุฐุฌ ูุถุจูุท ุจููุท ุฒุงุฆู ุนูู ุงูุจูุงูุงุช ุจุณุจุจ ุงูุชุดููุด. ูุธูุฑ ุฐูู ูููุฐุฌ ุขุฎุฑ ููููุงูุถุฉ ุจูู ุงูุฅูุญูุงุฒ ูุงูุชุจุงููุ ุงููููุฐุฌ ุงูุฎุทู ูุฏูุฉ ุฅูุญูุงุฒ ุนุงูู ูุชุจุงูู ูููู ุจูููุง ูุชุนุฏุฏุฉ ุงูุญุฏูุฏ ูู ุงูุฏุฑุฌุฉ 12 ูุฏููุง ุฅูุญูุงุฒ ูููู ูุชุจูุงู ุนุงูู.

### ุงูุชุญูู ูู ุงููุนุงููุงุช

ุนูุฏ ุงูุชุญูู ูู ูุนุงููุงุช ูููุฐุฌ ูุชุนุฏุฏุฉ ุงูุญุฏูุฏ ูู ุงูุฏุฑุฌุฉ ุงูู 12 ูุธูุฑ ููุง ุฃู ุงููููุฐุฌ ูููู ุจุงูุชููุน ุจูุงุกูุง ุนูู ุงููุนุงุฏูุฉ ุงูุชุงููุฉ:

$$ \begin{split}
207097470825 + 1.8x + 482.6x^2 + 601.5x^3 + 872.8x^4 + 150486.6x^5 \\
    + 2156.7x^6 - 307.2x^7 - 4.6x^8 + 0.2x^9 + 0.003x^{10} - 0.00005x^{11} + 0x^{12}
\end{split} $$

ูููุง $ x $ ูู ูููุฉ ุชุบูุฑ ูุณุชูู ุงูููุงุฉ ูู ุฐูู ุงูููู.

ูุนุงููุงุช ุงููููุฐุฌ ูุจูุฑุฉ ุฌุฏุงูุ ุฎุงุตุฉ ููุชุนุฏุฏุงุช ุงูุญุฏูุฏ ุฐุงุช ุงูุฏุฑุฌุงุช ุงูุนุงููุฉ ูุงูุชู ุชุณุงูู ุจุดูู ุนุงูู ูู ุชุจุงูู ุงููููุฐุฌ ( ูุซูุงู $ x^5 $ ู $ x^6 $ ).

### ูุนุงูุจุฉ ุงููุนููููุงุช

ููุชุฐูุฑ ุฃู ุงููููุฐุฌ ุงูุฎุทู ูููู ุจุงูุชููุนุงุช ุจูุงุกุงู ุนูู ุงูุชุงููุ $ \theta $ ูู ูุฒู ุงููููุฐุฌ ู $ x $ ูู ูุชูุฌูุฉ ุงูุฎุตุงุฆุต:

$$ f_\hat{\theta}(x) = \hat{\theta} \cdot x $$

ูุถุจุท ุงููููุฐุฌุ ูููู ุจุชูููู ุฏุงูุฉ ุงูุชูููุฉ ููุชูุณุท ุงูุฎุทุฃ ุงูุชุฑุจูุนูุ ูููุง $ X $ ุชูุซู ูุตูููุฉ ุงูุจูุงูุงุช ู $ y $ ูู ุงููุชุงุฆุฌ ุงูุชู ุฅุทูุนุช ุนูููุง:

$$ \begin{split}
\begin{aligned}
L(\hat{\theta}, X, y)
&= \frac{1}{n} \sum_{i}(y_i - f_\hat{\theta} (X_i))^2\\
\end{aligned}
\end{split} $$

ูุชูููู ุงูุชูููุฉ ูู ุงููุนุงุฏูุฉ ุงูุณุงุจูุฉุ ูููู ุจุถุจุท $ \hat{\theta} $ ุญุชู ูุตู ูุฃูุถู ููู ููุฃูุฒุงู Weights ุฃูุงู ูุงู ุญุฌููุง. ูููุ ูุฌุฏูุง ุฃู ูููุง ูุงู ุงููุฒู ุนุงูู ูุจุฎุตุงุฆุต ุงูุซุฑ ุชุนููุฏุงู ููุชุฌ ููุง ุชุจุงูู ุนุงูู ูููููุฐุฌ. ุนูู ุงูุนูุณุ ุฅุฐุง ูุงู ุจุฃููุงููุง ุงูุชุนุฏูู ูู ุฏุงูุฉ ุงูุชูููุฉ ููุนุงูุจุฉ ุงูุฃูุฒุงู ุงูุนุงููุฉุ ุณูููู ุงููููุฐุฌ ุงููุงุชุฌ ุฐู ุชุจุงูู ูููู. ูุณุชุฎุฏู ุงูุถุจุท ููููุงู ุจุฐูู.

## ุงูุถุจุท: ุงูุฅูุญุฏุงุฑ ุงูุฌุจูู

### ุงูุชุนุฑูู

### ุฅุณุชุฎุฏุงู ุงูุฅูุญุฏุงุฑ ุงูุฌุจูู

### ููุฎุต ุงูุฅูุญุฏุงุฑ ุงูุฌุจูู

## ุงูุถุจุท: ุฅูุญุฏุงุฑ ุงูููู

### ุชุนุฑูู ุงูุถุจุท

### ุงูููุงุฑูุฉ ุจูู ุงูุฅูุญุฏุงุฑ ุงูุฌุจูู ูุงูููู

### ุงุฎุชูุงุฑ ุงูุฎุตุงุฆุต ูุน ุฅูุญุฏุงุฑ ุงูููู

### ุงูุฌุจูู ร ุงูููู ุนูููุงู

### ููุฎุต ุฅูุญุฏุงุฑ ุงูููู


[๐][KFlod2]

[KFlod2]: https://www.geeksforgeeks.org/cross-validation-machine-learning/